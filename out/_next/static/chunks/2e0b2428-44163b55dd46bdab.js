"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[298],{12837:function(e,t,n){let r,i,o,a,l;n.d(t,{$:function(){return e2},A:function(){return tG},B:function(){return tN},C:function(){return tc},D:function(){return tl},E:function(){return nl},F:function(){return tW},G:function(){return nc},H:function(){return nn},I:function(){return eA},J:function(){return nf},K:function(){return ti},L:function(){return eB},M:function(){return ty},N:function(){return nh},O:function(){return eF},P:function(){return tn},Q:function(){return tU},R:function(){return e8},S:function(){return tA},T:function(){return e5},U:function(){return ez},V:function(){return ts},W:function(){return nj},X:function(){return e6},Y:function(){return tt},Z:function(){return ey},_:function(){return e7},a:function(){return nt},a$:function(){return rf},a0:function(){return e3},a1:function(){return tm},a2:function(){return nM},a3:function(){return nk},a4:function(){return t2},a5:function(){return nw},a6:function(){return ng},a7:function(){return t1},a8:function(){return tK},a9:function(){return t5},aA:function(){return rC},aB:function(){return rk},aC:function(){return nP},aD:function(){return n3},aE:function(){return n4},aF:function(){return n5},aG:function(){return n$},aH:function(){return nZ},aI:function(){return rh},aJ:function(){return nD},aK:function(){return n7},aL:function(){return nB},aM:function(){return nz},aN:function(){return rp},aO:function(){return rg},aP:function(){return rm},aQ:function(){return n_},aR:function(){return nY},aS:function(){return nV},aT:function(){return nA},aU:function(){return rv},aV:function(){return nL},aW:function(){return nx},aX:function(){return n8},aY:function(){return nW},aZ:function(){return nN},a_:function(){return es},aa:function(){return tQ},ab:function(){return eh},ac:function(){return ew},ad:function(){return te},ae:function(){return tw},af:function(){return eo},ag:function(){return tJ},ah:function(){return tX},ai:function(){return ny},aj:function(){return nr},ak:function(){return no},al:function(){return nS},am:function(){return rs},an:function(){return tV},ao:function(){return tj},ap:function(){return e4},aq:function(){return td},ar:function(){return rc},as:function(){return ry},at:function(){return nG},au:function(){return nO},av:function(){return nJ},aw:function(){return nQ},ax:function(){return nK},ay:function(){return nq},az:function(){return nC},b:function(){return ni},b0:function(){return rj},b1:function(){return eY},b2:function(){return ro},b3:function(){return ri},b4:function(){return re},b5:function(){return rr},b6:function(){return rl},b7:function(){return rd},b8:function(){return rb},b9:function(){return rx},ba:function(){return rM},c:function(){return t7},d:function(){return eG},e:function(){return eV},f:function(){return eW},g:function(){return em},h:function(){return eP},i:function(){return tC},j:function(){return eS},k:function(){return tv},l:function(){return ex},m:function(){return tf},n:function(){return to},o:function(){return eQ},p:function(){return ed},q:function(){return t8},r:function(){return e9},s:function(){return tx},t:function(){return tr},u:function(){return ea},v:function(){return ef},w:function(){return ep},x:function(){return eg},y:function(){return tg},z:function(){return nv}});var s=n(70367),u=n(64508),c=n(2265),d=n(28256),f=n(59367),h=n(48985);n(94768);var p=n(16189),m=n(23933);n(28492);var g=n(26984),v=n(82955);n(67882),n(9653);var w=n(57845),y=n(19954),b=n(50538),k=n(94333);n(12540),n(56325);var x=n(33155),C=n(89957),M=n(68306),$=n(97149);n(13450);var S=n(82905),P=n(66759),j=n(37879),_=n(8465),E=n(21809),R=n(32224),I=n(36582),T=n(5376),F=n(89518),L=n(52240),U=n(57437),A=n(49105),H=n(49914),O=n(92732),N=n(90589),B=n(53968),D=n(88029),z=n(1838),W=n(10151),Z=n(5586),K=n(71198),q=n(26802),Y=n(88477),G=n(27696),V=n(87684),J=n(23317),Q=n(66790),X=n(25311),ee=n(27600),et=n(70382),en=n(55352),er=n(28992);let ei=(0,c.createContext)(null);function eo(e){let t,n,r,i,o,a,l,u,d,f;let h=(0,s.c)(17);h[0]===Symbol.for("react.memo_cache_sentinel")?(t=()=>window.location.href,h[0]=t):t=h[0];let[p,m]=(0,c.useState)(t);h[1]===Symbol.for("react.memo_cache_sentinel")?(n=function(e,t){let n=new URL(e,window.location.href);if(n.origin!==window.location.origin||!n.pathname.startsWith("/keystatic")){window.location.assign(n);return}window.history[t?"replaceState":"pushState"](null,"",n),(0,c.startTransition)(()=>{m(n.toString())})},h[1]=n):n=h[1];let g=n;h[2]===Symbol.for("react.memo_cache_sentinel")?(r=function(e){g(e,!0)},h[2]=r):r=h[2];let v=r;h[3]===Symbol.for("react.memo_cache_sentinel")?(i=function(e){g(e,!1)},h[3]=i):i=h[3];let w=i;if(h[4]!==p){let e=(a=new URL(p)).pathname.replace(/^\/keystatic\/?/,"");o=""===e?[]:e.split("/").map(decodeURIComponent),h[4]=p,h[5]=o,h[6]=a}else o=h[5],a=h[6];let y=o,b=a.pathname+a.search;h[7]!==b||h[8]!==a.pathname||h[9]!==a.search||h[10]!==y?(l={href:b,pathname:a.pathname,search:a.search,replace:v,push:w,params:y},h[7]=b,h[8]=a.pathname,h[9]=a.search,h[10]=y,h[11]=l):l=h[11];let k=l;return h[12]===Symbol.for("react.memo_cache_sentinel")?(u=()=>{let e=()=>{(0,c.startTransition)(()=>{m(window.location.href)})};return window.addEventListener("popstate",e),()=>{window.removeEventListener("popstate",e)}},d=[],h[12]=u,h[13]=d):(u=h[12],d=h[13]),(0,c.useEffect)(u,d),h[14]!==k||h[15]!==e.children?(f=(0,U.jsx)(ei.Provider,{value:k,children:e.children}),h[14]=k,h[15]=e.children,h[16]=f):f=h[16],f}function ea(){let e=(0,c.useContext)(ei);if(null==e)throw Error("useRouter must be used within a RouterProvider");return e}let el=Symbol("emptyCacheNode");function es(e){return e.replace(/^\.?\/+/,"").replace(/\/*$/,"")}let eu=/\/\*\*?(?:$|\/)/;function ec(e,t){var n;let r=null!==(n=e.collections[t].path)&&void 0!==n?n:`${t}/*/`;if(!eu.test(r))throw Error(`Collection path must end with /* or /** or include /*/ or /**/ but ${t} has ${r}`);return r}function ed(e,t){return es(ec(e,t).replace(/\*\*?.*$/,""))}function ef(e,t){return eb(e,"collections",t)}function eh(e,t){return eb(e,"singletons",t)}function ep(e,t,n){let r=ed(e,t),i=ev(e,t);return`${r}/${n}${i}`}function em(e,t){return`${e}${"index"===t.dataLocation?"/index":""}${ey(t)}`}function eg(e,t){return ec(e,t).includes("**")?"**":"*"}function ev(e,t){let n=es(ec(e,t).replace(/^[^*]+\*\*?/,""));return n?`/${n}`:""}function ew(e,t){var n,r;if(null!==(n=e.singletons[t].path)&&void 0!==n&&n.includes("*"))throw Error(`Singleton paths cannot include * but ${t} has ${e.singletons[t].path}`);return es(null!==(r=e.singletons[t].path)&&void 0!==r?r:t)}function ey(e){return e.contentField?e.contentField.contentExtension:"."+e.data}let eb=function(e){let t={value:el,strong:void 0,weak:void 0};return(...n)=>{let r=t;for(let e of n){if("string"==typeof e||"number"==typeof e){void 0===r.strong&&(r.strong=new Map),r.strong.has(e)||r.strong.set(e,{value:el,strong:void 0,weak:void 0}),r=r.strong.get(e);continue}if("object"==typeof e){void 0===r.weak&&(r.weak=new WeakMap),r.weak.has(e)||r.weak.set(e,{value:el,strong:void 0,weak:void 0}),r=r.weak.get(e);continue}}if(r.value!==el)return r.value;let i=e(...n);return r.value=i,i}}(function(e,t,n){var r,i;let o;let a="collections"===t?e.collections[n]:e.singletons[n],l=("collections"===t?ec(e,n):null!==(r=a.path)&&void 0!==r?r:`${n}/`).endsWith("/")?"index":"outer",{schema:s,format:u="yaml"}=a;if("string"==typeof u)return{dataLocation:l,contentField:void 0,data:u};if(u.contentField){let e;let r=Array.isArray(u.contentField)?u.contentField:[u.contentField];try{e=function e(t,n,r){if(0===t.length){if("form"!==n.kind||"content"!==n.formKind)throw new ek(`Content field for ${r()} is not a content field`);return n.contentExtension}if("object"===n.kind){let i=n.fields[t[0]];if(!i)throw new ek(`Field ${r()} specified in contentField does not exist`);return e(t.slice(1),i,r)}if("conditional"===n.kind){let i;if("value"!==t[0])throw new ek(`Conditional fields referenced in a contentField path must only reference the value field (${r()})`);let o=t.slice(1);for(let t of Object.values(n.values)){let n=e(o,t,r);if(!i){i=n;continue}if(i!==n)throw new ek(`contentField ${r()} has conflicting content extensions`)}if(!i)throw new ek(`contentField ${r()} does not point to a content field`);return i}throw new ek(`Path specified in contentField ${r()} does not point to a content field`)}(r,{kind:"object",fields:s},()=>JSON.stringify(u.contentField))}catch(e){if(e instanceof ek)throw Error(`${e.message} (${t}.${n})`);throw e}o={path:r,contentExtension:e}}return{data:null!==(i=u.data)&&void 0!==i?i:"yaml",contentField:o,dataLocation:l}});class ek extends Error{constructor(e){super(e)}}function ex(e){if("local"!==e.kind&&e.pathPrefix)return es(e.pathPrefix)+"/"}async function eC(e){let t=await crypto.subtle.digest("SHA-1",e);return(0,Q.d)(new Uint8Array(t))}let eM=new TextEncoder,e$=new WeakMap;async function eS(e){let t=e$.get(e);if(void 0!==t)return t;let n=eM.encode("blob "+e.length+"\0"),r=new Uint8Array(n.byteLength+e.byteLength);r.set(n,0),r.set(e,n.byteLength);let i=eC(r);return e$.set(e,i),i.then(t=>e$.set(e,t)),i}function eP(e,t){let n=t.split("/"),r=e.get(n[0]);for(let e of n.slice(1)){if(!r||!r.children)return;r=r.children.get(e)}return r}function ej(e,t){if(""===t)return e;let n=e;for(let e of t.split("/")){n.has(e)||n.set(e,new Map);let t=n.get(e);(0,L.hu)(t instanceof Map,"expected tree"),n=t}return n}function e_(e){return e.replace(/.*\//,"")}function eE(e){return e.includes("/")?e.replace(/\/[^/]+$/,""):""}let eR=new Uint8Array([32]),eI=new Uint8Array([0]),eT=eM.encode("tree ");function eF(e){let t=[...e].map(([e,t])=>({name:e,sha:t.entry.sha,mode:t.entry.mode}));t.sort((e,t)=>{let n="040000"===e.mode?e.name+"/":e.name,r="040000"===t.mode?t.name+"/":t.name;return n===r?0:n<r?-1:1});let n=t.flatMap(e=>[eM.encode(e.mode.replace(/^0/,"")),eR,eM.encode(e.name),eI,function(e){let t=new Uint8Array(e.length/2);for(var n=0;n<t.byteLength;n+=1){let r=2*n;t[n]=parseInt(e.slice(r,r+2),16)}return t}(e.sha)]);return eC(function(e){let t=new Uint8Array(e.reduce((e,t)=>e+t.byteLength,0)),n=0;for(let r of e)t.set(r,n),n+=r.byteLength;return t}([eT,eM.encode(n.reduce((e,t)=>e+t.byteLength,0).toString()),eI,...n]))}async function eL(e,t){return{path:e,mode:"040000",type:"tree",sha:await eF(t)}}async function eU(e,t){return{path:e,mode:"100644",type:"blob",sha:"sha"in t?t.sha:await eS(t)}}async function eA(e,t){var n;let r=null!==(n=await eO(e,function(e){let t=new Map;for(let n of e.deletions)ej(t,eE(n)).set(e_(n),"delete");for(let n of e.additions)ej(t,eE(n.path)).set(e_(n.path),n.contents);return t}(t),[]))&&void 0!==n?n:new Map;return{entries:eH(r),sha:await eF(null!=r?r:new Map)}}function eH(e){return[...e.values()].flatMap(e=>e.children?[e.entry,...eH(e.children)]:[e.entry])}async function eO(e,t,n){let r=new Map(e);for(let[e,a]of t){if("delete"===a&&r.delete(e),a instanceof Map){var i,o;let t=null!==(i=null===(o=r.get(e))||void 0===o?void 0:o.children)&&void 0!==i?i:new Map,l=await eO(t,a,n.concat(e));if(void 0===l){r.delete(e);continue}let s=await eL(n.concat(e).join("/"),l);r.set(e,{entry:s,children:l})}if(a instanceof Uint8Array||"object"==typeof a&&"sha"in a){let t=await eU(n.concat(e).join("/"),a);r.set(e,{entry:t})}}if(0!==r.size)return r}function eN(e){let t=new Map,n=e=>{var n;if(0===e.length)return t;let r=t.get(e[0]);for(let t of e.slice(1)){if(!r||!r.children)return;r=r.children.get(t)}return null===(n=r)||void 0===n?void 0:n.children};for(let t of e){let e=t.path.split("/"),r=n(e.slice(0,-1));r&&r.set(e[e.length-1],{entry:t,children:"tree"===t.type?new Map:void 0})}return t}let eB={then(){}};function eD(e){return e&&"function"==typeof e.then}function ez(e){if("error"===e.kind)throw e.error;if("loaded"===e.kind)return e.data;throw e.promise}function eW(e){let t=(0,c.useMemo)(()=>{try{let t=e();return eD(t)&&t.then(()=>{},()=>{}),{kind:"result",result:t}}catch(e){return{kind:"error",error:e}}},[e]),[n,r]=(0,c.useState)(()=>"result"===t.kind?eD(t.result)?{kind:"loading",promise:t.result}:{kind:"loaded",data:t.result}:t),i=n,o=(0,c.useMemo)(()=>"error"===t.kind&&("error"!==n.kind||n.error!==t.error)?{kind:"error",error:t.error}:"result"!==t.kind||eD(t.result)||"loaded"===n.kind&&n.data===t.result?void 0:{kind:"loaded",data:t.result},[t,n]);return o&&o!==n&&(i=o,r(o)),(0,c.useEffect)(()=>{if("result"===t.kind&&eD(t.result)){r({kind:"loading",promise:t.result});let e=!0;return t.result.then(t=>{e&&r({kind:"loaded",data:t})},t=>{e&&r({kind:"error",error:t})}),()=>{e=!1}}},[t]),i}function eZ(e,t){return"error"===e.kind||"loading"===e.kind?e:{kind:"loaded",data:t(e.data)}}function eK(e){let t=Object.entries(e);for(let[,e]of t)if("error"===e.kind)return{kind:"error",error:e.error};let n=[];for(let[,e]of t)"loading"===e.kind&&n.push(e.promise);return n.length?{kind:"loading",promise:eq(...n)}:{kind:"loaded",data:Object.fromEntries(t.map(([e,t])=>[e,t.data]))}}let eq=function(e){let t={inner:new WeakMap};return function(...n){let r=t;for(let e of n){let{inner:t}=r;t.has(e)||t.set(e,{inner:new WeakMap}),r=t.get(e)}return r.hasOwnProperty("value")||(r.value=e(...n)),r.value}}((...e)=>Promise.all(e));function eY(e){let t=new Set;return!function e(t,n,r){if(!r.has(t)){if(r.add(t),"array"===t.kind)return e(t.element,n,r);if("child"!==t.kind){if("form"===t.kind){if("asset"===t.formKind&&void 0!==t.directory&&n.add(es(t.directory)),("content"===t.formKind||"assets"===t.formKind)&&void 0!==t.directories)for(let e of t.directories)n.add(es(e));return}if("object"===t.kind){for(let i of Object.values(t.fields))e(i,n,r);return}if("conditional"===t.kind){for(let i of Object.values(t.values))e(i,n,r);return}(0,L.vE)(t)}}}(e,t,new Set),t}function eG(e,t,n,r){let i=[es(t)];"outer"===r.dataLocation&&i.push(es(t)+ey(r));let o=void 0===n?"":`/${n}`;for(let t of eY(e))i.push(t+o);return i}function eV(e,t){return e.map(e=>{var n;return null===(n=eP(t,e))||void 0===n?void 0:n.entry.sha}).join("-")}var eJ="0.5.48";function eQ(e,t){return{...t,kind:"object",fields:e}}let eX={seconds:60,minutes:60,hours:24,days:7,weeks:4,months:12,years:1/0};function e0(e){let t,n,r,i,o;let a=(0,s.c)(10),{locale:l}=(0,X.j)();a[0]===Symbol.for("react.memo_cache_sentinel")?(t=()=>new Date,a[0]=t):t=a[0];let[u]=(0,c.useState)(t);if(a[1]!==l||a[2]!==e.date||a[3]!==u){let t=new Intl.RelativeTimeFormat(l);t.format(e.date.getTime()-u.getTime(),"second"),r=function(e,t,n){let r=(e.getTime()-t.getTime())/1e3;for(let[e,t]of Object.entries(eX)){if(Math.abs(r)<t)return n.format(Math.round(r),e);r/=t}return"unknown"}(e.date,u,t),a[1]=l,a[2]=e.date,a[3]=u,a[4]=r}else r=a[4];return n=r,a[5]!==e.date?(i=e.date.toISOString(),a[5]=e.date,a[6]=i):i=a[6],a[7]!==i||a[8]!==n?(o=(0,U.jsx)("time",{dateTime:i,children:n}),a[7]=i,a[8]=n,a[9]=o):o=a[9],o}function e1(){return r||(r=(0,ee.MT)("keystatic","items")),r}function e2(e,t){return(0,ee.t8)(e,t,e1())}function e3(e){return(0,ee.IV)(e,e1())}function e8(e){return(0,ee.U2)(e,e1())}async function e4(){await (0,ee.ZH)(e1())}function e5(e,t){return e.collections[t]}function e6(e){return"local"!==e.storage.kind?e.storage.branchPrefix:void 0}function e7(e){return"github"===e.storage.kind}function e9(e){return"local"===e.storage.kind}function te(e){var t;if("cloud"!==e.storage.kind)return!1;if(!(null!==(t=e.cloud)&&void 0!==t&&t.project)||!e.cloud.project.includes("/"))throw Error(`Keystatic is set to \`storage: { kind: 'cloud' }\` but \`cloud.project\` isn't set.
config({
  storage: { kind: 'cloud' },
  cloud: { project: 'team/project' },
})`);return!0}function tt(e){return`https://github.com/${e.owner}/${e.name}`}function tn(e,t){let n=t[e.slugField],r=e.schema[e.slugField];if("form"!==r.kind||"slug"!==r.formKind)throw Error("slugField is not a slug field");return r.serializeWithSlug(n).slug}function tr(e,t,n){var r,i,o;let a=eQ(e.collections[t].schema),l=ef(e,t),s=ey(l),u=eg(e,t),c=null!==(r=null===(i=eP(n,ed(e,t)))||void 0===i?void 0:i.children)&&void 0!==r?r:new Map,d=[],f=[...eY(a)],h=ev(e,t),p=new Map(c);if("**"===u){let e=(t,n)=>{for(let[r,i]of t)i.children?(p.set(`${n}${r}`,i),e(i.children,`${n}${r}/`)):p.set(`${n}${r}`,i)};e(c,"")}for(let[r,i]of p)if("index"===l.dataLocation){let i=eP(n,ep(e,t,r));if(!(null!=i&&null!==(o=i.children)&&void 0!==o&&o.has("index"+s)))continue;d.push({key:eV([i.entry.path,...f.map(e=>`${e}/${r}`)],n),slug:r,sha:i.children.get("index"+s).entry.sha})}else{if(h){let o=eP(n,ep(e,t,r)+s);if(!o||o.children)continue;d.push({key:eV([i.entry.path,ep(e,t,r),...f.map(e=>`${e}/${r}`)],n),slug:r,sha:o.entry.sha})}if(i.children||!r.endsWith(s))continue;let o=r.slice(0,-s.length);d.push({key:eV([i.entry.path,ep(e,t,o),...f.map(e=>`${e}/${o}`)],n),slug:o,sha:i.entry.sha})}return d}let ti="https://api.keystatic.cloud",to={"x-keystatic-version":eJ},ta=new TextEncoder;async function tl(e,t){var n;if(!(null!==(n=t.cloud)&&void 0!==n&&n.project))throw Error("Not a cloud config");let r=(0,Q.c)(crypto.getRandomValues(new Uint8Array(32))),i=(0,Q.c)(new Uint8Array(await crypto.subtle.digest("SHA-256",ta.encode(r)))),o=(0,Q.c)(crypto.getRandomValues(new Uint8Array(32)));localStorage.setItem("keystatic-cloud-state",JSON.stringify({state:o,from:e,code_verifier:r}));let a=new URL(`${ti}/oauth/authorize`);a.searchParams.set("state",o),a.searchParams.set("client_id",t.cloud.project),a.searchParams.set("redirect_uri",`${window.location.origin}/keystatic/cloud/oauth/callback`),a.searchParams.set("response_type","code"),a.searchParams.set("code_challenge_method","S256"),a.searchParams.set("code_challenge",i),a.searchParams.set("keystatic_version",eJ),window.location.href=a.toString()}function ts(e,t,n){let r,i,o;let a=(0,s.c)(8);a[0]!==e||a[1]!==t||a[2]!==n?(r=()=>{if(e&&t===e.state){var r,i;r=e.savedAt,i=n!==e.treeKey,C.g.info((0,U.jsxs)($.xv,{children:["Restored draft from ",(0,U.jsx)(e0,{date:r}),"."," ",i&&(0,U.jsx)($.xv,{color:"accent",children:"Other changes have been made to this entry since the draft. You may want to discard the draft changes."})]}),{timeout:8e3})}},a[0]=e,a[1]=t,a[2]=n,a[3]=r):r=a[3];let l=(0,E.i)(r);a[4]!==e||a[5]!==l?(i=()=>{e&&l()},o=[e,l],a[4]=e,a[5]=l,a[6]=i,a[7]=o):(i=a[6],o=a[7]),(0,c.useEffect)(i,o)}let tu=f.Ry({token:f.Z_(),project:f.Z_(),validUntil:f.oQ(f.hT(),f.Rx(),e=>new Date(e))});function tc(e){if("undefined"==typeof document)return null;if("github"===e.storage.kind){let e=(0,G.Qc)(document.cookie)["keystatic-gh-access-token"];return e?{accessToken:e}:null}return"cloud"===e.storage.kind?td(e):null}function td(e){var t;let n;if(!(null!==(t=e.cloud)&&void 0!==t&&t.project))return null;let r=localStorage.getItem("keystatic-cloud-access-token");try{n=tu.create(JSON.parse(r))}catch(e){return null}return!n||n.validUntil<new Date||n.project!==e.cloud.project?null:{accessToken:n.token}}async function tf(e){let t=tc(e);return"github"!==e.storage.kind||t?t:(i||(i=(async()=>{try{let e=await fetch("/api/keystatic/github/refresh-token",{method:"POST"});if(200===e.status){let e=(0,G.Qc)(document.cookie)["keystatic-gh-access-token"];if(e)return{accessToken:e}}}catch{}finally{i=void 0}return null})()),i)}let th=(0,V.ZP)`
  fragment SidebarFooter_viewer on User {
    id
    name
    login
    avatarUrl
    databaseId
  }
`,tp=(0,c.createContext)(void 0);function tm(){return(0,c.useContext)(tp)}function tg(e){if("string"==typeof e){let[t,n]=e.split("/");return{owner:t,name:n}}return e}function tv(e){return"string"==typeof e?e:`${e.owner}/${e.name}`}function tw(e){if("string"==typeof e&&!e.includes("/"))throw Error(`Invalid repo config: ${e}. It must be in the form owner/name`);if("object"==typeof e){if(!e.owner&&!e.name)throw Error("Invalid repo config: owner and name are missing");if(!e.owner)throw Error("Invalid repo config: owner is missing");if(!e.name)throw Error("Invalid repo config: name is missing")}}function ty(e,t){let n=ex(t.storage);if(!n)return e;let r=[];for(let t of e.entries.values())t.path.startsWith(n)&&r.push({...t,path:t.path.slice(n.length)});return{entries:new Map(r.map(e=>[e.path,e])),tree:eN(r)}}function tb(){return o||(o=(0,ee.MT)("keystatic-trees","trees")),o}function tk(){return a||(a=(0,ee.MT)("keystatic-blobs","blobs")),a}function tx(e,t){return(0,ee.t8)(e,t,tk())}async function tC(e){let t=await (0,ee.U2)(e,tk());if(t instanceof Uint8Array)return t}let tM=f.IX(f.Ry({path:f.Z_(),mode:f.Z_(),sha:f.Z_()}));function t$(){if(l)return l;let e=new Map;return(0,ee.qh)(tb()).then(t=>{for(let[n,r]of t){let t;if("string"==typeof n){try{t=tM.create(r)}catch{continue}e.set(n,t)}}return l=e,e})}function tS(e,t,n=""){let r=new Map,i=t.get(e);if(i){for(let e of i){let i=(""===n?"":n+"/")+e.path;if("040000"===e.mode){let n=tS(e.sha,t,i);if(n){r.set(e.path,n);continue}return}r.set(e.path,{entry:{mode:e.mode,path:i,sha:e.sha,type:"120000"===e.mode?"symlink":"blob"}})}return{entry:{mode:"040000",path:n,sha:e,type:"tree"},children:r}}}async function tP(e){let t=new Map,n=[];for(let[e,r]of(await t$())){let i;if("string"!=typeof e){n.push(e);continue}try{i=tM.create(r)}catch{n.push(e);continue}t.set(e,i)}let r=new Set(await (0,ee.XP)(tk())),i=new Set(e);for(let e of i){if(r.has(e)){r.delete(e);continue}let n=t.get(e);if(n){for(let e of n)i.add(e.sha);t.delete(e);continue}}let o=[...t.keys(),...n];for(let e of(await Promise.all([(0,ee.Qv)([...r],tk()),(0,ee.Qv)([...t.keys(),...n],tb())]),o)){var a;null===(a=l)||void 0===a||a.delete(e)}}async function tj(){await Promise.all([(0,ee.ZH)(tk()),(0,ee.ZH)(tb())])}let t_=[];t_[0]=(e,t,n,r)=>{D.uE(e,0);let i=W.zu(t,e,n.doc,n);r&&i===W.Px&&!n.synced&&(n.synced=!0)},t_[3]=(e,t,n)=>{D.uE(e,1),D.mP(e,A.xq(n.awareness,Array.from(n.awareness.getStates().keys())))},t_[1]=(e,t,n)=>{A.oy(n.awareness,z.HN(t),n)},t_[2]=(e,t,n)=>{Z.nw(t,n.doc,tE)},t_[4]=(e,t,n,r)=>{let i=z.kf(t);D.uE(e,0);let o=n.getSubDoc(i);if(o){let i=W.zu(t,e,o,n);r&&i===W.Px&&o.emit("sync",[!0])}};let tE=(e,t)=>console.warn(`Permission denied to access ${e.url}.
${t}`),tR=(e,t,n)=>{let r=z.l1(t),i=D.Mf(),o=z.yg(r),a=t_[o];return a?a(i,r,e,n,o):console.error("Unable to compute message"),i},tI=(e,t)=>{if(e.shouldConnect&&null===e.ws){let n=new t(e.url);n.binaryType="arraybuffer",e.ws=n,e.wsconnecting=!0,e.wsconnected=!1,e.synced=!1;let r={kind:"authenticating",queue:[]};n.onmessage=t=>{e.wsLastMessageReceived=B.ZG();let i=new Uint8Array(t.data);if("authenticating"===r.kind){let t=z.l1(i);if(2===z.F7(t)&&2===z.F7(t)){let t=r.queue;for(let i of(r={kind:"authed"},e.onConnect(n),t)){let t=tR(e,i,!0);D.kE(t)>1&&n.send(D._f(t))}return}r.queue.push(i)}else{let t=tR(e,i,!0);D.kE(t)>1&&n.send(D._f(t))}},n.onclose=()=>{e.ws=null,e.wsconnecting=!1,e.wsconnected?(e.wsconnected=!1,e.synced=!1,A.Ag(e.awareness,Array.from(e.awareness.getStates().keys()).filter(t=>t!==e.doc.clientID),e),e.onStatus({status:"disconnected"})):e.wsUnsuccessfulReconnects++,setTimeout(tI,q.VV(1200*q.mv(e.wsUnsuccessfulReconnects+1),2500),e)},n.onopen=async()=>{e.wsLastMessageReceived=B.ZG();let t=D.Mf();D.uE(t,2),D.uE(t,0),D.uw(t,await e.authToken()),n.send(D._f(t))},e.onStatus({status:"connecting"})}},tT=(e,t)=>{if(e.ws&&e.wsconnected){var n;null===(n=e.ws)||void 0===n||n.send(t)}e.bcconnected&&e.mux(()=>{N.nY(e.bcChannel,t)})};class tF{#e;#t;#n;#r;constructor(e){var t,n,r;this.bcChannel=e.url,this.url=e.url,this.doc=e.doc,this.#e=null!==(t=e.WebSocketPolyfill)&&void 0!==t?t:WebSocket,this.awareness=e.awareness,this.wsconnected=!1,this.wsconnecting=!1,this.bcconnected=!1,this.wsUnsuccessfulReconnects=0,this.mux=K.M(),this.#t=!1,this.authToken=e.authToken,this.ws=null,this.wsLastMessageReceived=0,this.onStatus=null!==(n=e.onStatus)&&void 0!==n?n:()=>{},this.onSynced=null!==(r=e.onSynced)&&void 0!==r?r:()=>{},this.shouldConnect=!1,this.subdocs=new Map,this.#n=null,void 0!==e.resyncInterval&&e.resyncInterval>0&&(this.#n=setInterval(()=>{if(this.ws){let t=D.Mf();D.uE(t,0),W._J(t,e.doc),this.ws.send(D._f(t))}},e.resyncInterval)),this.doc.on("subdocs",({added:e,removed:t,loaded:n})=>{e.forEach(e=>{this.subdocs.set(e.guid,e)}),t.forEach(e=>{e.off("update",this.#i(e)),this.subdocs.delete(e.guid)}),n.forEach(e=>{this.waitForConnection(()=>{let t=D.Mf();D.uE(t,4),D.uw(t,e.guid),W._J(t,e),this.send(D._f(t),()=>{e.on("update",this.#i(e))})},1e3)})}),this.doc.on("update",this.#o),"undefined"!=typeof window&&window.addEventListener("beforeunload",this.#a),e.awareness.on("update",this.#l),this.#r=setInterval(()=>{if(this.wsconnected&&3e4<B.ZG()-this.wsLastMessageReceived){var e;null===(e=this.ws)||void 0===e||e.close()}},3e3)}onConnect(e){this.wsconnecting=!1,this.wsconnected=!0,this.wsUnsuccessfulReconnects=0,this.onStatus({status:"connected"});let t=D.Mf();if(D.uE(t,0),W._J(t,this.doc),e.send(D._f(t)),null!==this.awareness.getLocalState()){let t=D.Mf();D.uE(t,1),D.mP(t,A.xq(this.awareness,[this.doc.clientID])),e.send(D._f(t))}}#s=e=>{this.mux(()=>{let t=tR(this,new Uint8Array(e),!1);D.kE(t)>1&&N.nY(this.bcChannel,D._f(t))})};#a=()=>{A.Ag(this.awareness,[this.doc.clientID],"window unload")};waitForConnection=(e,t)=>{let n=this.ws;(null==n?void 0:n.readyState)===1?e(n):setTimeout(()=>{this.waitForConnection(e,t)},t)};#l=({added:e,updated:t,removed:n})=>{let r=e.concat(t).concat(n),i=D.Mf();D.uE(i,1),D.mP(i,A.xq(this.awareness,r)),tT(this,D._f(i))};send=(e,t)=>{this.waitForConnection(n=>{n.send(e),void 0!==t&&t()},1e3)};get synced(){return this.#t}getSubDoc(e){return this.subdocs.get(e)}set synced(e){this.#t!==e&&(this.#t=e,this.onSynced(e),this.doc.emit("sync",[e]))}#i=(0,Y.Z)(e=>t=>{let n=D.Mf();D.uE(n,4),D.uw(n,e.guid),W.lr(n,t),tT(this,D._f(n))});#o=(e,t)=>{if(t!==this){let t=D.Mf();D.uE(t,0),W.lr(t,e),tT(this,D._f(t))}};destroy(){null!==this.#n&&clearInterval(this.#n),clearInterval(this.#r),this.disconnect(),"undefined"!=typeof window&&window.removeEventListener("beforeunload",this.#a),this.awareness.off("update",this.#l),this.doc.off("update",this.#o)}connectBc(){this.bcconnected||(N.Ld(this.bcChannel,this.#s),this.bcconnected=!0),this.mux(()=>{let e=D.Mf();D.uE(e,0),W._J(e,this.doc),N.nY(this.bcChannel,D._f(e));let t=D.Mf();D.uE(t,0),W.K0(t,this.doc),N.nY(this.bcChannel,D._f(t));let n=D.Mf();D.uE(n,3),N.nY(this.bcChannel,D._f(n));let r=D.Mf();D.uE(r,1),D.mP(r,A.xq(this.awareness,[this.doc.clientID])),N.nY(this.bcChannel,D._f(r))})}disconnectBc(){let e=D.Mf();D.uE(e,1),D.mP(e,A.xq(this.awareness,[this.doc.clientID],new Map)),tT(this,D._f(e)),this.bcconnected&&(N.r1(this.bcChannel,this.#s),this.bcconnected=!1)}disconnect(){this.shouldConnect=!1,this.disconnectBc(),null!==this.ws&&this.ws.close()}connect(){this.shouldConnect=!0,this.wsconnected||null!==this.ws||(tI(this,this.#e),this.connectBc())}}let tL=(0,c.createContext)(null);function tU(){let e=(0,c.useContext)(tL);if(!e)throw Error("CollabProvider not found");if("loading"===e)throw Error("CollabProvider is loading");return e}function tA(){return(0,c.useContext)(tL)}let tH=new Map,tO=(0,c.createContext)(tH);function tN(){return(0,c.useContext)(tO)}let tB=new WeakMap;function tD(e){var t;let n=ea(),r=tG(),i=null===(t=e.config.cloud)||void 0===t?void 0:t.project,o=`ks-multiplayer-${i}`,a=null===r?"true"===localStorage.getItem(o):r.team.multiplayer,l=(0,c.useMemo)(()=>{if(!a)return;let t=new H.QW,n=t.getMap("data"),r=new A.GL(t),o=(0,O.kc)(t,`keystatic-2-${i}`),l=new tF({doc:t,url:`wss://live.keystatic.cloud/${i}?v=${eJ}`,WebSocketPolyfill:class extends en.ZP{constructor(e){super(e),this.addEventListener("message",e=>{e.data})}send(e){if(Uint8Array,e instanceof Uint8Array&&e.byteLength>1e6){let t=Math.ceil(e.byteLength/1e6),n=(0,D.Mf)();(0,D.uE)(n,5),(0,D.uE)(n,t),super.send((0,D._f)(n));for(let n=0;n<t;n++){let t=1e6*n,r=Math.min((n+1)*1e6,e.byteLength);super.send(e.slice(t,r))}return}super.send(e)}},awareness:r,authToken:async()=>tf(e.config).then(e=>{var t;return null!==(t=null==e?void 0:e.accessToken)&&void 0!==t?t:""})});return{doc:t,awareness:r,provider:l,data:n,idb:o}},[a,i,e.config]),s=t8();(0,c.useEffect)(()=>{null==l||l.awareness.setLocalStateField("branch",s),null==l||l.awareness.setLocalStateField("location",n.params.slice(2).join("/"))},[s,n.params,null==l?void 0:l.awareness]);let u=!!s;(0,c.useEffect)(()=>{if(u&&l){l.idb.connect();let e=!1,t=l.idb.subscribeStatusChange(()=>{("synced"===l.idb.status.type||"error"===l.idb.status.type)&&(t(),l.provider.connect(),e=!0)});return()=>{l.idb.disconnect(),e?l.provider.disconnect():t()}}},[l,u]),(0,c.useEffect)(()=>{if(null===r)return;let e=`ks-multiplayer-${i}`;r.team.multiplayer?localStorage.setItem(e,"true"):localStorage.removeItem(e)},[r,i]);let d=(0,c.useSyncExternalStore)((0,c.useCallback)(e=>{let t=null==l?void 0:l.awareness;if(!t)return()=>{};let n=()=>{tB.set(t,new Map(t.getStates())),e()};return t.on("change",n),()=>{tB.set(t,new Map(t.getStates())),t.off("change",n)}},[l]),()=>{var e;return null!=l&&l.awareness&&null!==(e=tB.get(l.awareness))&&void 0!==e?e:tH});return(0,U.jsx)(tO.Provider,{value:null!=d?d:tH,children:(0,U.jsx)(tL.Provider,{value:void 0===l?void 0===r?"loading":null:l,children:e.children})})}function tz(e){let t,n;let r=(0,s.c)(4);r[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,U.jsx)(y.kC,{justifyContent:"center",children:(0,U.jsx)($.X6,{children:"Git repo not initialised"})}),r[0]=t):t=r[0];let i=`https://github.com/${e.repo}`;return r[1]!==i||r[2]!==e.repo?(n=(0,U.jsx)(y.kC,{alignItems:"center",justifyContent:"center",margin:"xxlarge",children:(0,U.jsxs)(y.kC,{backgroundColor:"surface",padding:"large",border:"color.alias.borderIdle",borderRadius:"medium",direction:"column",justifyContent:"center",gap:"xlarge",maxWidth:"scale.4600",children:[t,(0,U.jsxs)($.xv,{children:["The Keystatic GitHub App is installed in the GitHub repository"," ",(0,U.jsx)(b.h,{href:i,children:e.repo})," ","but the Git repo is not initialised. Please initialise the Git repo before using Keystatic."]})]})}),r[1]=i,r[2]=e.repo,r[3]=n):n=r[3],n}function tW(){return(0,c.useContext)(tZ)}let tZ=(0,c.createContext)(()=>{throw Error("SetTreeShaContext not set")});function tK(e){let[t,n]=(0,c.useState)("initial"),r=eW((0,c.useCallback)(()=>(function(e){if(nd.has(e))return nd.get(e);let t=fetch("/api/keystatic/tree",{headers:{"no-cors":"1"}}).then(e=>e.json()).then(async e=>nf(e));return nd.set(e,t),t})(t),[t])),i=(0,c.useMemo)(()=>({unscopedDefault:r,scoped:{default:r,current:r,merged:eK({default:r,current:r})}}),[r]),o=(0,c.useMemo)(()=>"loaded"!==i.scoped.merged.kind?{collections:new Map,singletons:new Set}:nm(e.config,i.scoped.merged.data),[i,e.config]);return(0,U.jsx)(tZ.Provider,{value:n,children:(0,U.jsx)(t9.Provider,{value:o,children:(0,U.jsx)(ne.Provider,{value:i,children:e.children})})})}let tq=f.dt({user:f.dt({id:f.Z_(),name:f.Z_(),email:f.Z_(),avatarUrl:f.jt(f.Z_())}),project:f.dt({name:f.Z_()}),team:f.Ry({name:f.Z_(),slug:f.Z_(),images:f.O7(),multiplayer:f.O7()})}),tY=(0,c.createContext)(null);function tG(){let e=(0,c.useContext)(tY);return"unauthorized"===e?null:e}function tV(){return(0,c.useContext)(tY)}function tJ(e){let t=eW((0,c.useCallback)(async()=>{var t,n;if(!(null!==(t=e.config.cloud)&&void 0!==t&&t.project))throw Error("no cloud project set");let r=null===(n=td(e.config))||void 0===n?void 0:n.accessToken;if(!r)return"unauthorized";let i=await fetch(`${ti}/v1/info`,{headers:{...to,Authorization:`Bearer ${r}`}});return 401===i.status?"unauthorized":tq.create(await i.json())},[e.config]));return(0,U.jsx)(tY.Provider,{value:"loaded"===t.kind?t.data:null,children:e.children})}let tQ=(0,c.createContext)(null);function tX(e){var t,n,r,i;let o="github"===e.config.storage.kind?tg(e.config.storage.repo):{name:"repo-name",owner:"repo-owner"},[a]=(0,J.aM)({query:"github"===e.config.storage.kind?nc:nl,variables:o}),[l,s]=(0,c.useState)(null),[u]=(0,J.aM)({query:(0,V.ZP)`
      query FetchMoreRefs($owner: String!, $name: String!, $after: String) {
        repository(owner: $owner, name: $name) {
          __typename
          id
          refs(refPrefix: "refs/heads/", first: 100, after: $after) {
            __typename
            nodes {
              ...Ref_base
            }
            pageInfo {
              hasNextPage
              endCursor
            }
          }
        }
      }
      ${no}
    `,pause:!(null!==(t=a.data)&&void 0!==t&&null!==(t=t.repository)&&void 0!==t&&null!==(t=t.refs)&&void 0!==t&&t.pageInfo.hasNextPage),variables:{...o,after:null!=l?l:null===(n=a.data)||void 0===n||null===(n=n.repository)||void 0===n||null===(n=n.refs)||void 0===n?void 0:n.pageInfo.endCursor}}),d=null===(r=u.data)||void 0===r||null===(r=r.repository)||void 0===r||null===(r=r.refs)||void 0===r?void 0:r.pageInfo;return(null!=d&&d.hasNextPage&&d.endCursor!==l&&d.endCursor&&s(d.endCursor),null===(i=a.data)||void 0===i||null===(i=i.repository)||void 0===i||!i.owner||a.data.repository.defaultBranchRef||a.fetching||a.error)?(0,U.jsx)(tQ.Provider,{value:a,children:(0,U.jsx)(tp.Provider,{value:a.data&&"viewer"in a.data?a.data.viewer:void 0,children:e.children})}):(0,U.jsx)(tz,{repo:`${a.data.repository.owner.login}/${a.data.repository.name}`})}let t0=new Set(["WRITE","ADMIN","MAINTAIN"]);function t1(e){var t,n,r,i,o,a,l,s,u,d,f,h,p,m,g;let v=ea(),{data:w,error:y}=(0,c.useContext)(tQ),b=null==w?void 0:w.repository;b&&"viewerPermission"in b&&b.viewerPermission&&!t0.has(b.viewerPermission)&&"forks"in b&&(b=null!==(m=null===(g=b.forks)||void 0===g||null===(g=g.nodes)||void 0===g?void 0:g[0])&&void 0!==m?m:b);let k=null===(t=b)||void 0===t||null===(t=t.refs)||void 0===t||null===(t=t.nodes)||void 0===t?void 0:t.find(e=>{var t;return(null==e?void 0:e.name)===(null===(t=b)||void 0===t||null===(t=t.defaultBranchRef)||void 0===t?void 0:t.name)}),x=null===(n=b)||void 0===n||null===(n=n.refs)||void 0===n||null===(n=n.nodes)||void 0===n?void 0:n.find(t=>(null==t?void 0:t.name)===e.currentBranch);(0,c.useEffect)(()=>{var e;null!==(e=b)&&void 0!==e&&null!==(e=e.refs)&&void 0!==e&&e.nodes&&tP(b.refs.nodes.map(e=>{var t;return(null==e||null===(t=e.target)||void 0===t?void 0:t.__typename)==="Commit"?e.target.tree.oid:void 0}).filter(L.$K))},[null===(r=b)||void 0===r?void 0:r.id]);let C=null!==(i=null==k?void 0:k.target.tree.oid)&&void 0!==i?i:null,M=null!==(o=null==x?void 0:x.target.tree.oid)&&void 0!==o?o:null,$=np(C,e.config),S=np(M,e.config),P=(0,c.useMemo)(()=>{let t=eZ($,t=>ty(t,e.config)),n=eZ(S,t=>ty(t,e.config));return{unscopedDefault:S,scoped:{default:t,current:n,merged:eK({default:t,current:n})}}},[S,$,e.config]),j=(0,c.useMemo)(()=>"loaded"!==P.scoped.merged.kind?{collections:new Map,singletons:new Set}:nm(e.config,P.scoped.merged.data),[P,e.config]);(0,c.useEffect)(()=>{var t,n;(null==y||null===(t=y.response)||void 0===t?void 0:t.status)===401&&(e7(e.config)?window.location.href=`/api/keystatic/github/login?from=${v.params.map(encodeURIComponent).join("/")}`:tl(v.params.map(encodeURIComponent).join("/"),e.config)),!(null!==(n=b)&&void 0!==n&&n.id)&&null!=y&&y.graphQLErrors.some(e=>{var t,n;return(null==e||null===(t=e.originalError)||void 0===t?void 0:t.type)==="NOT_FOUND"||(null==e||null===(n=e.originalError)||void 0===n?void 0:n.type)==="FORBIDDEN"})&&(window.location.href=`/api/keystatic/github/repo-not-found?from=${v.params.map(encodeURIComponent).join("/")}`)},[y,v,null===(a=b)||void 0===a?void 0:a.id,e.config]);let _=(0,c.useMemo)(()=>{var e;return new Map(null===(e=b)||void 0===e||null===(e=e.refs)||void 0===e||null===(e=e.nodes)||void 0===e?void 0:e.flatMap(e=>{var t;return(null==e||null===(t=e.target)||void 0===t?void 0:t.__typename)!=="Commit"?[]:[[e.name,{id:e.id,commitSha:e.target.oid,treeSha:e.target.tree.oid}]]}))},[null===(l=b)||void 0===l||null===(l=l.refs)||void 0===l?void 0:l.nodes]),E=!!b&&("cloud"===e.config.storage.kind||"viewerPermission"in b&&!!(null!==(s=b)&&void 0!==s&&s.viewerPermission)&&t0.has(b.viewerPermission)),R=(0,c.useMemo)(()=>{var e;return null!=w&&w.repository&&null!==(e=b)&&void 0!==e&&null!==(e=e.defaultBranchRef)&&void 0!==e&&e.name?{id:b.id,defaultBranch:b.defaultBranchRef.name,hasWritePermission:E,isPrivate:b.isPrivate,name:b.name,owner:b.owner.login,upstream:{name:b.name,owner:b.owner.login}}:null},[null==w?void 0:w.repository,E,null===(u=b)||void 0===u||null===(u=u.defaultBranchRef)||void 0===u?void 0:u.name,null===(d=b)||void 0===d?void 0:d.id,null===(f=b)||void 0===f?void 0:f.isPrivate,null===(h=b)||void 0===h?void 0:h.name,null===(p=b)||void 0===p?void 0:p.owner.login]);return(0,U.jsx)(t2.Provider,{value:y,children:(0,U.jsx)(t3.Provider,{value:e.currentBranch,children:(0,U.jsx)(t4.Provider,{value:_,children:(0,U.jsx)(t6.Provider,{value:R,children:(0,U.jsx)(t9.Provider,{value:j,children:(0,U.jsx)(ne.Provider,{value:P,children:"cloud"===e.config.storage.kind?(0,U.jsx)(tD,{config:e.config,children:e.children}):e.children})})})})})})}let t2=(0,c.createContext)(void 0),t3=(0,c.createContext)("");function t8(){return(0,c.useContext)(t3)}let t4=(0,c.createContext)(new Map);function t5(){return(0,c.useContext)(t4)}let t6=(0,c.createContext)(null);function t7(){return(0,c.useContext)(t6)}let t9=(0,c.createContext)({collections:new Map,singletons:new Set}),ne=(0,c.createContext)({unscopedDefault:{kind:"loading",promise:eB},scoped:{current:{kind:"loading",promise:eB},default:{kind:"loading",promise:eB},merged:{kind:"loading",promise:eB}}});function nt(){return(0,c.useContext)(ne).scoped}function nn(){return(0,c.useContext)(ne).unscopedDefault}function nr(){return(0,c.useContext)(t9)}function ni(){var e,t;let n=t5(),r=t8();return null!==(e=null===(t=n.get(r))||void 0===t?void 0:t.commitSha)&&void 0!==e?e:""}let no=(0,V.ZP)`
  fragment Ref_base on Ref {
    id
    name
    target {
      __typename
      id
      oid
      ... on Commit {
        tree {
          id
          oid
        }
      }
    }
  }
`,na=(0,V.ZP)`
  fragment Repo_base on Repository {
    id
    isPrivate
    owner {
      id
      login
    }
    name
    defaultBranchRef {
      id
      name
    }
    refs(refPrefix: "refs/heads/", first: 100) {
      nodes {
        ...Ref_base
      }
      pageInfo {
        hasNextPage
        endCursor
      }
    }
  }
  ${no}
`,nl=(0,V.ZP)`
  query CloudAppShell($name: String!, $owner: String!) {
    repository(owner: $owner, name: $name) {
      id
      ...Repo_base
    }
  }
  ${na}
`,ns=(0,V.ZP)`
  fragment Repo_ghDirect on Repository {
    id
    ...Repo_base
    viewerPermission
  }
  ${na}
`,nu=(0,V.ZP)`
  fragment Repo_primary on Repository {
    id
    ...Repo_ghDirect
    forks(affiliations: [OWNER], first: 1) {
      nodes {
        ...Repo_ghDirect
      }
    }
  }
  ${ns}
`,nc=(0,V.ZP)`
  query GitHubAppShell($name: String!, $owner: String!) {
    repository(owner: $owner, name: $name) {
      id
      ...Repo_primary
    }
    viewer {
      ...SidebarFooter_viewer
    }
  }
  ${nu}
  ${th}
`,nd=new et.z({max:40});async function nf(e){let t={entries:new Map(e.map(e=>[e.path,e])),tree:eN(e)},n=await eF(t.tree);return nd.set(n,t),t}function nh(e,t){let n=nd.get(e);if(n)return n;let r=function(e){let t=t$();return t instanceof Map?tS(e,t):t.then(t=>tS(e,t))}(e);if(r&&!(r instanceof Promise)){let t={entries:new Map(eH(r.children).map(e=>[e.path,e])),tree:r.children};return nd.set(e,t),t}let i=(async()=>{let n=await r;if(n){let t={entries:new Map(eH(n.children).map(e=>[e.path,e])),tree:n.children};return nd.set(e,t),t}let i=await tf(t);if(!i)throw Error("Not authorized");let{tree:o}=await fetch("github"===t.storage.kind?`https://api.github.com/repos/${tv(t.storage.repo)}/git/trees/${e}?recursive=1`:`${ti}/v1/github/trees/${e}`,{headers:{Authorization:`Bearer ${i.accessToken}`,..."cloud"===t.storage.kind?to:{}}}).then(e=>e.json()),a=o.map(({url:e,size:t,...n})=>n);return await function(e,t){let n=[];return function e(t,n,r){let i=[];for(let[t,o]of n)i.push({path:t.replace(/.*\//,""),mode:o.entry.mode,sha:o.entry.sha}),o.children&&e(o.entry.sha,o.children,r);r.push([t,i])}(e,t,n),(0,ee.vw)(n,tb())}(e,eN(a)),nf(a)})();return nd.set(e,i),i}function np(e,t){return eW((0,c.useCallback)(()=>e?nh(e,t):eB,[e,t]))}function nm(e,t){var n,r;return{collections:new Map(Object.keys(null!==(n=e.collections)&&void 0!==n?n:{}).map(n=>{let r=new Map(tr(e,n,t.current.tree).map(e=>[e.slug,e.key])),i=new Map(tr(e,n,t.default.tree).map(e=>[e.slug,e.key])),o=new Set,a=new Set;for(let[e,t]of r){let n=i.get(e);if(void 0===n){a.add(e);continue}t!==n&&o.add(e)}return[n,{removed:new Set([...i.keys()].filter(e=>!r.has(e))),added:a,changed:o,totalCount:r.size}]})),singletons:new Set(Object.keys(null!==(r=e.singletons)&&void 0!==r?r:{}).filter(n=>{var r,i;let o=ew(e,n);return(null===(r=eP(t.current.tree,o))||void 0===r?void 0:r.entry.sha)!==(null===(i=eP(t.default.tree,o))||void 0===i?void 0:i.entry.sha)}))}}let ng=(0,c.createContext)(null);function nv(){let e=(0,c.useContext)(ng);if(!e)throw Error("ConfigContext.Provider not found");return e}let nw=(0,c.createContext)({basePath:"/keystatic"});function ny(){let e=(0,c.useContext)(nw);if(!e)throw Error("AppStateContext.Provider not found");return e}let nb=(0,c.createContext)("mobile"),nk=nb.Provider;function nx(){return(0,c.useContext)(nb)}function nC(e){let t=["mobile","tablet","desktop","wide"],n=nx(),r="above"in e?t.indexOf(e.above)+1:0,i="below"in e?t.indexOf(e.below)-1:t.length-1;return t.slice(r,i+1).includes(n)}function nM(e){let t,n;let r=(0,s.c)(5),[i,o]=(0,c.useState)("mobile");r[0]!==e.current?(t=()=>{o(t=>{let n=e.current;return n?n.offsetWidth>=S.AV.wide?"wide":n.offsetWidth>=S.AV.desktop?"desktop":n.offsetWidth>=S.AV.tablet?"tablet":"mobile":t})},r[0]=e.current,r[1]=t):t=r[1];let a=t;return r[2]!==e||r[3]!==a?(n={ref:e,onResize:a},r[2]=e,r[3]=a,r[4]=n):n=r[4],(0,R.y)(n),i}function n$(e){let t=window.getSelection();t&&(t.removeAllRanges(),t.addRange(d.F3.toDOMRange(e,e.selection))),d.F3.focus(e)}let nS=(0,S.iv)({marginBlock:"0.75em","&:first-child":{marginBlockStart:0},"&:last-child":{marginBlockEnd:0}});function nP(e,t){let[n,r]=(0,c.useState)({element:t,elementWithChanges:t});n.element!==t&&r({element:t,elementWithChanges:t});let i=(0,c.useRef)(t);(0,c.useEffect)(()=>{i.current=t});let o=(0,c.useCallback)(t=>{let n=i.current,o="function"==typeof t?t(n):t;P.YR.setNodes(e,o,{at:d.F3.findPath(e,n)}),r({element:n,elementWithChanges:{...n,...o}})},[e]);return[n.elementWithChanges,o]}function nj(e){let t=(0,c.useRef)(e),n=(0,c.useCallback)((...e)=>t.current(...e),[]);return(0,c.useEffect)(()=>{t.current=e}),n}function n_(e,t){var n;let r;let i=P.ML.above(e,{match:e=>"heading"===e.type||"paragraph"===e.type});i&&""===P.NB.string(i[0])&&(r=P.ML.pathRef(e,i[1])),P.YR.insertNodes(e,t);let o=null===(n=r)||void 0===n?void 0:n.unref();o&&(P.YR.removeNodes(e,{at:o}),d.F3.focus(e))}c.createContext(!1).Provider;let nE=["paragraph","code","heading","ordered-list","unordered-list","divider","image"],nR=[...nE,"table"],nI=[...nR,"blockquote","component-block"];function nT(e){return{kind:"blocks",allowedChildren:new Set(e.allowedChildren),blockToWrapInlinesIn:e.allowedChildren[0],invalidPositionHandleMode:e.invalidPositionHandleMode}}function nF(e){return{kind:"inlines",invalidPositionHandleMode:e.invalidPositionHandleMode}}let nL={editor:nT({allowedChildren:[...nI,"layout"],invalidPositionHandleMode:"move"}),layout:nT({allowedChildren:["layout-area"],invalidPositionHandleMode:"move"}),"layout-area":nT({allowedChildren:nI,invalidPositionHandleMode:"unwrap"}),blockquote:nT({allowedChildren:nR,invalidPositionHandleMode:"move"}),paragraph:nF({invalidPositionHandleMode:"unwrap"}),code:nF({invalidPositionHandleMode:"move"}),divider:nF({invalidPositionHandleMode:"move"}),heading:nF({invalidPositionHandleMode:"unwrap"}),"component-block":nT({allowedChildren:["component-block-prop","component-inline-prop"],invalidPositionHandleMode:"move"}),"component-inline-prop":nF({invalidPositionHandleMode:"unwrap"}),"component-block-prop":nT({allowedChildren:nI,invalidPositionHandleMode:"unwrap"}),"ordered-list":nT({allowedChildren:["list-item"],invalidPositionHandleMode:"move"}),"unordered-list":nT({allowedChildren:["list-item"],invalidPositionHandleMode:"move"}),"list-item":nT({allowedChildren:["list-item-content","ordered-list","unordered-list"],invalidPositionHandleMode:"unwrap"}),"list-item-content":nF({invalidPositionHandleMode:"unwrap"}),image:nF({invalidPositionHandleMode:"move"}),table:nT({invalidPositionHandleMode:"move",allowedChildren:["table-head","table-body"]}),"table-body":nT({invalidPositionHandleMode:"move",allowedChildren:["table-row"]}),"table-row":nT({invalidPositionHandleMode:"move",allowedChildren:["table-cell"]}),"table-cell":nT({invalidPositionHandleMode:"move",allowedChildren:nE}),"table-head":nT({invalidPositionHandleMode:"move",allowedChildren:["table-row"]})},nU=new Set(Object.entries(nL).filter(([,e])=>"inlines"===e.kind).map(([e])=>e));function nA(e){return void 0!==e.type&&nU.has(e.type)}let nH=new Set(Object.keys(nL).filter(e=>"editor"!==e));function nO(e){return nH.has(e.type)}function nN(e,t){var n,r,i,o,a,l,s;let u=null===(n=t.formatting)||void 0===n?void 0:n.inlineMarks,c=Object.fromEntries(Object.keys(e.formatting.inlineMarks).map(t=>[t,("inherit"===u||(null==u?void 0:u[t])==="inherit")&&e.formatting.inlineMarks[t]])),d=null===(r=t.formatting)||void 0===r?void 0:r.headingLevels;return{formatting:{inlineMarks:c,softBreaks:(null===(i=t.formatting)||void 0===i?void 0:i.softBreaks)==="inherit"&&e.formatting.softBreaks,alignment:{center:e.formatting.alignment.center&&(null===(o=t.formatting)||void 0===o?void 0:o.alignment)==="inherit",end:e.formatting.alignment.end&&(null===(a=t.formatting)||void 0===a?void 0:a.alignment)==="inherit"},blockTypes:(null===(l=t.formatting)||void 0===l?void 0:l.blockTypes)==="inherit"?e.formatting.blockTypes:{blockquote:!1,code:!1},headings:"inherit"===d?e.formatting.headings:{levels:d?e.formatting.headings.levels.filter(e=>d.includes(e)):[],schema:e.formatting.headings.schema},listTypes:(null===(s=t.formatting)||void 0===s?void 0:s.listTypes)==="inherit"?e.formatting.listTypes:{ordered:!1,unordered:!1}},dividers:"inherit"===t.dividers&&e.dividers,images:"inherit"===t.images&&e.images,layouts:[],links:"inherit"===t.links&&e.links,tables:"inherit"===t.tables&&e.tables}}function nB(e,t){var n,r,i,o,a,l,s;let u=null===(n=t.formatting)||void 0===n?void 0:n.inlineMarks,c="inherit"===u?"inherit":Object.fromEntries(Object.keys(e.formatting.inlineMarks).map(e=>[e,!!(u||{})[e]]));if("inline"===t.kind)return{kind:"inline",inlineMarks:c,documentFeatures:{links:"inherit"===t.links},softBreaks:(null===(s=t.formatting)||void 0===s?void 0:s.softBreaks)==="inherit"};let d=null===(r=t.formatting)||void 0===r?void 0:r.headingLevels;return{kind:"block",inlineMarks:c,softBreaks:(null===(i=t.formatting)||void 0===i?void 0:i.softBreaks)==="inherit",documentFeatures:{layouts:[],dividers:"inherit"===t.dividers&&e.dividers,formatting:{alignment:(null===(o=t.formatting)||void 0===o?void 0:o.alignment)==="inherit"?e.formatting.alignment:{center:!1,end:!1},blockTypes:(null===(a=t.formatting)||void 0===a?void 0:a.blockTypes)==="inherit"?e.formatting.blockTypes:{blockquote:!1,code:!1},headings:"inherit"===d?e.formatting.headings:{levels:d?e.formatting.headings.levels.filter(e=>d.includes(e)):[],schema:e.formatting.headings.schema},listTypes:(null===(l=t.formatting)||void 0===l?void 0:l.listTypes)==="inherit"?e.formatting.listTypes:{ordered:!1,unordered:!1}},links:"inherit"===t.links,images:"inherit"===t.images&&e.images,tables:"inherit"===t.tables},componentBlocks:"inherit"===t.componentBlocks}}function nD(e,t,n){return function e(t,n,r){if(0===t.length)return r;if("child"!==r.kind&&"form"!==r.kind){if("conditional"===r.kind){let i=t.shift();if("discriminant"===i)return e(t,n.discriminant,r.discriminant);if("value"===i){let i=r.values[n.discriminant];return e(t,n.value,i)}return}if("object"===r.kind){let i=t.shift();return e(t,n[i],r.fields[i])}if("array"===r.kind){let i=t.shift();return e(t,n[i],r.element)}(0,L.vE)(r)}}([...e],t,{kind:"object",fields:n})}function nz(e,t,n){let r=[],i=[...t],o=e,a=n;for(;i.length;){r.push(o);let e=i.shift();if("array"===o.kind)o=o.element,a=a[e];else if("conditional"===o.kind)o=o.values[n.discriminant],a=a.value;else if("object"===o.kind)a=a[e],o=o.fields[e];else if("child"===o.kind||"form"===o.kind)throw Error(`unexpected prop "${e}"`);else(0,L.vE)(o)}return r}function nW(e,t,n){let r=nD(e,n,t);return(null==r?void 0:r.kind)==="child"&&("block"===r.options.kind&&"modal"!==r.options.editIn||"inline"===r.options.kind)?r.options.placeholder:""}function nZ(e){return P.W_.isElement(e)?{...e,children:e.children.map(nZ)}:{...e}}let nK=["bold","italic","underline","strikethrough","code","superscript","subscript","keyboard"],nq=(e,t)=>{let[n]=P.ML.nodes(e,{match:e=>e.type===t});return!!n};function nY(e){P.YR.unwrapNodes(e,{match:e=>"heading"===e.type||"blockquote"===e.type||"code"===e.type}),P.YR.unsetNodes(e,nK,{match:P.xv.isText})}function nG(e,t,n,r=()=>!0){let i=P.y$.isPath(t)?t:t[1],o=P.y$.isPath(t)?P.NB.get(e,i):t[0];if(nO(o)){for(let t=o.children.length-1;t>=0;t--)if(r(o.children[t],t)){let r=[...i,t];P.YR.moveNodes(e,{at:r,to:n})}}}function nV(e,t,{distance:n=1}={}){let r;let i=P.ML.point(e,t,{edge:"end"}),o=P.ML.end(e,[]),a=0;for(let t of P.ML.positions(e,{at:{anchor:i,focus:o}})){if(a>n)break;P.NB.get(e,t.path).text.length!==t.offset&&(0!==a&&(r=t),a++)}return r}function nJ(...e){if(1===e.length){let t=e[0];return e=>e.type===t}let t=new Set(e);return e=>"string"==typeof e.type&&t.has(e.type)}function nQ(e,t,n){let r=P.ML.above(e,{match:nJ("component-block-prop","component-inline-prop")});if(r){let i=r[0].propPath,o=P.ML.parent(e,r[1]);if("component-block"===o[0].type){let e=n[o[0].component];if(e&&i){let n=nD(i,o[0].props,e.schema);if((null==n?void 0:n.kind)==="child")return nB(t,n.options)}}}}let nX=(0,c.createContext)(null);function n0(){let e=(0,c.useContext)(nX);if(!e)throw Error("useBlockPopoverContext must be used within a BlockPopoverTrigger");return e}let n1=nJ("code","component-block","image","layout","link","table","heading"),n2=(0,c.createContext)(void 0);function n3(){return(0,c.useContext)(n2)}function n8(e){let t=P.ML.above(e.editor,{match:n1});return(0,U.jsx)(n2.Provider,{value:null==t?void 0:t[0],children:e.children})}let n4=({children:e,element:t})=>{let[n,r]=e,i=n3(),o=(0,c.useRef)(null),a=(0,u.d)({isOpen:i===t}),l=(0,c.useMemo)(()=>({state:a,triggerRef:o}),[a,o]);return(0,U.jsxs)(nX.Provider,{value:l,children:[(0,c.cloneElement)(n,{ref:o}),r]})};function n5(e){let{state:t}=n0(),n=(0,c.useRef)(null);return(0,U.jsx)(F.aV,{isOpen:t.isOpen,nodeRef:n,children:(0,U.jsx)(n6,{wrapperRef:n,...e})})}let n6=({children:e,placement:t="bottom"})=>{let n=(0,c.useRef)(null),{state:r,triggerRef:i}=n0(),{placement:o,popoverProps:a}=function(e,t){var n;let{triggerRef:r,popoverRef:i,isNonModal:o,isKeyboardDismissDisabled:a,...l}=e,[s,u]=(0,c.useState)(!1),{overlayProps:d,underlayProps:f}=(0,j.I)({isOpen:t.isOpen,onClose:t.close,shouldCloseOnBlur:!0,isDismissable:!o,isKeyboardDismissDisabled:!1},i);(0,c.useEffect)(()=>{if(t.isOpen){let e=()=>{var e,t;let n=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0),o=null===(e=i.current)||void 0===e?void 0:e.getBoundingClientRect(),a=null===(t=r.current)||void 0===t?void 0:t.getBoundingClientRect();o&&a&&u(a.bottom+o.height+16>n&&a.top<n)};return e(),window.addEventListener("scroll",e),()=>{e(),window.removeEventListener("scroll",e)}}},[i,r,t.isOpen]);let{overlayProps:h,arrowProps:p,placement:m,updatePosition:g}=(0,_.t)({...l,containerPadding:8,shouldFlip:!1,targetRef:r,overlayRef:i,isOpen:t.isOpen,onClose:void 0}),v=function(e){let t=(0,c.useRef)(void 0);return(0,c.useEffect)(()=>{t.current=e}),t.current}(null===(n=r.current)||void 0===n?void 0:n.getBoundingClientRect());return(0,I.b)(()=>{if(v){var e;let t=null===(e=r.current)||void 0===e?void 0:e.getBoundingClientRect();t&&(v.height!==t.height||v.width!==t.width||v.x!==t.x||v.y!==t.y)&&g()}},[v,r,g]),h.style&&(h.style.zIndex=1),s&&(h.style={...h.style,maxHeight:null,position:"fixed",top:null,bottom:8}),{arrowProps:p,placement:m,popoverProps:(0,T.d)(d,h),underlayProps:f,updatePosition:g}}({isNonModal:!0,isKeyboardDismissDisabled:!1,placement:t,triggerRef:i,popoverRef:n},r);return(0,U.jsx)("div",{ref:n,...a,"data-open":r.isOpen,"data-placement":o,contentEditable:!1,className:(0,S.iv)({backgroundColor:S.iK.color.background.surface,borderRadius:S.iK.size.radius.medium,border:`${S.iK.size.border.regular} solid ${S.iK.color.border.emphasis}`,boxSizing:"content-box",minHeight:S.iK.size.element.regular,minWidth:S.iK.size.element.regular,opacity:0,outline:0,pointerEvents:"auto",position:"absolute",filter:`drop-shadow(0 1px 4px ${S.iK.color.shadow.regular})`,willChange:"filter",userSelect:"none",'&[data-placement="top"]':{marginBottom:S.iK.size.space.regular,transform:`translateY(${S.iK.size.space.regular})`},'&[data-placement="bottom"]':{marginTop:S.iK.size.space.regular,transform:`translateY(calc(${S.iK.size.space.regular} * -1))`},'&[data-open="true"]':{opacity:1,transform:"translateX(0) translateY(0)",transition:(0,S.eR)(["opacity","transform"],{easing:"easeOut"})}}),children:"function"==typeof e?e(r.close):e})},n7=(0,c.forwardRef)(function({className:e,...t},n){return(0,U.jsx)("div",{...t,ref:n,className:[(0,S.iv)({userSelect:"none",whiteSpace:"initial"}),e].join(" "),contentEditable:!1})}),n9=f.dt({src:f.Z_(),width:f.Rx(),height:f.Rx()});function re(e){try{let t=JSON.parse(e);if("object"==typeof t&&null!==t&&"src"in t&&"string"==typeof t.src)return{src:t.src,alt:"alt"in t&&"string"==typeof t.alt?t.alt:"",height:"height"in t&&"number"==typeof t.height&&Number.isInteger(t.height)?t.height:void 0,width:"width"in t&&"number"==typeof t.width&&Number.isInteger(t.width)?t.width:void 0}}catch(e){}let t=e.match(/^\s*!\[(.*)\]\(([a-z0-9_\-/:.]+)\)\s*$/);return t?{src:t[2],alt:t[1]}:{src:e,alt:""}}function rt(e){return new Promise((t,n)=>{let r=new Image;r.onload=()=>{t({width:r.width,height:r.height})},r.onerror=()=>{n()},r.src=e})}let rn=f.dt({src:f.Z_(),alt:f.Z_(),width:f.Rx(),height:f.Rx()});async function rr(e,t){let n=td(t);if(n){let t=await fetch(`${ti}/v1/image?${new URLSearchParams({url:e})}`,{headers:{Authorization:`Bearer ${n.accessToken}`,...to}});if(t.ok){let e=await t.json();try{return rn.create(e)}catch{}}}return rt(e).then(t=>({src:e,alt:"",...t}))}function ri(e){let t,n,r,i,o,a,l,u,d,f,p,b,x,C,$,S,P;let j=(0,s.c)(42),_=function(e){let t,n,r;let i=(0,s.c)(4);i[0]===Symbol.for("react.memo_cache_sentinel")?(t={},i[0]=t):t=i[0];let[o,a]=(0,c.useState)(t);return i[1]!==e?(n=()=>{let t;if(!e||!function(e){try{return new URL(e),!0}catch{return!1}}(e)){a({});return}return t=!0,rt(e).then(e=>{t&&a(e)}),()=>{t=!1}},r=[e],i[1]=e,i[2]=n,i[3]=r):(n=i[2],r=i[3]),(0,c.useEffect)(n,r),o}(e.src),[E,R]=(0,c.useState)(!0),I=`Revert to original (${_.width} \xd7 ${_.height})`,T=_.width===e.image.width&&_.height===e.image.height;j[0]===Symbol.for("react.memo_cache_sentinel")?(t={maximumFractionDigits:0},j[0]=t):t=j[0],j[1]!==E||j[2]!==e?(n=t=>{E?e.onChange({width:t,height:Math.round(t/ru(e.image))}):e.onChange({width:t})},j[1]=E,j[2]=e,j[3]=n):n=j[3],j[4]!==e.image.width||j[5]!==n?(r=(0,U.jsx)(k.K,{label:"Width",width:"scale.1600",formatOptions:t,value:e.image.width,onChange:n}),j[4]=e.image.width,j[5]=n,j[6]=r):r=j[6],j[7]===Symbol.for("react.memo_cache_sentinel")?(i=()=>{R(e=>!e)},j[7]=i):i=j[7];let F=E?g.i:v.H;j[8]!==F?(o=(0,U.jsx)(m.J,{src:F}),j[8]=F,j[9]=o):o=j[9],j[10]!==E||j[11]!==o?(a=(0,U.jsx)(h.CO,{isSelected:E,"aria-label":"Constrain proportions",prominence:"low",onPress:i,children:o}),j[10]=E,j[11]=o,j[12]=a):a=j[12],j[13]===Symbol.for("react.memo_cache_sentinel")?(l=(0,U.jsx)(M.u,{children:"Constrain proportions"}),j[13]=l):l=j[13],j[14]!==a?(u=(0,U.jsxs)(M.a,{children:[a,l]}),j[14]=a,j[15]=u):u=j[15],j[16]===Symbol.for("react.memo_cache_sentinel")?(d={maximumFractionDigits:0},j[16]=d):d=j[16],j[17]!==E||j[18]!==e?(f=t=>{E?e.onChange({height:t,width:Math.round(t*ru(e.image))}):e.onChange({height:t})},j[17]=E,j[18]=e,j[19]=f):f=j[19],j[20]!==e.image.height||j[21]!==f?(p=(0,U.jsx)(k.K,{label:"Height",width:"scale.1600",formatOptions:d,value:e.image.height,onChange:f}),j[20]=e.image.height,j[21]=f,j[22]=p):p=j[22];let L=T||!_.width||!_.height;return j[23]!==e||j[24]!==_.height||j[25]!==_.width?(b=()=>{e.onChange({height:_.height,width:_.width})},j[23]=e,j[24]=_.height,j[25]=_.width,j[26]=b):b=j[26],j[27]===Symbol.for("react.memo_cache_sentinel")?(x=(0,U.jsx)(m.J,{src:w.I}),j[27]=x):x=j[27],j[28]!==I||j[29]!==L||j[30]!==b?(C=(0,U.jsx)(h.Kk,{"aria-label":I,isDisabled:L,onPress:b,children:x}),j[28]=I,j[29]=L,j[30]=b,j[31]=C):C=j[31],j[32]!==I?($=(0,U.jsx)(M.u,{maxWidth:"100%",children:I}),j[32]=I,j[33]=$):$=j[33],j[34]!==C||j[35]!==$?(S=(0,U.jsxs)(M.a,{children:[C,$]}),j[34]=C,j[35]=$,j[36]=S):S=j[36],j[37]!==r||j[38]!==u||j[39]!==p||j[40]!==S?(P=(0,U.jsxs)(y.Ug,{gap:"regular",alignItems:"end",children:[r,u,p,S]}),j[37]=r,j[38]=u,j[39]=p,j[40]=S,j[41]=P):P=j[41],P}let ro={src:"",alt:""},ra=["jpeg","jpg","png","gif","webp"].map(e=>`image/${e}`);function rl(e){var t;let n,r,i,o;let a=(0,s.c)(12);if(a[0]!==e){let{onUploaded:t,...r}=e;n=r,a[0]=e,a[1]=n}else n=a[1];let l=nv(),[u,d]=(0,c.useState)(!1);if(!(null!==(t=l.cloud)&&void 0!==t&&t.project))return null;a[2]!==l||a[3]!==e?(r=async t=>{let n=Array.from(t||[]);if(n[0]){d(!0);try{let t=await function(e,t){if(e.size>1e7)throw Error("Images must be smaller than 10MB");let n=td(t);if(!n)throw Error("You must be signed in to upload images");let r=/(.+)\.(png|jpe?g|gif|webp)$/.exec(e.name);if(!r)throw Error("Invalid image type, only PNG, JPEG, GIF, and WebP are supported");let i=r[1].toLowerCase().trim().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9\s-]/g," ").trim().replace(/[\s-]+/g,"-"),o=r[2],a=`${i}.${o}`,l=new File([e],a,{type:`image/${"jpg"===a?"jpeg":a}`}),s=new FormData;return s.set("image",l,a),(async()=>{let e;let t=await fetch(`${ti}/v1/image`,{method:"PUT",headers:{Authorization:`Bearer ${n.accessToken}`,...to},body:s});if(!t.ok)throw Error(`Failed to upload image: ${await t.text()}`);let r=await t.json();try{e=n9.create(r)}catch{throw Error("Unexpected response from cloud")}return e})()}(n[0],l);e.onUploaded({...t,alt:""}),d(!1)}catch(e){d(!1),C.g.critical(e.message)}}},a[2]=l,a[3]=e,a[4]=r):r=a[4];let f=u?"Uploading":"Upload";return a[5]!==u||a[6]!==n||a[7]!==f?(i=(0,U.jsx)(h.Kk,{isDisabled:u,...n,children:f}),a[5]=u,a[6]=n,a[7]=f,a[8]=i):i=a[8],a[9]!==r||a[10]!==i?(o=(0,U.jsx)(p.IB,{acceptedFileTypes:ra,onSelect:r,children:i}),a[9]=r,a[10]=i,a[11]=o):o=a[11],o}function rs(){let e=function(e){var t;if(!(null!==(t=e.cloud)&&void 0!==t&&t.project))return;let[n,r]=e.cloud.project.split("/");return{team:n,project:r}}(nv());return e?`https://keystatic.cloud/teams/${e.team}/project/${e.project}/images`:"https://keystatic.cloud/"}function ru(e){return e.width&&e.height?e.width/e.height:1}class rc extends Error{constructor(e){super(e),this.name="FieldDataError"}}function rd(e,t,n){if(null===e&&null!=t&&t.isRequired)throw new rc(`${n} is required`)}function rf(e){return{kind:"form",Input:e.Input,defaultValue:e.defaultValue,parse:e.parse,serialize:e.serialize,validate:e.validate,reader:{parse:t=>e.validate(e.parse(t))},label:e.label}}function rh(e,t){return e.length===t.length&&e.every((e,n)=>e===t[n])}function rp([e,t],n,r,i){let o=Object.keys(e).filter(e=>"text"!==e&&"insertMenu"!==e&&!0!==r[e]);if(o.length)return P.YR.unsetNodes(n,o,{at:t}),!0;if(!i&&e.text.includes("\n")){let[e]=P.ML.parent(n,t);if("code"!==e.type){for(let e of P.ML.positions(n,{at:t}))if("\n"===P.NB.get(n,e.path).text[e.offset])return P.YR.delete(n,{at:e}),!0}}return!1}function rm([e,t],n,r){return"link"===e.type&&!r&&(P.YR.insertText(n,` (${e.href})`,{at:P.ML.end(n,t)}),P.YR.unwrapNodes(n,{at:t}),!0)}function rg([e,t],n,{formatting:r,dividers:i,layouts:o,links:a,images:l,tables:s}){return("heading"!==e.type||r.headings.levels.length&&r.headings.levels.includes(e.level))&&("ordered-list"!==e.type||r.listTypes.ordered)&&("unordered-list"!==e.type||r.listTypes.unordered)&&("code"!==e.type||r.blockTypes.code)&&("blockquote"!==e.type||r.blockTypes.blockquote)&&("image"!==e.type||l)&&("table"!==e.type||s)&&("layout"!==e.type||0!==o.length&&o.some(t=>rh(t,e.layout)))?("paragraph"===e.type||"heading"===e.type)&&(!r.alignment.center&&"center"===e.textAlign||!r.alignment.end&&"end"===e.textAlign||"textAlign"in e&&"center"!==e.textAlign&&"end"!==e.textAlign)?(P.YR.unsetNodes(n,"textAlign",{at:t}),!0):"divider"!==e.type||i?rm([e,t],n,a):(P.YR.removeNodes(n,{at:t}),!0):(P.YR.unwrapNodes(n,{at:t}),!0)}function rv(e,t){let{normalizeNode:n}=t;return t.normalizeNode=([r,i])=>{P.xv.isText(r)?rp([r,i],t,e.formatting.inlineMarks,e.formatting.softBreaks):P.W_.isElement(r)&&rg([r,i],t,e),n([r,i])},t}function rw(e){let t=tA(),n=tG(),r=ea(),i=tN(),o=(0,c.useMemo)(()=>{if(!t||"loading"===t||!n)return[];let o=[];for(let[n,a]of i)n!==t.awareness.clientID&&a.user&&r.href===`/keystatic/branch/${a.branch}/${a.location}`&&Array.isArray(a.path)&&rh(a.path,e.path)&&o.push(a.user);return o},[t,n,i,r.href,e.path]);return(0,U.jsxs)("div",{"data-ks-path":JSON.stringify(e.path),onFocus:n=>{n.target.closest("[data-ks-path]")===n.currentTarget&&t&&"loading"!==t&&t.awareness.setLocalStateField("path",e.path)},children:[!!o.length&&(0,U.jsx)("div",{className:(0,S.iv)({position:"relative",width:"100%",height:0}),children:(0,U.jsx)("div",{className:(0,S.iv)({position:"absolute",top:0,right:0,display:"flex",gap:"0.5em"}),children:o.map((e,t)=>(0,U.jsx)(er.q,{size:"xsmall",src:e.avatarUrl,name:e.name},t))})}),e.children]})}function ry(e){let t,n,r;let i=(0,s.c)(9),o=(0,c.useContext)(rx),a=nv();i[0]!==o||i[1]!==e.part?(n=o.concat(e.part),i[0]=o,i[1]=e.part,i[2]=n):n=i[2],t=n,i[3]!==t||i[4]!==e.children?(r=(0,U.jsx)(rx.Provider,{value:t,children:e.children}),i[3]=t,i[4]=e.children,i[5]=r):r=i[5];let l=r;if("cloud"===a.storage.kind){let e;return i[6]!==t||i[7]!==l?(e=(0,U.jsx)(rw,{path:t,children:l}),i[6]=t,i[7]=l,i[8]=e):e=i[8],e}return l}let rb=(0,c.createContext)(void 0),rk=rb.Provider,rx=(0,c.createContext)([]),rC=rx.Provider;function rM(e,t,n,r,i,o){if(e.length<t)return 1===t?`${r} must not be empty`:`${r} must be at least ${t} characters long`;if(e.length>n)return`${r} must be no longer than ${n} characters`;if(o&&!o.regex.test(e))return o.message||`${r} must match the pattern ${o.regex}`;if(i){if(""===e)return`${r} must not be empty`;if(".."===e)return`${r} must not be ..`;if("."===e)return`${r} must not be .`;if("**"===i.glob){let t=e.split("/");if(t.some(e=>".."===e))return`${r} must not contain ..`;if(t.some(e=>"."===e))return`${r} must not be .`}if(("*"===i.glob?/[\\/]/:/[\\]/).test(e))return`${r} must not contain slashes`;if(/^\s|\s$/.test(e))return`${r} must not start or end with spaces`;if(i.slugs.has(e))return`${r} must be unique`}}function r$(e){let t,n,r;let i=(0,s.c)(15),o=e.multiline?x.Kx:x.nv,[a,l]=(0,c.useState)(!1),u=(0,c.useContext)(rb),d=(0,c.useContext)(rx);i[0]===Symbol.for("react.memo_cache_sentinel")?(t=()=>l(!0),i[0]=t):t=i[0];let f=e.min>0;return i[1]!==e||i[2]!==a||i[3]!==d||i[4]!==u?(n=e.forceValidation||a?rM(e.value,e.min,e.max,e.label,1===d.length&&(null==u?void 0:u.field)===d[0]?u:void 0,e.pattern):void 0,i[1]=e,i[2]=a,i[3]=d,i[4]=u,i[5]=n):n=i[5],i[6]!==o||i[7]!==e.label||i[8]!==e.description||i[9]!==e.autoFocus||i[10]!==e.value||i[11]!==e.onChange||i[12]!==f||i[13]!==n?(r=(0,U.jsx)(o,{label:e.label,description:e.description,autoFocus:e.autoFocus,value:e.value,onChange:e.onChange,onBlur:t,isRequired:f,errorMessage:n}),i[6]=o,i[7]=e.label,i[8]=e.description,i[9]=e.autoFocus,i[10]=e.value,i[11]=e.onChange,i[12]=f,i[13]=n,i[14]=r):r=i[14],r}function rS(e){if(void 0===e)return"";if("string"!=typeof e)throw new rc("Must be a string");return e}let rP=new Set;function rj({label:e,defaultValue:t="",validation:{length:{max:n=1/0,min:r=0}={},pattern:i,isRequired:o}={},description:a,multiline:l=!1}){function s(t,o){let a=rM(t,r,n,e,o,i);if(void 0!==a)throw new rc(a);return t}return r=Math.max(o?1:0,r),{kind:"form",formKind:"slug",label:e,Input:t=>(0,U.jsx)(r$,{label:e,description:a,min:r,max:n,multiline:l,pattern:i,...t}),defaultValue:()=>"string"==typeof t?t:t(),parse:(e,t)=>(null==t?void 0:t.slug)!==void 0?t.slug:rS(e),serialize:e=>({value:""===e?void 0:e}),serializeWithSlug:e=>({slug:e,value:void 0}),reader:{parse:e=>s(rS(e),void 0),parseWithSlug:(e,t)=>(s(rS(t.slug),{glob:t.glob,slugs:rP}),null)},validate:(e,t)=>s(e,null==t?void 0:t.slugField)}}}}]);