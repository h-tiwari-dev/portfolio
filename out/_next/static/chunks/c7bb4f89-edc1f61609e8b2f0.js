"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[302],{23249:function(e,t,n){n.d(t,{h:function(){return tW}});var i=n(70367),a=n(2265),l=n(48985),r=n(23933),o=n(18011),s=n(9139),c=n(19954),d=n(97149),u=n(73106),h=n(71001),m=n(42761),f=n(58886),g=n(66232),p=n(84548),b=n(48296),v=n(88699),y=n(4891),x=n(50538),j=n(12540),k=n(60556),w=n(82905),S=n(79497),C=n(26033),_=n(12837),$=n(57437),P=n(70382);n(63289);var I=n(94768);n(68275),n(97814);var R=n(56325);n(16189);var F=n(9653);n(73553),n(68306);var T=n(52240),E=n(59569);n(87734),n(71485),n(62182),n(42077),n(93173),n(94333);var U=n(33155);n(28492),n(59543),n(80653),n(86479),n(85451),n(75148),n(44658);var K=n(72255),D=n(49914),L=n(59367),A=n(29246),O=n(93748),z=n(89957),W=n(37057),H=n(41846),M=n(81867),N=n(91404),q=n(97742),B=n(32480),G=n(67303),J=n(23317),V=n(59329),Q=n(17545),Z=n(86560),Y=n(28992),X=n(87684),ee=n(6635),et=n(55374),en=n(24856),ei=n(33937),ea=n(65313),el=n(55400),er=n(66790),eo=n(76508),es=n(71178),ec=n(75906),ed=n(19390),eu=n(26182);n(97853),n(21188),n(24721),n(52343),n(51160),n(44180),n(99098),n(43713),n(74989),n(5559),n(94363),n(66114),n(24905),n(63873),n(91443),n(53930),n(75141),n(62007),n(62139),n(51236),n(53210),n(89518),n(90361),n(13450),n(18216),n(46548),n(74433),n(97163),n(39177),n(2475),n(94382),n(83476),n(18091),n(29420),n(86609),n(20719),n(79964),n(48224),n(92463),n(46834),n(88013),n(70292),n(74984),n(80368),n(28013),n(19618),n(36453),n(2595),n(35506),n(76167),n(67882),n(54887),n(67437),n(26984),n(82955),n(57845),n(49105),n(92732),n(55352);let eh=new Intl.Collator(void 0,{sensitivity:"base"});function em(e){let t,n,a;let l=(0,i.c)(5);return l[0]===Symbol.for("react.memo_cache_sentinel")?(t={mobile:"medium",tablet:"xlarge",desktop:"xxlarge"},l[0]=t):t=l[0],l[1]!==e?(n="children"in e?e.children:(0,$.jsxs)($.Fragment,{children:[e.icon&&(0,$.jsx)(r.J,{src:e.icon,size:"large",color:"neutralEmphasis"}),e.title&&(0,$.jsx)(d.X6,{align:"center",size:"medium",children:e.title}),e.message&&(0,$.jsx)(d.xv,{align:"center",children:e.message}),e.actions]}),l[1]=e,l[2]=n):n=l[2],l[3]!==n?(a=(0,$.jsx)(c.kC,{alignItems:"center",direction:"column",gap:"large",justifyContent:"center",minHeight:"scale.3000",paddingX:t,children:n}),l[3]=n,l[4]=a):a=l[4],a}class ef extends Error{constructor(){super("Not found"),this.name="NotFoundError"}}function eg(e){return"object"==typeof e&&null!==e&&e instanceof ef}function ep(){throw new ef}class eb extends a.Component{constructor(e){super(e),this.state={notFound:!1,lastHref:e.href}}static getDerivedStateFromError(e){if(eg(e))return{notFound:!0};throw e}static getDerivedStateFromProps(e,t){return e.href!==t.lastHref&&t.notFound?{notFound:!1,lastHref:e.href}:{notFound:t.notFound,lastHref:e.href}}render(){return this.state.notFound?this.props.fallback:this.props.children}}function ev(e){let t;let n=(0,i.c)(3),a=(0,_.u)();return n[0]!==e||n[1]!==a.href?(t=(0,$.jsx)(eb,{...e,href:a.href}),n[0]=e,n[1]=a.href,n[2]=t):t=n[2],t}class ey extends Map{#e;constructor(e,t){super(t),this.#e=e}get(e){return this.#e(e),super.get(e)}}function ex(e,t){let n;let i=(0,_.g)(e.dirpath,e.format),a=t.get(i);if(!a)throw Error(`Could not find data file at ${i}`);let{loaded:l,extraFakeFile:r}=(0,K.l)(a,e.format,e.requireFrontmatter),o=new Map(t);r&&o.set(`${e.dirpath}/${r.path}`,r.contents);let s=new Set([i]),c=(0,_.o)(e.schema),d=e=>(s.add(e),o.get(e)),u=(t,n)=>{let i=new ey(e=>{s.add(`${t}/${e}`)}),a=new Map;for(let[e]of o)if(e.startsWith(t+"/")){let n=e.slice(t.length+1);i.set(n,o.get(e))}for(let t of null!==(l=n.directories)&&void 0!==l?l:[]){var l,r,c;let n=new ey(e=>s.add(i+e)),i=`${t}${(null===(r=e.slug)||void 0===r?void 0:r.slug)===void 0?"":`/${null===(c=e.slug)||void 0===c?void 0:c.slug}`}/`;for(let[e,t]of o)if(e.startsWith(i)){let a=e.slice(i.length);n.set(a,t)}n.size&&a.set(t,n)}return{other:i,external:a}};try{n=(0,C.p)(c,l,[],[],(t,n,i,a)=>{var l,r,o,s,c,h;if(1===i.length&&i[0]===(null===(l=e.slug)||void 0===l?void 0:l.field)){if("slug"!==t.formKind)throw Error("slugField is not a slug field");return t.parse(n,{slug:e.slug.slug})}if("asset"===t.formKind){let i=a.join("/"),l=t.filename(n,{suggestedFilenamePrefix:i,slug:null===(r=e.slug)||void 0===r?void 0:r.slug}),c=l?d(`${t.directory?`${t.directory}${(null===(o=e.slug)||void 0===o?void 0:o.slug)===void 0?"":`/${e.slug.slug}`}`:e.dirpath}/${l}`):void 0;return t.parse(n,{asset:c,slug:null===(s=e.slug)||void 0===s?void 0:s.slug})}if("content"===t.formKind||"assets"===t.formKind){let i=`${e.dirpath}/${a.join("/")}`,{external:l,other:r}=u(i,t);if("content"===t.formKind){let a=i+t.contentExtension,o=d(a);return t.parse(n,{content:o,other:r,external:l,slug:null===(c=e.slug)||void 0===c?void 0:c.slug})}if("assets"===t.formKind)return t.parse(n,{other:r,external:l,slug:null===(h=e.slug)||void 0===h?void 0:h.slug})}return t.parse(n,void 0)},!1)}catch(e){throw(0,C.t)(e)}return r&&s.delete(`${e.dirpath}/${r.path}`),{initialState:n,initialFiles:[...s]}}function ej(e){var t;let{current:n}=(0,_.a)(),i=(0,_.b)(),l=(0,_.c)(),r="loaded"===n.kind?n.data.tree:void 0,o=(0,a.useMemo)(()=>{var t;return(0,_.d)((0,_.o)(e.schema),e.dirpath,null===(t=e.slug)||void 0===t?void 0:t.slug,e.format)},[e.dirpath,e.format,e.schema,null===(t=e.slug)||void 0===t?void 0:t.slug]),s=(0,a.useMemo)(()=>(0,_.e)(o,null!=r?r:new Map),[o,r]),c=(0,a.useMemo)(()=>null!=r?r:new Map,[s,o]),d="loaded"===n.kind;return(0,_.f)((0,a.useCallback)(()=>{var t;if(!d)return _.L;if(void 0===(null===(t=(0,_.h)(c,(0,_.g)(e.dirpath,e.format)))||void 0===t?void 0:t.entry.sha))return"not-found";let n={dirpath:e.dirpath,format:e.format,schema:e.schema,slug:e.slug},a=o.flatMap(e=>{let t=(0,_.h)(c,e);return t?t.children?function e(t){return[...t.values()].flatMap(t=>t.children?e(t.children):[t.entry])}(t.children):[t.entry]:[]}).map(t=>{let n=eC(e.config,t.sha,t.path,i,l);return n instanceof Uint8Array?[t.path,n]:n.then(e=>[t.path,e])});if(a.every(e=>Array.isArray(e))){let{initialFiles:e,initialState:t}=ex(n,new Map(a));return{initialState:t,initialFiles:e,localTreeKey:s}}return Promise.all(a).then(async e=>{let{initialState:t,initialFiles:i}=ex(n,new Map(e));return{initialState:t,initialFiles:i,localTreeKey:s}})},[d,c,e.dirpath,e.format,e.config,e.schema,e.slug,o,i,l,s]))}let ek=new P.z({max:200});async function ew(e){let t=await (0,_.j)(e);return ek.set(t,e),await (0,_.s)(t,e),t}async function eS(e,t,n,i,a){if((null==a?void 0:a.isPrivate)===!1){var l;return fetch(`https://raw.githubusercontent.com/${(0,_.k)(a)}/${i}/${null!==(l=(0,_.l)(e.storage))&&void 0!==l?l:""}${n}`)}let r=await (0,_.m)(e);return fetch("github"===e.storage.kind?`https://api.github.com/repos/${(0,_.k)(e.storage.repo)}/git/blobs/${t}`:`${_.K}/v1/github/blob/${t}`,{headers:{Authorization:`Bearer ${r.accessToken}`,Accept:"application/vnd.github.raw",..."cloud"===e.storage.kind?_.n:{}}})}function eC(e,t,n,i,a){if(ek.has(t))return ek.get(t);let l=(async()=>{let l="local"===e.storage.kind;if(!l){let e=await (0,_.i)(t);if(e)return ek.set(t,e),e}return(l?fetch(`/api/keystatic/blob/${t}/${n}`,{headers:{"no-cors":"1"}}):eS(e,t,n,i,a)).then(async e=>{if(!e.ok)throw Error(`Could not fetch blob ${t} (${n}): ${e.status}
${await e.text()}`);return e.arrayBuffer()}).then(n=>{let i=new Uint8Array(n);return ek.set(t,i),"local"!==e.storage.kind&&(0,_.s)(t,i),i}).catch(e=>{throw ek.delete(t),e})})();return ek.set(t,l),l}function e_(e){var t,n;let l,r,o,s,c;let d=(0,i.c)(15),{collection:u,config:h}=e,m=null===(t=h.collections)||void 0===t?void 0:t[u];m||ep();let f=(0,_.u)();d[0]!==f.search?(l=null!==(n=new URLSearchParams(f.search).get("search"))&&void 0!==n?n:"",d[0]=f.search,d[1]=l):l=d[1];let[g,p]=(0,a.useState)(l);d[2]!==f?(r=e=>{p(e);let t=new URLSearchParams(f.search);e?t.set("search",e):t.delete("search"),f.replace(f.pathname+"?"+t.toString())},d[2]=f,d[3]=r):r=d[3];let b=r,v=function(e,t){let n,l;let r=(0,i.c)(4),[o,s]=(0,a.useState)(e);return r[0]!==e||300!==r[1]?(n=()=>{let n=setTimeout(()=>s(e),t);return()=>{clearTimeout(n)}},l=[e,t],r[0]=e,r[1]=t,r[2]=n,r[3]=l):(n=r[2],l=r[3]),(0,a.useEffect)(n,l),o}(g,300),y=`${e.basePath}/collection/${encodeURIComponent(e.collection)}/create`;return d[4]!==m.label||d[5]!==y||d[6]!==g||d[7]!==b?(o=(0,$.jsx)(e$,{collectionLabel:m.label,createHref:y,searchTerm:g,onSearchTermChange:b}),d[4]=m.label,d[5]=y,d[6]=g,d[7]=b,d[8]=o):o=d[8],d[9]!==v||d[10]!==e?(s=(0,$.jsx)(eP,{searchTerm:v,...e}),d[9]=v,d[10]=e,d[11]=s):s=d[11],d[12]!==o||d[13]!==s?(c=(0,$.jsxs)(C.P,{containerWidth:"none",children:[o,s]}),d[12]=o,d[13]=s,d[14]=c):c=d[14],c}function e$(e){let t,n,o,s,c,m,f,p,b,v,y,x,j,S,_,P,I,R,F,T;let E=(0,i.c)(50),{collectionLabel:U,createHref:K}=e,D=(0,u.q)(C.s),L=(0,w.ac)(w.l0.above.mobile),[A,O]=(0,a.useState)(L),z=(0,a.useRef)(null);E[0]!==L?(t=()=>{O(L)},n=[L],E[0]=L,E[1]=t,E[2]=n):(t=E[1],n=E[2]),(0,a.useEffect)(t,n),E[3]===Symbol.for("react.memo_cache_sentinel")?(o=()=>{let e=e=>{if(document.activeElement!==z.current&&(0,h.P6)("mod+f",e)){var t;e.preventDefault(),null===(t=z.current)||void 0===t||t.select()}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},s=[],E[3]=o,E[4]=s):(o=E[3],s=E[4]),(0,a.useEffect)(o,s),E[5]!==U?(c=(0,$.jsx)(d.X6,{elementType:"h1",id:"page-title",size:"small",flex:!0,minWidth:0,children:U}),E[5]=U,E[6]=c):c=E[6];let W=A?"block":"none";return E[7]!==W?(m={display:W},E[7]=W,E[8]=m):m=E[8],E[9]!==D?(f=D.format("search"),E[9]=D,E[10]=f):f=E[10],E[11]!==e||E[12]!==L?(p=()=>{e.onSearchTermChange(""),L||setTimeout(()=>{O(!1)},250)},E[11]=e,E[12]=L,E[13]=p):p=E[13],E[14]!==L||E[15]!==e.searchTerm?(b=()=>{L||""!==e.searchTerm||O(!1)},E[14]=L,E[15]=e.searchTerm,E[16]=b):b=E[16],E[17]!==D?(v=D.format("search"),E[17]=D,E[18]=v):v=E[18],E[19]!==z||E[20]!==f||E[21]!==e.onSearchTermChange||E[22]!==e.searchTerm||E[23]!==p||E[24]!==b||E[25]!==v?(y=(0,$.jsx)(k.U,{ref:z,"aria-label":f,onChange:e.onSearchTermChange,onClear:p,onBlur:b,placeholder:v,value:e.searchTerm,width:"scale.2400"}),E[19]=z,E[20]=f,E[21]=e.onSearchTermChange,E[22]=e.searchTerm,E[23]=p,E[24]=b,E[25]=v,E[26]=y):y=E[26],E[27]!==m||E[28]!==y?(x=(0,$.jsx)("div",{role:"search",style:m,children:y}),E[27]=m,E[28]=y,E[29]=x):x=E[29],E[30]!==A?(j=A||{above:"mobile"},E[30]=A,E[31]=j):j=E[31],E[32]===Symbol.for("react.memo_cache_sentinel")?(S=()=>{O(!0);let e=document.createElement("input");e.style.position="absolute",e.style.opacity="0",document.body.appendChild(e),e.focus(),setTimeout(()=>{var t;null===(t=z.current)||void 0===t||t.focus(),e.remove()},0)},E[32]=S):S=E[32],E[33]===Symbol.for("react.memo_cache_sentinel")?(_=(0,$.jsx)(r.J,{src:g.R}),E[33]=_):_=E[33],E[34]!==j||E[35]!==S?(P=(0,$.jsx)(l.Kk,{"aria-label":"show search",isHidden:j,onPress:S,children:_}),E[34]=j,E[35]=S,E[36]=P):P=E[36],E[37]!==A?(I=A?{below:"tablet"}:void 0,E[37]=A,E[38]=I):I=E[38],E[39]!==D?(R=D.format("add"),E[39]=D,E[40]=R):R=E[40],E[41]!==K||E[42]!==I||E[43]!==R?(F=(0,$.jsx)(l.zx,{marginStart:"auto",prominence:"high",href:K,isHidden:I,children:R}),E[41]=K,E[42]=I,E[43]=R,E[44]=F):F=E[44],E[45]!==c||E[46]!==x||E[47]!==P||E[48]!==F?(T=(0,$.jsxs)(C.a,{children:[c,x,P,F]}),E[45]=c,E[46]=x,E[47]=P,E[48]=F,E[49]=T):T=E[49],T}function eP(e){let t;let n=(0,i.c)(11),a=(0,_.a)(),r="loaded"===a.merged.kind?a.merged.data.current.entries.get((0,_.p)(e.config,e.collection)):null;if("error"===a.merged.kind){let t,i;return n[0]!==e.basePath?(t=(0,$.jsx)(l.zx,{tone:"accent",href:e.basePath,children:"Dashboard"}),n[0]=e.basePath,n[1]=t):t=n[1],n[2]!==a.merged.error.message||n[3]!==t?(i=(0,$.jsx)(em,{icon:m.i,title:"Unable to load collection",message:a.merged.error.message,actions:t}),n[2]=a.merged.error.message,n[3]=t,n[4]=i):i=n[4],i}if("loading"===a.merged.kind){let e;return n[5]===Symbol.for("react.memo_cache_sentinel")?(e=(0,$.jsx)(em,{children:(0,$.jsx)(j._3,{"aria-label":"Loading Entries",isIndeterminate:!0,size:"large"})}),n[5]=e):e=n[5],e}if(!r){let t;let i=`${e.basePath}/collection/${encodeURIComponent(e.collection)}/create`;return n[6]!==i?(t=(0,$.jsx)(em,{icon:f.W,title:"Empty collection",message:(0,$.jsxs)($.Fragment,{children:["There aren't any entries yet."," ",(0,$.jsx)(x.h,{href:i,children:"Create the first entry"})," ","to see it here."]})}),n[6]=i,n[7]=t):t=n[7],t}return n[8]!==e||n[9]!==a.merged.data?(t=(0,$.jsx)(eF,{...e,trees:a.merged.data}),n[8]=e,n[9]=a.merged.data,n[10]=t):t=n[10],t}let eI="@@slug",eR="@@status";function eF(e){let{searchTerm:t}=e,n=(0,_.c)(),i=(0,_.q)(),l=(0,_.r)(e.config),o=(0,_.u)(),[s,c]=(0,a.useState)({column:eI,direction:"ascending"}),u=l||i===(null==n?void 0:n.defaultBranch),h=(0,_.b)(),m=e.config.collections[e.collection],f=(0,a.useMemo)(()=>{let t=new Map((0,_.t)(e.config,e.collection,e.trees.default.tree).map(e=>[e.slug,e.key]));return(0,_.t)(e.config,e.collection,e.trees.current.tree).map(e=>({name:e.slug,status:t.has(e.slug)?t.get(e.slug)===e.key?"Unchanged":"Changed":"Added",sha:e.sha}))},[e.collection,e.config,e.trees]),g=(0,_.f)((0,a.useCallback)(async()=>{var t;if(!(null!==(t=m.columns)&&void 0!==t&&t.length))return;let i=(0,_.v)(e.config,e.collection),a=await Promise.all(f.map(async t=>[t.name,await eC(e.config,t.sha,(0,_.g)((0,_.w)(e.config,e.collection,t.name),i),h,n)])),l=(0,_.x)(e.config,e.collection),r={kind:"object",fields:m.schema},o=new Map;for(let[e,t]of a)try{let{loaded:n}=(0,K.l)(t,i),a=(0,C.p)(r,n,[],[],(t,n,i)=>{if("asset"===t.formKind)return t.reader.parse(n);if("content"!==t.formKind&&"assets"!==t.formKind){if(1===i.length&&void 0!==e&&i[0]===m.slugField){if("slug"!==t.formKind)throw Error(`Slug field ${m.slugField} is not a slug field`);return t.reader.parseWithSlug(n,{slug:e,glob:l})}return t.reader.parse(n)}},!0);o.set(e,a)}catch{}return o},[m,e.config,e.collection,f,h,n])),x=(0,a.useMemo)(()=>{if("loaded"!==g.kind||!g.data)return f;let{data:e}=g;return f.map(t=>({...t,data:e.get(t.name)}))},[f,g]),j=(0,a.useMemo)(()=>x.filter(e=>e.name.toLowerCase().includes(t.toLowerCase())),[x,t]),k=(0,a.useMemo)(()=>[...j].sort((e,t)=>{let n=(e,t)=>{var n,i,a;return s.column===eI?null!==(i=null===(a=m.parseSlugForSort)||void 0===a?void 0:a.call(m,e.name))&&void 0!==i?i:e.name:s.column===eR?e.status:null!==(n=null==t?void 0:t[s.column])&&void 0!==n?n:e.name},i="loaded"===g.kind?g.data:void 0;return function(e,t,n){let i="ascending"===e?1:-1;return null==t?1:null==n?-1:"string"==typeof t&&"string"==typeof n?eh.compare(t,n)*i:(t<n?-1:t>n?1:0)*i}(s.direction,n(e,null==i?void 0:i.get(e.name)),n(t,null==i?void 0:i.get(t.name)))}),[m,j,g,s.column,s.direction]),P=(0,a.useMemo)(()=>{var e;return null!==(e=m.columns)&&void 0!==e&&e.length?[...u?[]:[{name:"Status",key:eR,minWidth:32,width:32}],{name:"Slug",key:eI},...m.columns.map(e=>{let t=m.schema[e];return{name:"label"in t&&t.label||e,key:e}})]:u?[{name:"Name",key:eI}]:[{name:"Status",key:eR,minWidth:32,width:32},{name:"Name",key:eI}]},[m,u]);return(0,$.jsxs)(S.HA,{"aria-labelledby":"page-title",selectionMode:"none",onSortChange:c,sortDescriptor:s,density:"spacious",overflowMode:"truncate",prominence:"low",onAction:t=>{var n,i,a;o.push((n=e.basePath,i=e.collection,a=t.toString().slice(4),`${n}/collection/${encodeURIComponent(i)}/item/${encodeURIComponent(a)}`))},renderEmptyState:()=>(0,$.jsx)(em,{icon:p.e,title:"No results",message:`No items matching "${t}" were found.`}),flex:!0,marginTop:{tablet:"large"},marginBottom:{mobile:"regular",tablet:"xlarge"},UNSAFE_className:(0,w.iv)({marginInline:w.iK.size.space.regular,[w.l0.above.mobile]:{marginInline:`calc(${w.iK.size.space.xlarge} - ${w.iK.size.space.medium})`},[w.l0.above.tablet]:{marginInline:`calc(${w.iK.size.space.xxlarge} - ${w.iK.size.space.medium})`},"[role=rowheader]":{cursor:"pointer"}}),children:[(0,$.jsx)(S.xD,{columns:P,children:({name:e,key:t,...n})=>t===eR?(0,$.jsx)(S.sg,{isRowHeader:!0,allowsSorting:!0,...n,children:(0,$.jsx)(r.J,{"aria-label":"Status",src:b.D})},t):(0,$.jsx)(S.sg,{isRowHeader:!0,allowsSorting:!0,...n,children:e},t)}),(0,$.jsx)(S.RM,{items:k,children:e=>{var t;let n=(0,$.jsx)(S.bL,{textValue:e.status,children:"Added"===e.status?(0,$.jsx)(r.J,{color:"positive",src:v.L}):"Changed"===e.status?(0,$.jsx)(r.J,{color:"accent",src:y.t}):null},eR+e.name),i=(0,$.jsx)(S.bL,{textValue:e.name,children:(0,$.jsx)(d.xv,{weight:"medium",children:e.name})},eI+e.name);return null!==(t=m.columns)&&void 0!==t&&t.length?(0,$.jsx)(S.X2,{children:[...u?[]:[n],i,...m.columns.map(t=>{var n;let i;return null==(i=null===(n=e.data)||void 0===n?void 0:n[t])?i=void 0:i+="",(0,$.jsx)(S.bL,{textValue:i,children:(0,$.jsx)(d.xv,{weight:"medium",children:i})},t+e.name)})]},"key:"+e.name):u?(0,$.jsx)(S.X2,{children:i},"key:"+e.name):(0,$.jsxs)(S.X2,{children:[n,i]},"key:"+e.name)}})]})}function eT(e,t){if("form"===e.kind)return"content"===e.formKind&&e.collaboration?e.collaboration.toYjs(t):t;if("child"===e.kind)return null;if("object"===e.kind)return new D.D5(Object.entries(e.fields).map(([e,n])=>[e,eT(n,t[e])]));if("array"===e.kind){let n=new D.mJ;return n.push(t.map(t=>eT(e.element,t))),n}if("conditional"===e.kind){let n=t.discriminant;return new D.D5([["discriminant",n],["value",eT(e.values[n+""],t.value)]])}(0,G.vE)(e)}function eE(e,t,n){if("form"===e.kind)return"content"===e.formKind&&e.collaboration?e.collaboration.fromYjs(n,t):n;if("child"===e.kind)return null;if("object"===e.kind)return Object.fromEntries(Object.entries(e.fields).map(([e,i])=>[e,eE(i,t,n.get(e))]));if("array"===e.kind){let i=n.map(n=>eE(e.element,t,n));return(0,C.b)(i,(0,C.g)(n)),i}if("conditional"===e.kind)return{discriminant:eE(e.discriminant,t,n.get("discriminant")),value:eE(e.values[n.get("discriminant")+""],t,n.get("value"))}}function eU(e,t){if("form"===e.kind||"child"===e.kind)return t;if("object"===e.kind)return new D.D5(Object.entries(e.fields).map(([e,n])=>[e,eU(n,t[e])]));if("array"===e.kind){let n=new D.mJ;return n.push(t.map(t=>eU(e.element,t))),n}if("conditional"===e.kind){let n=t.discriminant;return new D.D5([["discriminant",n],["value",eU(e.values[n.toString()],t.value)]])}}let eK=(0,a.createContext)(void 0),eD=eK.Provider;function eL(e){let t,n,r,o,s,u,h;let m=(0,i.c)(18),f=(0,_.u)(),g=(0,a.useContext)(eK);if(m[0]!==f.href||m[1]!==g){var p;t=null!==(p=new URL(f.href,"https://example.com").searchParams.get("slug"))&&void 0!==p?p:null==g?void 0:g.value,m[0]=f.href,m[1]=g,m[2]=t}else t=m[2];let b=t;m[3]!==e.config.storage.repo?(n=(0,_.y)(e.config.storage.repo),m[3]=e.config.storage.repo,m[4]=n):n=m[4];let v=n;return m[5]!==v.name?(r=(0,$.jsx)(U.nv,{label:"Repo Name",width:"100%",isReadOnly:!0,value:v.name}),m[5]=v.name,m[6]=r):r=m[6],m[7]!==v.name?(o=(0,$.jsx)(l.Kk,{onPress:()=>{navigator.clipboard.writeText(v.name)},children:"Copy Repo Name"}),m[7]=v.name,m[8]=o):o=m[8],m[9]!==r||m[10]!==o?(s=(0,$.jsxs)(c.kC,{alignItems:"end",gap:"regular",children:[r,o]}),m[9]=r,m[10]=o,m[11]=s):s=m[11],m[12]!==b||m[13]!==g?(u=b?(0,$.jsx)(l.zx,{prominence:"high",href:`https://github.com/apps/${b}/installations/new`,children:"Install GitHub App"}):(0,$.jsx)(O.q,{tone:"caution",children:g?(0,$.jsxs)(d.xv,{children:["The ",(0,$.jsx)("code",{children:g.envName})," environment variable wasn't provided so we can't link to the GitHub app installation page. You should find the App on GitHub and add the repo yourself."]}):(0,$.jsx)(d.xv,{children:"Find the App on GitHub and add the repo."})}),m[12]=b,m[13]=g,m[14]=u):u=m[14],m[15]!==s||m[16]!==u?(h=(0,$.jsxs)(c.kC,{direction:"column",gap:"regular",children:[s,u]}),m[15]=s,m[16]=u,m[17]=h):h=m[17],h}function eA(e){let t=(0,u.q)(C.s),n=(0,J.m8)(),[i,r]=(0,a.useState)({kind:"idle"});(0,a.useEffect)(()=>{let t=async t=>{if("ks-refetch-installations"===t.key&&"true"===t.newValue){localStorage.removeItem("ks-refetch-installations");try{var i;if(!await (0,_.m)(e.config))throw Error("Unauthorized");let t=await n.query(_.G,(0,_.y)(e.config.storage.repo)).toPromise();null!==(i=t.data)&&void 0!==i&&null!==(i=i.repository)&&void 0!==i&&null!==(i=i.forks.nodes)&&void 0!==i&&i.some(e=>(null==e?void 0:e.viewerPermission)==="ADMIN"||(null==e?void 0:e.viewerPermission)==="WRITE"||(null==e?void 0:e.viewerPermission)==="MAINTAIN")&&(await new Promise(e=>setTimeout(e,100)),e.onCreate())}catch(e){r({kind:"error",error:e})}}};return addEventListener("storage",t),()=>removeEventListener("storage",t)},[n,e]);let o=(0,a.useContext)(eK);return(0,$.jsxs)(I.Vq,{size:"small",isDismissable:!0,onDismiss:()=>{e.onDismiss()},children:[(0,$.jsx)(d.X6,{children:"Fork Repo"}),"error"===i.kind?(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(R.VY,{children:(0,$.jsx)(O.q,{tone:"critical",children:i.error.message})}),(0,$.jsx)(l.hE,{children:(0,$.jsx)(l.zx,{onPress:e.onDismiss,children:t.format("cancel")})})]}):(0,$.jsx)($.Fragment,{children:(0,$.jsx)(R.VY,{children:(0,$.jsxs)(c.kC,{gap:"large",direction:"column",marginBottom:"large",children:[(0,$.jsx)(d.xv,{children:"You don't have permission to write to this repo so to save your changes, you need to fork the repo."}),(0,$.jsxs)(d.xv,{children:["To start,"," ",(0,$.jsx)(x.h,{href:`https://github.com/${(0,_.k)(e.config.storage.repo)}/fork`,target:"_blank",rel:"noopener noreferrer",children:"fork the repo on GitHub"}),". Then, come back to this page and"," ",(0,$.jsx)(x.h,{href:`https://github.com/apps/${null==o?void 0:o.value}/installations/new?state=close`,target:"_blank",rel:"noopener noreferrer",children:"install the Keystatic GitHub App on your fork."})]})]})})})]})}let eO=(0,a.memo)(e=>{let t,n;let a=(0,i.c)(5);if(a[0]!==e.items){let n;a[2]===Symbol.for("react.memo_cache_sentinel")?(n=e=>(0,$.jsx)(Q.c,{href:e.href,children:e.label},e.key),a[2]=n):n=a[2],t=e.items.map(n),a[0]=e.items,a[1]=t}else t=a[1];return a[3]!==t?(n=(0,$.jsx)(Q.O,{flex:!0,size:"medium",minWidth:"alias.singleLineWidth",children:t}),a[3]=t,a[4]=n):n=a[4],n});function ez(e,t){let n,a,l;let r=(0,i.c)(10),o=(0,_.z)(),s=(0,Z.u)(e);r[0]!==s||r[1]!==t?(n=new Set(s),t&&n.delete(t),r[0]=s,r[1]=t,r[2]=n):n=r[2];let c=o.collections[e];return r[3]!==o||r[4]!==e?(a=(0,_.x)(o,e),r[3]=o,r[4]=e,r[5]=a):a=r[5],r[6]!==c.slugField||r[7]!==n||r[8]!==a?(l={field:c.slugField,slugs:n,glob:a},r[6]=c.slugField,r[7]=n,r[8]=a,r[9]=l):l=r[9],l}function eW(){let e,t,n;let a=(0,i.c)(7),l=(0,_.A)(),r=(0,_.B)(),o=(0,_.u)();return l?(a[0]!==r?(e=r.values(),a[0]=r,a[1]=e):e=a[1],a[2]!==e?(t=[...e],a[2]=e,a[3]=t):t=a[3],a[4]!==o.href||a[5]!==t?(n=(0,$.jsx)(c.Ug,{children:t.map(e=>e.user&&o.href===`/keystatic/branch/${e.branch}/${e.location}`?(0,$.jsx)(Y.q,{src:e.user.avatarUrl,name:e.user.name}):null)}),a[4]=o.href,a[5]=t,a[6]=n):n=a[6],n):null}function eH(e){let t="github"===e.storage.kind?(0,_.y)(e.storage.repo):{owner:"repo-owner",name:"repo-name"};return(0,V.eI)({url:"github"===e.storage.kind?"https://api.github.com/graphql":`${_.K}/v1/github/graphql`,requestPolicy:"cache-and-network",exchanges:[(0,ei.M)(async t=>{let n=await (0,_.m)(e);return{addAuthToOperation:i=>(n=(0,_.C)(e))?t.appendHeaders(i,{Authorization:`Bearer ${n.accessToken}`,..."cloud"===e.storage.kind?_.n:{}}):i,didAuthError:()=>!1,willAuthError(t){var i;return(n=(0,_.C)(e),"OperationDefinition"===t.query.definitions[0].kind&&null!==(i=t.query.definitions[0].name)&&void 0!==i&&i.value.includes("AppShell")&&!n)?("github"===e.storage.kind?window.location.href="/api/keystatic/github/login":(0,_.D)("",e),!0):!n},async refreshAuth(){n=await (0,_.m)(e)}}}),(0,en.HG)({resolvers:{Repository:{refs:(0,el.N)()}},updates:{Mutation:{createRef(n,i,a,l){a.updateQuery({query:"github"===e.storage.kind?_.G:_.E,variables:t},e=>{var t;return null!=e&&null!==(t=e.repository)&&void 0!==t&&null!==(t=t.refs)&&void 0!==t&&t.nodes&&n.createRef&&"object"==typeof n.createRef&&"ref"in n.createRef?{...e,repository:{...e.repository,refs:{...e.repository.refs,nodes:[...e.repository.refs.nodes,n.createRef.ref]}}}:e})},deleteRef(n,i,a,l){a.updateQuery({query:"github"===e.storage.kind?_.G:_.E,variables:t},e=>{var t;if(null!=e&&null!==(t=e.repository)&&void 0!==t&&null!==(t=t.refs)&&void 0!==t&&t.nodes&&n.deleteRef&&"object"==typeof n.deleteRef&&"__typename"in n.deleteRef&&"object"==typeof i.input&&null!==i.input&&"refId"in i.input&&"string"==typeof i.input.refId){let t=i.input.refId;return{...e,repository:{...e.repository,refs:{...e.repository.refs,nodes:e.repository.refs.nodes.filter(e=>(null==e?void 0:e.id)!==t)}}}}return e})}}}}),..."github"===e.storage.kind?[]:[(0,ea.V)({enableForMutation:!0,enforcePersistedQueries:!0})],V.Ek]})}function eM(e){let t,n,a,l,r,o,s,c,d,u,h;let m=(0,i.c)(19),{children:f,config:g}=e,p=(0,C.u)(),{push:b}=(0,_.u)();m[0]!==b?(n={navigate:b},m[0]=b,m[1]=n):n=m[1],t=n,m[2]===Symbol.for("react.memo_cache_sentinel")?(a=(0,$.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),m[2]=a):a=m[2];let v=g.locale||"en-US";return m[3]===Symbol.for("react.memo_cache_sentinel")?(l=(0,$.jsx)(et.vW,{bodyBackground:"surface"}),r=(0,$.jsx)("link",{href:"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap",rel:"stylesheet"}),m[3]=l,m[4]=r):(l=m[3],r=m[4]),m[5]!==g?(s=eH(g),m[5]=g,m[6]=s):s=m[6],o=s,m[7]!==o||m[8]!==f?(c=(0,$.jsx)(J.zt,{value:o,children:f}),m[7]=o,m[8]=f,m[9]=c):c=m[9],m[10]===Symbol.for("react.memo_cache_sentinel")?(d=(0,$.jsx)(z.x,{}),m[10]=d):d=m[10],m[11]!==v||m[12]!==p.theme||m[13]!==t||m[14]!==c?(u=(0,$.jsxs)(et.e1,{locale:v,colorScheme:p.theme,router:t,children:[l,r,c,d]}),m[11]=v,m[12]=p.theme,m[13]=t,m[14]=c,m[15]=u):u=m[15],m[16]!==p||m[17]!==u?(h=(0,$.jsxs)(C.T,{value:p,children:[a,u]}),m[16]=p,m[17]=u,m[18]=h):h=m[18],h}(0,w.hi)({body:{overflow:"hidden"}});let eN=new TextEncoder,eq=eN.encode("---\n");function eB(e){var t,n;let{value:i,extraFiles:a}=(0,C.c)(e.state,(0,_.o)(e.schema),null===(t=e.slug)||void 0===t?void 0:t.field,null===(n=e.slug)||void 0===n?void 0:n.value,!0),l=e.format.data,r=eN.encode("json"===l?JSON.stringify(i,null,2)+"\n":(0,ee.$w)(i));if(e.format.contentField){let t;let n=`${e.format.contentField.path.join("/")}${e.format.contentField.contentExtension}`;a=a.filter(e=>e.path!==n||(t=e.contents,!1)),(0,T.hu)(void 0!==t,"Expected content field to be present"),r=function(e,t){let n=new Uint8Array(e.byteLength+t.byteLength+2*eq.byteLength);return n.set(eq),n.set(e,eq.byteLength),n.set(eq,eq.byteLength+e.byteLength),n.set(t,2*eq.byteLength+e.byteLength),n}(r,t)}return[{path:(0,_.g)(e.basePath,e.format),contents:r},...a.map(t=>({path:`${t.parent?e.slug?`${t.parent}/${e.slug.value}`:t.parent:e.basePath}/${t.path}`,contents:t.contents}))]}function eG(e){let[t,n]=(0,a.useState)({kind:"idle"}),i=(0,_.b)(),l=(0,_.q)(),r=(0,_.F)(),[,o]=(0,J.Db)(eJ),s=(0,_.c)(),c=(0,a.useContext)(eK),d=(0,_.H)();return[t,async t=>{try{var a,u,h,m,f,g,p,b,v;let y="loaded"===d.kind?d.data.tree:void 0;if(!y)return!1;if("github"===e.config.storage.kind&&s&&!s.hasWritePermission&&null!=c&&c.value)return n({kind:"needs-fork"}),!1;n({kind:"loading"});let x=null!==(a=(0,_.l)(e.config.storage))&&void 0!==a?a:"",j=eB({basePath:e.basePath,schema:e.schema,format:e.format,state:e.state,slug:e.slug}).map(e=>({...e,path:x+e.path})),k=new Map(await Promise.all(j.map(async e=>[e.path,await ew(e.contents)]))),w=new Set(null===(u=e.initialFiles)||void 0===u?void 0:u.map(e=>x+e));for(let e of j)w.delete(e.path);j=j.filter(e=>{let t=k.get(e.path),n=(0,_.h)(y,e.path);return(null==n?void 0:n.entry.sha)!==t});let S=[...w].map(e=>({path:e})),C=await (0,_.I)(y,{additions:j,deletions:[...w]});if(await (0,_.J)(C.entries),"github"===e.config.storage.kind||"cloud"===e.config.storage.kind){if(!s)throw Error("Repo info not loaded");let a={branchName:null!==(h=null==t?void 0:t.branch)&&void 0!==h?h:l,repositoryNameWithOwner:`${s.owner}/${s.name}`},r=t=>o({input:{branch:a,expectedHeadOid:t,message:{headline:`Update ${e.basePath}`},fileChanges:{additions:j.map(e=>({...e,contents:(0,er.b)(e.contents)})),deletions:S}}}),c=await r(null!==(m=null==t?void 0:t.sha)&&void 0!==m?m:i),d=null===(f=c.error)||void 0===f||null===(f=f.graphQLErrors[0])||void 0===f?void 0:f.originalError;if(d&&"type"in d){if("BRANCH_PROTECTION_RULE_VIOLATION"===d.type)return n({kind:"needs-new-branch",reason:"Changes must be made via pull request to this branch. Create a new branch to save changes."}),!1;if("STALE_DATA"===d.type){let t=await eH(e.config).query(eV,{owner:s.owner,name:s.name,ref:`refs/heads/${l}`}).toPromise();if(!(null!==(b=t.data)&&void 0!==b&&null!==(b=b.repository)&&void 0!==b&&null!==(b=b.ref)&&void 0!==b&&b.target))throw Error("Branch not found");let i=(0,_.M)(await (0,_.N)(t.data.repository.ref.target.oid,e.config),e.config);if((0,_.e)((0,_.d)((0,_.o)(e.schema),e.basePath,null===(v=e.slug)||void 0===v?void 0:v.value,e.format),i.tree)!==e.currentLocalTreeKey)return n({kind:"needs-new-branch",reason:"This entry has been updated since it was opened. Create a new branch to save changes."}),!1;c=await r(t.data.repository.ref.target.oid)}}if(null!==(g=c.error)&&void 0!==g&&g.graphQLErrors.some(e=>"type"in e&&"FORBIDDEN"===e.type&&"Resource not accessible by integration"===e.message))throw Error(`The GitHub App is unable to commit to the repository. Please ensure that the Keystatic GitHub App is installed in the GitHub repository ${s.owner}/${s.name}`);if(c.error)throw c.error;if(null===(p=c.data)||void 0===p||null===(p=p.createCommitOnBranch)||void 0===p||null===(p=p.ref)||void 0===p?void 0:p.target)return n({kind:"updated"}),!0;throw Error("Failed to update")}{let e=await fetch("/api/keystatic/update",{method:"POST",headers:{"Content-Type":"application/json","no-cors":"1"},body:JSON.stringify({additions:j.map(e=>({...e,contents:(0,er.b)(e.contents)})),deletions:S})});if(!e.ok)throw Error(await e.text());let t=await e.json(),{tree:i}=await (0,_.J)(t);return r(await (0,_.O)(i)),n({kind:"updated"}),!0}}catch(e){return n({kind:"error",error:e}),!1}},()=>{n({kind:"idle"})}]}let eJ=(0,X.ZP)`
  mutation CreateCommit($input: CreateCommitOnBranchInput!) {
    createCommitOnBranch(input: $input) {
      ref {
        id
        target {
          id
          oid
          ... on Commit {
            tree {
              id
              oid
            }
          }
        }
      }
    }
  }
`,eV=(0,X.ZP)`
  query FetchRef($owner: String!, $name: String!, $ref: String!) {
    repository(owner: $owner, name: $name) {
      id
      ref(qualifiedName: $ref) {
        id
        target {
          id
          oid
        }
      }
    }
  }
`;function eQ(e){let t,n,l,r;let o=(0,i.c)(9);o[0]!==e.slugField||o[1]!==e.schema?(t=async t=>{let n=e.slugField?(0,_.P)({schema:e.schema.fields,slugField:e.slugField},t):void 0,i=(0,C.c)(t,e.schema,e.slugField,n,!0);return{slug:n,value:i.value,extraFiles:Object.fromEntries(await Promise.all(i.extraFiles.map(async e=>[JSON.stringify([e.path,e.parent]),await (0,_.j)(e.contents)])))}},o[0]=e.slugField,o[1]=e.schema,o[2]=t):t=o[2];let s=t;o[3]!==e.initialState||o[4]!==s?(n=()=>null===e.initialState?null:s(e.initialState),o[3]=e.initialState,o[4]=s,o[5]=n):n=o[5];let c=(0,_.f)(n);o[6]!==s||o[7]!==e.state?(l=()=>s(e.state),o[6]=s,o[7]=e.state,o[8]=l):l=o[8];let d=(0,_.f)(l);e:{if("loaded"===c.kind&&"loaded"===d.kind){r=!eo(c.data,d.data);break e}r="unknown"}let u=r,[h,m]=(0,a.useState)(!1);return"boolean"==typeof u&&u!==h&&m(u),h}function eZ(e,t){let n,l,r,o,s;let c=(0,i.c)(14),d=(0,_.Q)();c[0]!==e||c[1]!==d.awareness||c[2]!==t?(l=eE(e,d.awareness,t),c[0]=e,c[1]=d.awareness,c[2]=t,c[3]=l):l=c[3];let u=l;c[4]!==u?(r=()=>l,c[4]=u,c[5]=r):r=c[5];let h=l;return c[6]!==h||c[7]!==e||c[8]!==d.awareness||c[9]!==t?(o=n=>{let i=()=>{l=eE(e,d.awareness,t),n()};return t.observeDeep(i),()=>{t.unobserveDeep(i)}},c[6]=h,c[7]=e,c[8]=d.awareness,c[9]=t,c[10]=o):o=c[10],c[11]!==r||c[12]!==o?(s={getSnapshot:r,subscribe:o},c[11]=r,c[12]=o,c[13]=s):s=c[13],n=s,(0,a.useSyncExternalStore)(n.subscribe,n.getSnapshot,n.getSnapshot)}function eY(e,t,n){return(0,a.useMemo)(()=>(0,C.h)(e,t,()=>void 0),[e,t])(n)}function eX(e,t,n){let i=(0,_.Q)();return(0,a.useMemo)(()=>(function(e,t,n){let i;let a={form:(e,t)=>t,array:(e,t)=>({rawOnChange:t,inner:new Map,onChange(i){let a=t.yjs(),l=eE(e,n,a),r=(0,C.g)(a),o=new Set;for(let e of i)if(void 0!==e.key){if(o.has(e.key))throw Error("Array elements must have unique keys");o.add(e.key)}let s=i.map(e=>{if(void 0!==e.key)return e.key;let t=(0,C.d)();for(;o.has(t);)t=(0,C.d)();return o.add(t),t});(0,C.b)(a,s);let c=function(e,t){let n;if(e.length!==t.length)return;let i=[...e].sort(),a=[...t].sort();if(i.join()===a.join()){for(let i=0;i<e.length;i++)if(e[i]!==t[i]){if(n===t[i])continue;if(void 0!==n)return;n=e[i]}return n}}(r,s);if(void 0!==c){let t=r.indexOf(c),n=s.indexOf(c),o=a.get(t);for(let[c,{value:d}]of(o instanceof D.QP&&(o=o.clone()),a.delete(t),a.insert(n,[o]),i.entries())){let t=r.indexOf(s[c]),n=(0,C.e)(e.element,l[t],d);n!==l&&(a.delete(t),a.insert(c,[eU(e.element,n)]))}return}if(r.join()===s.slice(0,r.length).join()){for(let[t,{value:n}]of i.entries()){let i=r.indexOf(s[t]),o=(0,C.e)(e.element,l[i],n);o!==l&&(a.delete(i),a.insert(t,[eU(e.element,o)]))}let t=[];for(let{value:n}of i.slice(r.length))t.push(eU(e.element,(0,C.f)(e.element,n)));t.length&&a.insert(r.length,t);return}let d=i.map((t,n)=>{let i=s[n],o=r.indexOf(i);if(-1!==o){let n=a.get(o);if(void 0===t.value)return n instanceof D.QP?n.clone():n;let i=(0,C.e)(e.element,l[o],t.value);return eU(e.element,i)}return eU(e.element,(0,C.f)(e.element,t.value))});a.delete(0,a.length),a.insert(0,d)}}),conditional:(e,t)=>({onChange:(i,a)=>{if(t.yjs().set("discriminant",i),void 0!==a){let l=eE(e,n,t.yjs().get("value"));t.yjs().set("value",eU(e,(0,C.e)(e.values[i.toString()],l,a)))}},onChangeForValue:Object.assign(i=>{let a=eE(e,n,t.yjs().get("value"));t.yjs().set("value",eU(e,i(a)))},{yjs:()=>t.yjs().get("value")})}),object:(e,t)=>({onChange:i=>{for(let[a,l]of Object.entries(i)){let i=eE(e.fields[a],n,t.yjs().get(a));t.yjs().set(a,eU(e.fields[a],(0,C.e)(e.fields[a],i,l)))}},innerOnChanges:Object.fromEntries(Object.entries(e.fields).map(([e,n])=>{let i=Object.assign(i=>{t.yjs().set(e,eU(n,i))},{yjs:()=>t.yjs().get(e)});return[e,i]}))})},l={form:(e,t,n)=>({value:t,onChange:n,schema:e}),object(e,t,n,i,a){let l={};for(let i of Object.keys(e.fields))l[i]=a(e.fields[i],t[i],n.innerOnChanges[i],i);return{fields:l,onChange:n.onChange,schema:e}},array(e,t,i,a,l){let r=(0,C.g)(t),o=new Set((0,C.g)(t)),s={elements:t.map((t,a)=>{var s,c;let d=r[a];o.delete(d);let u=(s=i.inner,c=()=>{let a=Object.assign(t=>{let a=i.rawOnChange.yjs(),l=(0,C.g)(a).indexOf(d),r=t(eE(e,n,a.get(l)));a.delete(l),a.insert(l,[eU(e.element,r)])},{yjs(){let e=(0,C.g)(i.rawOnChange.yjs()).indexOf(d);return i.rawOnChange.yjs().get(e)}}),r=l(e.element,t,a,d);return{element:r,elementWithKey:{...r,key:d},onChange:a}},s.has(d)||s.set(d,c(d)),s.get(d)),h=l(e.element,t,u.onChange,d);return u.element!==h&&(u.element=h,u.elementWithKey={...h,key:d}),u.elementWithKey}),schema:e,onChange:i.onChange};for(let e of o)i.inner.delete(e);return s},conditional:(e,t,n,i,a)=>({discriminant:t.discriminant,onChange:n.onChange,value:a(e.values[t.discriminant.toString()],t.value,n.onChangeForValue,"value"),schema:e})};function r(e,t,n,i,a){return l[e.kind](e,t,n,i,a)}function o(e,t,n,i){let l=new Map,s=a[e.kind](e,n);return{value:t,inner:l,props:r(e,t,s,i,(e,t,n,a)=>{let r=o(e,t,n,i.concat(a));return l.set(a,r),r.props}),schema:e,cached:s}}let s=Object.assign(n=>{let a=eU(e,n(i.value));for(let[e,n]of a.entries())a.delete(e),t.set(e,n)},{yjs:()=>t});return t=>void 0===i?(i=o(e,t,s,[])).props:function e(t,n,i,a,l){if(a.schema!==t)return Object.assign(a,o(t,n,i,l)),a.props;if(a.value===n)return a.props;a.value=n;let s=new Set(a.inner.keys());for(let i of(a.props=r(t,n,a.cached,l,(t,n,i,r)=>{if(s.delete(r),!a.inner.has(r)){let e=o(t,n,i,l.concat(r));return a.inner.set(r,e),e.props}return e(t,n,i,a.inner.get(r),l.concat(r))}),s))a.inner.delete(i);return a.props}(e,t,s,i,[])})(e,t,i.awareness),[t,e,i.awareness])(n)}function e0(e){let t,n,a;let l=(0,i.c)(5),r=(0,_.z)().collections[e];return l[0]!==r.schema?(n={kind:"object",fields:r.schema},l[0]=r.schema,l[1]=n):n=l[1],t=n,l[2]!==t||l[3]!==r?(a={schema:t,collectionConfig:r},l[2]=t,l[3]=r,l[4]=a):a=l[4],a}function e1(e){let t,n,a;let l=(0,i.c)(5),r=(0,_.z)().singletons[e];return l[0]!==r.schema?(n={kind:"object",fields:r.schema},l[0]=r.schema,l[1]=n):n=l[1],t=n,l[2]!==t||l[3]!==r?(a={schema:t,singletonConfig:r},l[2]=t,l[3]=r,l[4]=a):a=l[4],a}class e2 extends a.Component{constructor(e){super(e),this.state={message:null}}static getDerivedStateFromError(e){if(eg(e))throw e;return{message:String(e)}}render(){return this.state.message?"function"==typeof this.props.fallback?this.props.fallback(this.state.message):this.props.fallback:this.props.children}}let e3=L.dt({slug:L.jt(L.Z_()),files:L.IM(L.Z_(),L.oQ(L.eE(Uint8Array),L.Z_(),e=>(0,er.a)(e)))}),e4=new TextDecoder;async function e5(e,t,n){let i;try{i=await navigator.clipboard.read()}catch(e){if(e instanceof DOMException&&"NotAllowedError"===e.name){z.g.critical("Failed to paste because clipboard access was denied",{timeout:5e3});return}z.g.critical("Failed to read clipboard",{timeout:5e3});return}for(let a of i){if(a.types.includes("text/html")){let i=await a.getType("text/html"),l=function(e,t,n,i){let a=new DOMParser().parseFromString(e,"text/html").querySelector("pre");if(null!=a&&a.dataset.keystaticEntry)try{var l,r;let e=JSON.parse(a.dataset.keystaticEntry),o=e3.create(e),s=new Map(Object.entries(o.files));return ex({dirpath:null!==(l=o.slug)&&void 0!==l?l:"entry",format:t,schema:n,slug:i?{field:i,slug:null!==(r=o.slug)&&void 0!==r?r:""}:void 0,requireFrontmatter:!0},s).initialState}catch{}}(await i.text(),e,t,null==n?void 0:n.field);if(l)return l}if(a.types.includes("text/plain")){let i=await a.getType("text/plain"),l=function(e,t,n,i){try{var a;let l=null!==(a=null==i?void 0:i.slug)&&void 0!==a?a:"entry";return ex({dirpath:l,format:t,schema:n,slug:i,requireFrontmatter:!0},new Map([[(0,_.g)(l,t),e]])).initialState}catch{}}(new Uint8Array(await i.arrayBuffer()),e,t,n);if(l)return l}}z.g.critical("Entry not found in clipboard",{timeout:5e3})}function e6(e,t,n,i){let a=function(e,t,n,i){var a;let l=null!==(a=null==i?void 0:i.value)&&void 0!==a?a:"entry",r=eB({basePath:l,format:t,schema:n,slug:i,state:e}),o=document.createElement("pre");o.dataset.keystaticEntry=JSON.stringify({slug:null==i?void 0:i.value,files:Object.fromEntries(r.map(e=>[e.path,(0,er.c)(e.contents)]))});let s=(0,_.g)(l,t),c=r.find(e=>e.path===s);if(!c)throw Error("No main entry file found");let d=e4.decode(c.contents);return o.textContent=d,{html:o.outerHTML,plain:d}}(e,t,n,i);navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([a.plain],{type:"text/plain"}),"text/html":new Blob([a.html],{type:"text/html"})})])}let e8=L.dt({version:L.i0(1),savedAt:L.hT(),slug:L.Z_(),beforeTreeKey:L.Z_(),files:L.UI(L.Z_(),L.eE(Uint8Array))});function e7(e){var t,n;let l,r,o,s,d,u,m,f,g,p,b,v,y,x,j,k,w,S,P,R,F,T,E,U;let K=(0,i.c)(115),{collection:D,config:L,itemSlug:A,updateResult:W,onUpdate:H}=e,{collectionConfig:M,schema:N}=e0(D),q=(0,_.u)(),B=(0,_.b)();K[0]!==L||K[1]!==D||K[2]!==A?(l=(0,_.w)(L,D,A),K[0]=L,K[1]=D,K[2]=A,K[3]=l):l=K[3];let G=l;K[4]!==L||K[5]!==D?(r=(0,_.v)(L,D),K[4]=L,K[5]=D,K[6]=r):r=K[6];let V=r,Q=(0,_.q)(),Z=(0,_.c)(),[Y,X]=(0,a.useState)(!1);K[7]!==M.previewUrl||K[8]!==e||K[9]!==Q?(o=M.previewUrl?M.previewUrl.replace("{slug}",e.itemSlug).replace("{branch}",Q):void 0,K[7]=M.previewUrl,K[8]=e,K[9]=Q,K[10]=o):o=K[10];let ee=o,{push:et,replace:en}=q,ei=ez(D,A);K[11]!==e.initialFiles||K[12]!==L.storage||K[13]!==G?(s={initialFiles:e.initialFiles,storage:L.storage,basePath:G},K[11]=e.initialFiles,K[12]=L.storage,K[13]=G,K[14]=s):s=K[14];let[ea,el,er]=function(e){let[t,n]=(0,a.useState)({kind:"idle"}),i=(0,_.b)(),l=(0,_.q)(),[,r]=(0,J.Db)(eJ),o=(0,_.F)(),s=(0,_.c)(),c=(0,a.useContext)(eK),d=(0,_.H)();return[t,async()=>{try{let t="loaded"===d.kind?d.data.tree:void 0;if(!t)return!1;if("github"===e.storage.kind&&s&&!s.hasWritePermission&&null!=c&&c.value)return n({kind:"needs-fork"}),!1;n({kind:"loading"});let a=e.initialFiles.map(t=>{var n;return(null!==(n=(0,_.l)(e.storage))&&void 0!==n?n:"")+t}),u=await (0,_.I)(t,{additions:[],deletions:a});if(await (0,_.J)(u.entries),"github"===e.storage.kind||"cloud"===e.storage.kind){if(!s)throw Error("Repo info not loaded");let{error:t}=await r({input:{branch:{repositoryNameWithOwner:`${s.owner}/${s.name}`,branchName:l},message:{headline:`Delete ${e.basePath}`},expectedHeadOid:i,fileChanges:{deletions:a.map(e=>({path:e}))}}});if(null!=t&&t.graphQLErrors.some(e=>"type"in e&&"FORBIDDEN"===e.type&&"Resource not accessible by integration"===e.message))throw Error(`The GitHub App is unable to commit to the repository. Please ensure that the Keystatic GitHub App is installed in the GitHub repository ${s.owner}/${s.name}`);if(t)throw t;return n({kind:"updated"}),!0}{let e=await fetch("/api/keystatic/update",{method:"POST",headers:{"Content-Type":"application/json","no-cors":"1"},body:JSON.stringify({additions:[],deletions:a.map(e=>({path:e}))})});if(!e.ok)throw Error(await e.text());let t=await e.json(),{tree:i}=await (0,_.J)(t);return o(await (0,_.O)(i)),n({kind:"updated"}),!0}}catch(e){n({kind:"error",error:e})}},()=>{n({kind:"idle"})}]}(s);K[15]!==el||K[16]!==et||K[17]!==e.basePath||K[18]!==D?(d=async()=>{await el()&&et(`${e.basePath}/collection/${encodeURIComponent(D)}`)},K[15]=el,K[16]=et,K[17]=e.basePath,K[18]=D,K[19]=d):d=K[19];let eo=(0,_.W)(d);K[20]!==et||K[21]!==e.basePath||K[22]!==D||K[23]!==A?(u=()=>{et(`${e.basePath}/collection/${encodeURIComponent(D)}/create?duplicate=${A}`)},K[20]=et,K[21]=e.basePath,K[22]=D,K[23]=A,K[24]=u):u=K[24];let es=u,ec="loading"===W.kind||!e.hasChanged;K[25]!==ec||K[26]!==N||K[27]!==e.state||K[28]!==e.basePath||K[29]!==ei||K[30]!==M||K[31]!==H||K[32]!==A||K[33]!==en||K[34]!==D?(m=async()=>{if(ec)return!1;if(!(0,C.m)(N,e.state,ei))return X(!0),!1;let t=(0,_.P)(M,e.state),n=await H();return n&&t!==A&&en(`${e.basePath}/collection/${encodeURIComponent(D)}/item/${encodeURIComponent(t)}`),n},K[25]=ec,K[26]=N,K[27]=e.state,K[28]=e.basePath,K[29]=ei,K[30]=M,K[31]=H,K[32]=A,K[33]=en,K[34]=D,K[35]=m):m=K[35];let ed=(0,_.W)(m);K[36]!==e.state||K[37]!==V||K[38]!==M?(f=()=>{e6(e.state,V,M.schema,{field:M.slugField,value:(0,_.P)(M,e.state)})},K[36]=e.state,K[37]=V,K[38]=M,K[39]=f):f=K[39];let eu=(0,_.W)(f);K[40]!==V||K[41]!==M||K[42]!==e.state||K[43]!==e.previewProps?(g=async()=>{let t=await e5(V,M.schema,{field:M.slugField,slug:(0,_.P)(M,e.state)});t&&((0,C.n)(t,e.previewProps),z.g.positive("Entry pasted",{shouldCloseOnAction:!0,actionLabel:"Undo",onAction:()=>{(0,C.n)(e.state,e.previewProps)}}))},K[40]=V,K[41]=M,K[42]=e.state,K[43]=e.previewProps,K[44]=g):g=K[44];let eh=(0,_.W)(g),em="local"!==L.storage.kind&&Z?`${(0,_.Y)(Z)}${"index"===V.dataLocation?`/tree/${Q}/${null!==(t=(0,_.l)(L.storage))&&void 0!==t?t:""}${G}`:`/blob/${Q}/${null!==(n=(0,_.l)(L.storage))&&void 0!==n?n:""}${G}${(0,_.Z)(V)}`}`:void 0;K[45]!==W.kind||K[46]!==ed?(p=()=>{let e=e=>{"loading"!==W.kind&&(0,h.P6)("mod+s",e)&&(e.preventDefault(),ed())};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},b=[W.kind,ed],K[45]=W.kind,K[46]=ed,K[47]=p,K[48]=b):(p=K[47],b=K[48]),(0,a.useEffect)(p,b);let ef="loading"===W.kind;K[49]!==ef||K[50]!==e.hasChanged||K[51]!==e.onReset||K[52]!==eo||K[53]!==es||K[54]!==eu||K[55]!==eh||K[56]!==em||K[57]!==ee?(v=(0,$.jsx)(tt,{formID:"item-edit-form",isLoading:ef,hasChanged:e.hasChanged,onDelete:eo,onDuplicate:es,onCopy:eu,onPaste:eh,onReset:e.onReset,viewHref:em,previewHref:ee}),K[49]=ef,K[50]=e.hasChanged,K[51]=e.onReset,K[52]=eo,K[53]=es,K[54]=eu,K[55]=eh,K[56]=em,K[57]=ee,K[58]=v):v=K[58],K[59]!==W?(y="error"===W.kind&&(0,$.jsx)(O.q,{tone:"critical",children:W.error.message}),K[59]=W,K[60]=y):y=K[60],K[61]!==ea?(x="error"===ea.kind&&(0,$.jsx)(O.q,{tone:"critical",children:ea.error.message}),K[61]=ea,K[62]=x):x=K[62],K[63]!==ed?(j=e=>{e.target===e.currentTarget&&(e.preventDefault(),ed())},K[63]=ed,K[64]=j):j=K[64];let eg=e.previewProps;return K[65]!==eg||K[66]!==Y||K[67]!==M.entryLayout||K[68]!==V||K[69]!==ei?(k=(0,$.jsx)(C.F,{previewProps:eg,forceValidation:Y,entryLayout:M.entryLayout,formatInfo:V,slugField:ei}),K[65]=eg,K[66]=Y,K[67]=M.entryLayout,K[68]=V,K[69]=ei,K[70]=k):k=K[70],K[71]!==j||K[72]!==k?(w=(0,$.jsx)(c.xu,{id:"item-edit-form",height:"100%",minHeight:0,minWidth:0,elementType:"form",onSubmit:j,children:k}),K[71]=j,K[72]=k,K[73]=w):w=K[73],K[74]!==W||K[75]!==D||K[76]!==q||K[77]!==A||K[78]!==M||K[79]!==e||K[80]!==H||K[81]!==B?(S="needs-new-branch"===W.kind&&(0,$.jsx)(tn,{branchOid:B,onCreate:async t=>{let n=`/keystatic/branch/${encodeURIComponent(t)}/collection/${encodeURIComponent(D)}/item/`;q.push(n+encodeURIComponent(A));let i=(0,_.P)(M,e.state);await H({branch:t,sha:B})&&i!==A&&q.replace(n+encodeURIComponent(i))},reason:W.reason,onDismiss:e.onResetUpdateItem}),K[74]=W,K[75]=D,K[76]=q,K[77]=A,K[78]=M,K[79]=e,K[80]=H,K[81]=B,K[82]=S):S=K[82],K[83]!==e.onResetUpdateItem||K[84]!==S?(P=(0,$.jsx)(I.TW,{onDismiss:e.onResetUpdateItem,children:S}),K[83]=e.onResetUpdateItem,K[84]=S,K[85]=P):P=K[85],K[86]!==W.kind||K[87]!==e||K[88]!==M||K[89]!==A||K[90]!==q||K[91]!==D?(R="needs-fork"===W.kind&&(0,_._)(e.config)&&(0,$.jsx)(eA,{onCreate:async()=>{let t=(0,_.P)(M,e.state);await e.onUpdate()&&t!==A&&q.replace(`${e.basePath}/collection/${encodeURIComponent(D)}/item/${encodeURIComponent(t)}`)},onDismiss:e.onResetUpdateItem,config:e.config}),K[86]=W.kind,K[87]=e,K[88]=M,K[89]=A,K[90]=q,K[91]=D,K[92]=R):R=K[92],K[93]!==e.onResetUpdateItem||K[94]!==R?(F=(0,$.jsx)(I.TW,{onDismiss:e.onResetUpdateItem,children:R}),K[93]=e.onResetUpdateItem,K[94]=R,K[95]=F):F=K[95],K[96]!==ea.kind||K[97]!==e||K[98]!==el||K[99]!==q||K[100]!==D||K[101]!==er?(T="needs-fork"===ea.kind&&(0,_._)(e.config)&&(0,$.jsx)(eA,{onCreate:async()=>{await el(),q.push(`${e.basePath}/collection/${encodeURIComponent(D)}`)},onDismiss:er,config:e.config}),K[96]=ea.kind,K[97]=e,K[98]=el,K[99]=q,K[100]=D,K[101]=er,K[102]=T):T=K[102],K[103]!==er||K[104]!==T?(E=(0,$.jsx)(I.TW,{onDismiss:er,children:T}),K[103]=er,K[104]=T,K[105]=E):E=K[105],K[106]!==v||K[107]!==e||K[108]!==y||K[109]!==x||K[110]!==w||K[111]!==P||K[112]!==F||K[113]!==E?(U=(0,$.jsx)($.Fragment,{children:(0,$.jsxs)(tl,{headerActions:v,...e,children:[y,x,w,P,F,E]})}),K[106]=v,K[107]=e,K[108]=y,K[109]=x,K[110]=w,K[111]=P,K[112]=F,K[113]=E,K[114]=U):U=K[114],U}function e9(e){var t;let n,l,r,o,s,c,d,u,h,m,f,g;let p=(0,i.c)(64),{collection:b,config:v,initialFiles:y,initialState:x,localTreeKey:j,draft:k}=e,{collectionConfig:w,schema:S}=e0(b),C=null!==(t=null==k?void 0:k.state)&&void 0!==t?t:x;p[0]!==C||p[1]!==j?(n={state:C,localTreeKey:j},p[0]=C,p[1]=j,p[2]=n):n=p[2];let[P,I]=(0,a.useState)(n),{state:R,localTreeKey:F}=P;(0,_.V)(k,R,j),F!==j&&I({state:x,localTreeKey:j}),p[3]===Symbol.for("react.memo_cache_sentinel")?(l=e=>{I(t=>({localTreeKey:t.localTreeKey,state:e(t.state)}))},p[3]=l):l=p[3];let T=eY(S,l,R);p[4]!==x||p[5]!==S||p[6]!==R||p[7]!==w.slugField?(r={initialState:x,schema:S,state:R,slugField:w.slugField},p[4]=x,p[5]=S,p[6]=R,p[7]=w.slugField,p[8]=r):r=p[8];let E=eQ(r);if(p[9]!==w||p[10]!==R||p[11]!==v||p[12]!==b){let e;s=(0,_.P)(w,R),p[16]!==v||p[17]!==b?(e=(0,_.v)(v,b),p[16]=v,p[17]=b,p[18]=e):e=p[18],c=e,o=(0,_.w)(v,b,s),p[9]=w,p[10]=R,p[11]=v,p[12]=b,p[13]=o,p[14]=s,p[15]=c}else o=p[13],s=p[14],c=p[15];let U=o;p[19]!==w.slugField||p[20]!==s?(d={field:w.slugField,value:s},p[19]=w.slugField,p[20]=s,p[21]=d):d=p[21],p[22]!==R||p[23]!==y||p[24]!==v||p[25]!==w.schema||p[26]!==U||p[27]!==c||p[28]!==j||p[29]!==d?(u={state:R,initialFiles:y,config:v,schema:w.schema,basePath:U,format:c,currentLocalTreeKey:j,slug:d},p[22]=R,p[23]=y,p[24]=v,p[25]=w.schema,p[26]=U,p[27]=c,p[28]=j,p[29]=d,p[30]=u):u=p[30];let[K,D,L]=eG(u);p[31]!==b||p[32]!==e.itemSlug||p[33]!==E||p[34]!==U||p[35]!==v||p[36]!==w.schema||p[37]!==w.slugField||p[38]!==s||p[39]!==R||p[40]!==j?(h=()=>{let t=["collection",b,e.itemSlug];if(E){let e=new Map(eB({basePath:U,format:(0,_.v)(v,b),schema:w.schema,slug:{field:w.slugField,value:s},state:R}).map(e=>[e.path,e.contents])),n={beforeTreeKey:j,slug:s,files:e,savedAt:new Date,version:1};(0,_.$)(t,n)}else(0,_.a0)(t)},p[31]=b,p[32]=e.itemSlug,p[33]=E,p[34]=U,p[35]=v,p[36]=w.schema,p[37]=w.slugField,p[38]=s,p[39]=R,p[40]=j,p[41]=h):h=p[41],p[42]!==b||p[43]!==w||p[44]!==v||p[45]!==U||p[46]!==j||p[47]!==e.itemSlug||p[48]!==s||p[49]!==R||p[50]!==E?(m=[b,w,v,U,j,e.itemSlug,s,R,E],p[42]=b,p[43]=w,p[44]=v,p[45]=U,p[46]=j,p[47]=e.itemSlug,p[48]=s,p[49]=R,p[50]=E,p[51]=m):m=p[51],(0,a.useEffect)(h,m);let A=(0,_.W)(D);p[52]!==x||p[53]!==j?(f=()=>{I({state:x,localTreeKey:j})},p[52]=x,p[53]=j,p[54]=f):f=p[54];let O=f;return p[55]!==e||p[56]!==A||p[57]!==O||p[58]!==K||p[59]!==L||p[60]!==T||p[61]!==R||p[62]!==E?(g=(0,$.jsx)(e7,{...e,onUpdate:A,onReset:O,updateResult:K,onResetUpdateItem:L,previewProps:T,state:R,hasChanged:E}),p[55]=e,p[56]=A,p[57]=O,p[58]=K,p[59]=L,p[60]=T,p[61]=R,p[62]=E,p[63]=g):g=p[63],g}function te(e){let t,n,a,l,r,o;let s=(0,i.c)(33),{collection:c,config:d,initialFiles:u,initialState:h,localTreeKey:m}=e,{collectionConfig:f,schema:g}=e0(c),p=eZ(g,e.map),b=eX(g,e.map,p),v=(0,_.P)(f,p);s[0]!==e.config||s[1]!==e.collection?(t=(0,_.v)(e.config,e.collection),s[0]=e.config,s[1]=e.collection,s[2]=t):t=s[2];let y=t;s[3]!==h||s[4]!==g||s[5]!==p||s[6]!==f.slugField?(n={initialState:h,schema:g,state:p,slugField:f.slugField},s[3]=h,s[4]=g,s[5]=p,s[6]=f.slugField,s[7]=n):n=s[7];let x=eQ(n),j=(0,_.w)(d,c,v);s[8]!==f.slugField||s[9]!==v?(a={field:f.slugField,value:v},s[8]=f.slugField,s[9]=v,s[10]=a):a=s[10],s[11]!==p||s[12]!==u||s[13]!==d||s[14]!==f.schema||s[15]!==j||s[16]!==y||s[17]!==m||s[18]!==a?(l={state:p,initialFiles:u,config:d,schema:f.schema,basePath:j,format:y,currentLocalTreeKey:m,slug:a},s[11]=p,s[12]=u,s[13]=d,s[14]=f.schema,s[15]=j,s[16]=y,s[17]=m,s[18]=a,s[19]=l):l=s[19];let[k,w,S]=eG(l),C=(0,_.W)(w);s[20]!==e.map||s[21]!==e.initialState||s[22]!==f.schema?(r=()=>{var t;null===(t=e.map.doc)||void 0===t||t.transact(()=>{for(let[t,n]of Object.entries(f.schema)){let i=eT(n,e.initialState[t]);e.map.set(t,i)}})},s[20]=e.map,s[21]=e.initialState,s[22]=f.schema,s[23]=r):r=s[23];let P=r;return s[24]!==e||s[25]!==C||s[26]!==P||s[27]!==k||s[28]!==S||s[29]!==b||s[30]!==p||s[31]!==x?(o=(0,$.jsx)(e7,{...e,onUpdate:C,onReset:P,updateResult:k,onResetUpdateItem:S,previewProps:b,state:p,hasChanged:x}),s[24]=e,s[25]=C,s[26]=P,s[27]=k,s[28]=S,s[29]=b,s[30]=p,s[31]=x,s[32]=o):o=s[32],o}function tt(e){let t,n,o,h,m,f,g,p,b,v,y,x,k,S,_,P,R,T,E,U,K,D,L;let O=(0,i.c)(55),{formID:z,hasChanged:G,isLoading:J,onDelete:V,onDuplicate:Q,onReset:Z,onCopy:Y,onPaste:X,previewHref:ee,viewHref:et}=e,en=(0,w.ac)(w.l0.below.desktop),ei=(0,u.q)(C.s),[ea,el]=(0,a.useState)(!1),[er,eo]=(0,a.useState)(!1);if(O[0]===Symbol.for("react.memo_cache_sentinel")?(n={key:"reset",label:"Reset changes",icon:A.D},O[0]=n):n=O[0],O[1]===Symbol.for("react.memo_cache_sentinel")?(o={key:"delete",label:"Delete entry",icon:F.S},O[1]=o):o=O[1],O[2]===Symbol.for("react.memo_cache_sentinel")?(h={key:"copy",label:"Copy entry",icon:N.F},O[2]=h):h=O[2],O[3]===Symbol.for("react.memo_cache_sentinel")?(m={key:"paste",label:"Paste entry",icon:q.f},O[3]=m):m=O[3],O[4]===Symbol.for("react.memo_cache_sentinel")?(f={key:"duplicate",label:"Duplicate entry",icon:M.i},O[4]=f):f=O[4],O[5]!==ee||O[6]!==et){if(g=[n,o,h,m,f],ee){let e;O[8]!==ee?(e={key:"preview",label:"Preview",icon:B.K,href:ee,target:"_blank",rel:"noopener noreferrer"},O[8]=ee,O[9]=e):e=O[9],g.push(e)}if(et){let e;O[10]!==et?(e={key:"view",label:"View on GitHub",icon:s.f,href:et,target:"_blank",rel:"noopener noreferrer"},O[10]=et,O[11]=e):e=O[11],g.push(e)}O[5]=ee,O[6]=et,O[7]=g}else g=O[7];t=g;e:{if(J){let e;O[12]===Symbol.for("react.memo_cache_sentinel")?(e=(0,$.jsx)(j._3,{"aria-label":"Saving changes",isIndeterminate:!0,size:"small",alignSelf:"center"}),O[12]=e):e=O[12],p=e;break e}if(G){let e;O[13]!==en?(e=en?(0,$.jsx)(c.xu,{backgroundColor:"pendingEmphasis",height:"scale.75",width:"scale.75",borderRadius:"full",children:(0,$.jsx)(d.xv,{visuallyHidden:!0,children:"Unsaved"})}):(0,$.jsx)(H.C,{tone:"pending",children:"Unsaved"}),O[13]=en,O[14]=e):e=O[14],p=e;break e}p=null}let es=p;O[15]===Symbol.for("react.memo_cache_sentinel")?(b={mobile:"small",tablet:"regular"},O[15]=b):b=O[15],O[16]===Symbol.for("react.memo_cache_sentinel")?(v=(0,$.jsx)(eW,{}),O[16]=v):v=O[16];let ec=en?"element.regular":void 0;return O[17]!==G?(y=G?[]:["reset"],O[17]=G,O[18]=y):y=O[18],O[19]!==Z||O[20]!==Y||O[21]!==X||O[22]!==G||O[23]!==Q?(x=e=>{switch(e){case"reset":Z();break;case"delete":el(!0);break;case"copy":Y();break;case"paste":X();break;case"duplicate":G?eo(!0):Q()}},O[19]=Z,O[20]=Y,O[21]=X,O[22]=G,O[23]=Q,O[24]=x):x=O[24],O[25]===Symbol.for("react.memo_cache_sentinel")?(k=e=>(0,$.jsxs)(W.c,{textValue:e.label,href:e.href,target:e.target,rel:e.rel,children:[(0,$.jsx)(r.J,{src:e.icon}),(0,$.jsx)(d.xv,{children:e.label})]},e.key),O[25]=k):k=O[25],O[26]!==ec||O[27]!==t||O[28]!==y||O[29]!==x?(S=(0,$.jsx)(W.W,{buttonLabelBehavior:"hide",overflowMode:"collapse",prominence:"low",density:"compact",maxWidth:ec,items:t,disabledKeys:y,onAction:x,children:k}),O[26]=ec,O[27]=t,O[28]=y,O[29]=x,O[30]=S):S=O[30],O[31]!==ei?(_=ei.format("save"),O[31]=ei,O[32]=_):_=O[32],O[33]!==z||O[34]!==J||O[35]!==_?(P=(0,$.jsx)(l.zx,{form:z,isDisabled:J,prominence:"high",type:"submit",children:_}),O[33]=z,O[34]=J,O[35]=_,O[36]=P):P=O[36],O[37]===Symbol.for("react.memo_cache_sentinel")?(R=()=>el(!1),O[37]=R):R=O[37],O[38]!==ea||O[39]!==V?(T=ea&&(0,$.jsx)(I.aR,{title:"Delete entry",tone:"critical",cancelLabel:"Cancel",primaryActionLabel:"Yes, delete",autoFocusButton:"cancel",onPrimaryAction:V,children:"Are you sure? This action cannot be undone."}),O[38]=ea,O[39]=V,O[40]=T):T=O[40],O[41]!==T?(E=(0,$.jsx)(I.TW,{onDismiss:R,children:T}),O[41]=T,O[42]=E):E=O[42],O[43]===Symbol.for("react.memo_cache_sentinel")?(U=()=>eo(!1),O[43]=U):U=O[43],O[44]!==er||O[45]!==Q?(K=er&&(0,$.jsx)(I.aR,{title:"Save and duplicate entry",tone:"neutral",cancelLabel:"Cancel",primaryActionLabel:"Save and duplicate",autoFocusButton:"primary",onPrimaryAction:Q,children:"You have unsaved changes. Save this entry to duplicate it."}),O[44]=er,O[45]=Q,O[46]=K):K=O[46],O[47]!==K?(D=(0,$.jsx)(I.TW,{onDismiss:U,children:K}),O[47]=K,O[48]=D):D=O[48],O[49]!==es||O[50]!==S||O[51]!==P||O[52]!==E||O[53]!==D?(L=(0,$.jsxs)(c.kC,{alignItems:"center",gap:b,children:[v,es,S,P,E,D]}),O[49]=es,O[50]=S,O[51]=P,O[52]=E,O[53]=D,O[54]=L):L=O[54],L}function tn(e){var t;let n,r,o,s,h,m,f,g,p,b,v,y,x,k;let S=(0,i.c)(41),P=(0,u.q)(C.s),F=(0,_.c)(),[T,E]=(0,a.useState)(""),[K,D]=(0,C.k)(),{error:L,fetching:A,data:O}=K,z=A||!!(null!=O&&null!==(t=O.createRef)&&void 0!==t&&t.__typename),W=(0,_.z)();S[0]!==W?(n=(0,_.X)(W),S[0]=W,S[1]=n):n=S[1];let H=n;S[2]!==H?(r=H?{UNSAFE_className:(0,w.iv)({"& input":{paddingInlineStart:w.iK.size.space.xsmall}}),startElement:(0,$.jsx)(c.kC,{alignItems:"center",paddingStart:"regular",justifyContent:"center",pointerEvents:"none",children:(0,$.jsx)(d.xv,{color:"neutralSecondary",children:H})})}:{},S[2]=H,S[3]=r):r=S[3];let M=r;return S[4]===Symbol.for("react.memo_cache_sentinel")?(o={display:"contents"},S[4]=o):o=S[4],S[5]!==H||S[6]!==T||S[7]!==D||S[8]!==e||S[9]!==F?(s=async t=>{var n;if(t.target!==t.currentTarget)return;t.preventDefault();let i=(null!=H?H:"")+T,a=`refs/heads/${i}`;null!==(n=(await D({input:{name:a,oid:e.branchOid,repositoryId:F.id}})).data)&&void 0!==n&&null!==(n=n.createRef)&&void 0!==n&&n.__typename&&e.onCreate(i)},S[5]=H,S[6]=T,S[7]=D,S[8]=e,S[9]=F,S[10]=s):s=S[10],S[11]!==P?(h=P.format("newBranch"),S[11]=P,S[12]=h):h=S[12],S[13]!==h?(m=(0,$.jsx)(d.X6,{children:h}),S[13]=h,S[14]=m):m=S[14],S[15]!==L?(f=(0,C.l)(L),S[15]=L,S[16]=f):f=S[16],S[17]!==T||S[18]!==e.reason||S[19]!==f||S[20]!==M?(g=(0,$.jsx)(R.VY,{children:(0,$.jsx)(c.kC,{gap:"large",direction:"column",children:(0,$.jsx)(U.nv,{value:T,onChange:E,label:"Branch name",description:e.reason,autoFocus:!0,errorMessage:f,...M})})}),S[17]=T,S[18]=e.reason,S[19]=f,S[20]=M,S[21]=g):g=S[21],S[22]!==z?(p=z&&(0,$.jsx)(j._3,{isIndeterminate:!0,size:"small","aria-label":"Creating Branch"}),S[22]=z,S[23]=p):p=S[23],S[24]!==P?(b=P.format("cancel"),S[24]=P,S[25]=b):b=S[25],S[26]!==z||S[27]!==e.onDismiss||S[28]!==b?(v=(0,$.jsx)(l.zx,{isDisabled:z,onPress:e.onDismiss,children:b}),S[26]=z,S[27]=e.onDismiss,S[28]=b,S[29]=v):v=S[29],S[30]!==z?(y=(0,$.jsx)(l.zx,{isDisabled:z,prominence:"high",type:"submit",children:"Create branch and save"}),S[30]=z,S[31]=y):y=S[31],S[32]!==p||S[33]!==v||S[34]!==y?(x=(0,$.jsxs)(l.hE,{children:[p,v,y]}),S[32]=p,S[33]=v,S[34]=y,S[35]=x):x=S[35],S[36]!==s||S[37]!==m||S[38]!==g||S[39]!==x?(k=(0,$.jsx)(I.Vq,{children:(0,$.jsxs)("form",{style:o,onSubmit:s,children:[m,g,x]})}),S[36]=s,S[37]=m,S[38]=g,S[39]=x,S[40]=k):k=S[40],k}function ti(e){var t;let n=null===(t=e.config.collections)||void 0===t?void 0:t[e.collection];n||ep();let i=(0,a.useMemo)(()=>(0,_.v)(e.config,e.collection),[e.config,e.collection]),l=(0,a.useMemo)(()=>({slug:e.itemSlug,field:n.slugField}),[n.slugField,e.itemSlug]),r=(0,_.f)((0,a.useCallback)(async()=>{try{let t=await (0,_.R)(["collection",e.collection,e.itemSlug]);if(!t)throw Error("No draft found");let i=e8.create(t);return{state:ex({dirpath:(0,_.w)(e.config,e.collection,i.slug),format:(0,_.v)(e.config,e.collection),schema:n.schema,slug:{field:n.slugField,slug:i.slug}},i.files).initialState,savedAt:i.savedAt,treeKey:i.beforeTreeKey}}catch{}},[n,e.collection,e.config,e.itemSlug])),o=ej({config:e.config,dirpath:(0,_.w)(e.config,e.collection,e.itemSlug),schema:n.schema,format:i,slug:l}),s=(0,_.q)(),d=`${s}/${e.collection}/item/${e.itemSlug}`,u=(0,_.S)(),h="loaded"!==o.kind,m=!h&&"not-found"===o.data,f=(0,_.f)((0,a.useCallback)(()=>u?"loading"===u||h?_.L:m?void 0:(async()=>{await u.doc.whenSynced;let e=u.data.get(d);if(e instanceof D.QW){let t=e.whenLoaded;e.load(),await t}else e=new D.QW,u.data.set(d,e);return e.getMap("data")})():void 0,[h,m,d,u]));return(0,$.jsx)(ev,{fallback:(0,$.jsx)(tl,{...e,children:(0,$.jsx)(C.i,{children:(0,$.jsx)(O.q,{tone:"caution",children:"Entry not found."})})}),children:(0,$.jsx)(e2,{fallback:t=>(0,$.jsx)(tl,{...e,children:(0,$.jsx)(C.i,{children:(0,$.jsx)(O.q,{tone:"critical",children:t})})}),children:(0,$.jsx)(a.Suspense,{fallback:(0,$.jsx)(tl,{...e,children:(0,$.jsx)(c.kC,{alignItems:"center",justifyContent:"center",minHeight:"scale.3000",children:(0,$.jsx)(j._3,{"aria-label":"Loading Item",isIndeterminate:!0,size:"large"})})}),children:(0,$.jsx)(ta,{mapData:f,draftData:r,itemData:o,...e})})})})}function ta(e){let t=(0,_.T)(e.config,e.collection),n=(0,a.useDeferredValue)(e.draftData),i=(0,_.U)(e.itemData);"not-found"===i&&ep();let l=(0,_.U)(e.mapData);(0,a.useMemo)(()=>{var e;if(!l||l.size)return;let{initialState:n}=i;null===(e=l.doc)||void 0===e||e.transact(()=>{for(let[e,i]of Object.entries(t.schema)){let t=eT(i,n[e]);l.set(e,t)}})},[t.schema,i,l]);let r=(0,_.U)(n);return l?(0,$.jsx)(te,{collection:e.collection,basePath:e.basePath,config:e.config,itemSlug:e.itemSlug,initialState:i.initialState,initialFiles:i.initialFiles,localTreeKey:i.localTreeKey,map:l}):(0,$.jsx)(e9,{collection:e.collection,basePath:e.basePath,config:e.config,itemSlug:e.itemSlug,initialState:i.initialState,initialFiles:i.initialFiles,draft:r,localTreeKey:i.localTreeKey})}function tl(e){let t,n,a,l,r,o;let s=(0,i.c)(17);if(s[0]!==e.config||s[1]!==e.collection||s[2]!==e.basePath||s[3]!==e.itemSlug){let i=(0,_.T)(e.config,e.collection),l=`${e.basePath}/collection/${e.collection}`;t=[{key:"collection",label:i.label,href:l},{key:"item",label:e.itemSlug}],n=C.P,a=(0,C.j)(i),s[0]=e.config,s[1]=e.collection,s[2]=e.basePath,s[3]=e.itemSlug,s[4]=t,s[5]=n,s[6]=a}else t=s[4],n=s[5],a=s[6];return s[7]!==t?(l=(0,$.jsx)(eO,{items:t}),s[7]=t,s[8]=l):l=s[8],s[9]!==l||s[10]!==e.headerActions?(r=(0,$.jsxs)(C.a,{children:[l,e.headerActions]}),s[9]=l,s[10]=e.headerActions,s[11]=r):r=s[11],s[12]!==n||s[13]!==a||s[14]!==r||s[15]!==e.children?(o=(0,$.jsxs)(n,{containerWidth:a,children:[r,e.children]}),s[12]=n,s[13]=a,s[14]=r,s[15]=e.children,s[16]=o):o=s[16],o}function tr(e){var t;let n,l,r,o,s,d,u,h,m,f;let g=(0,i.c)(53),p=(0,_.u)();g[0]!==p.href?(l=new URL(p.href,"http://localhost").searchParams.get("duplicate"),g[0]=p.href,g[1]=l):l=g[1],n=l;let b=null===(t=e.config.collections)||void 0===t?void 0:t[e.collection];b||ep(),g[2]!==e.config||g[3]!==e.collection?(o=(0,_.v)(e.config,e.collection),g[2]=e.config,g[3]=e.collection,g[4]=o):o=g[4],r=o,g[5]!==e.collection||g[6]!==e.config||g[7]!==n||g[8]!==r||g[9]!==b.schema||g[10]!==b.slugField?(s=async()=>{let t=await (0,_.R)(["collection-create",e.collection,...n?[n]:[]]);if(!t)throw Error("No draft found");let i=to.create(t);return{state:ex({dirpath:(0,_.w)(e.config,e.collection,i.slug),format:r,schema:b.schema,slug:{field:b.slugField,slug:i.slug}},i.files).initialState,savedAt:i.savedAt}},g[5]=e.collection,g[6]=e.config,g[7]=n,g[8]=r,g[9]=b.schema,g[10]=b.slugField,g[11]=s):s=g[11];let v=(0,_.f)(s);e:{if(n){let e;g[12]!==b.slugField||g[13]!==n?(e={field:b.slugField,slug:n},g[12]=b.slugField,g[13]=n,g[14]=e):e=g[14],d=e;break e}if(b.template){let e;g[15]!==b.slugField?(e={field:b.slugField,slug:""},g[15]=b.slugField,g[16]=e):e=g[16],d=e;break e}d=void 0}let y=d,x=!!n||!!b.template;g[17]!==b.template||g[18]!==n||g[19]!==e?(u=b.template&&!n?b.template:(0,_.w)(e.config,e.collection,null!=n?n:""),g[17]=b.template,g[18]=n,g[19]=e,g[20]=u):u=g[20],g[21]!==e.config||g[22]!==u||g[23]!==b.schema||g[24]!==r||g[25]!==y?(h={config:e.config,dirpath:u,schema:b.schema,format:r,slug:y},g[21]=e.config,g[22]=u,g[23]=b.schema,g[24]=r,g[25]=y,g[26]=h):h=g[26];let k=ej(h),w=x&&"loaded"===k.kind&&"not-found"!==k.data?k.data.initialState:void 0,S=(0,a.useMemo)(()=>{if(w){let{slugField:e}=b,t=w[b.slugField],n=b.schema[b.slugField];if("form"===n.kind&&"slug"===n.formKind)try{let i=n.serializeWithSlug(t),a=n.parse(i.value,{slug:i.slug?`${i.slug}-copy`:""});return{...w,[e]:a}}catch{}return{...w,[e]:t}}},[b,w]),P=(0,_.q)(),I=(0,_.S)(),R=`${P}/${e.collection}/create${null!=n&&n.length?`?duplicate=${n}`:""}`;g[27]!==I||g[28]!==x||g[29]!==w||g[30]!==R||g[31]!==b.schema?(m=async()=>{if(!I)return;if("loading"===I||(await I.doc.whenSynced,x&&!w))return _.L;let e=I.data.get(R);if(e instanceof D.QW){let t=e.whenLoaded;e.load(),await t}else e=new D.QW,I.data.set(R,e);let t=e.getMap("data");return t.size||e.transact(()=>{for(let[n,i]of Object.entries(b.schema)){var e;let a=eT(i,null!==(e=null==w?void 0:w[n])&&void 0!==e?e:(0,C.o)(i));t.set(n,a)}}),t},g[27]=I,g[28]=x,g[29]=w,g[30]=R,g[31]=b.schema,g[32]=m):m=g[32];let F=(0,_.f)(m);if(x&&"error"===k.kind){let e;return g[33]!==k.error.message?(e=(0,$.jsx)(C.i,{children:(0,$.jsx)(O.q,{tone:"critical",children:k.error.message})}),g[33]=k.error.message,g[34]=e):e=g[34],e}if("error"===F.kind){let e;return console.log(F.error),g[35]!==F.error.message?(e=(0,$.jsx)(C.i,{children:(0,$.jsx)(O.q,{tone:"critical",children:F.error.message})}),g[35]=F.error.message,g[36]=e):e=g[36],e}if(x&&"loading"===k.kind||"loading"===v.kind||"loading"===F.kind){let e;return g[37]===Symbol.for("react.memo_cache_sentinel")?(e=(0,$.jsx)(c.kC,{alignItems:"center",justifyContent:"center",minHeight:"scale.3000",children:(0,$.jsx)(j._3,{"aria-label":"Loading Item",isIndeterminate:!0,size:"large"})}),g[37]=e):e=g[37],e}if(x&&"loaded"===k.kind&&"not-found"===k.data){let e;return g[38]===Symbol.for("react.memo_cache_sentinel")?(e=(0,$.jsx)(C.i,{children:(0,$.jsx)(O.q,{tone:"caution",children:"Entry not found."})}),g[38]=e):e=g[38],e}if(!F.data){let t;let i="loaded"===v.kind?v.data:void 0;return g[39]!==e.collection||g[40]!==e.config||g[41]!==e.basePath||g[42]!==i||g[43]!==n||g[44]!==S?(t=(0,$.jsx)(ts,{collection:e.collection,config:e.config,basePath:e.basePath,draft:i,duplicateSlug:n,initialState:S}),g[39]=e.collection,g[40]=e.config,g[41]=e.basePath,g[42]=i,g[43]=n,g[44]=S,g[45]=t):t=g[45],t}return g[46]!==e.collection||g[47]!==e.config||g[48]!==e.basePath||g[49]!==n||g[50]!==S||g[51]!==F.data?(f=(0,$.jsx)(tc,{collection:e.collection,config:e.config,basePath:e.basePath,duplicateSlug:n,initialState:S,map:F.data}),g[46]=e.collection,g[47]=e.config,g[48]=e.basePath,g[49]=n,g[50]=S,g[51]=F.data,g[52]=f):f=g[52],f}let to=L.dt({version:L.i0(1),savedAt:L.hT(),slug:L.Z_(),files:L.UI(L.Z_(),L.eE(Uint8Array))});function ts(e){var t,n,l;let r,o,s,c,d,u,h,m,f,g,p,b;let v=(0,i.c)(61),{collectionConfig:y,schema:x}=e0(e.collection);v[0]!==e.initialState||v[1]!==x?(o=null!==(l=e.initialState)&&void 0!==l?l:(0,C.o)(x),v[0]=e.initialState,v[1]=x,v[2]=o):o=v[2],r=o;let[j,k]=(0,a.useState)(null!==(t=null===(n=e.draft)||void 0===n?void 0:n.state)&&void 0!==t?t:r),w=eY(x,k,j);if((0,_.V)(e.draft,j,void 0),v[3]!==y||v[4]!==j||v[5]!==e.config||v[6]!==e.collection){let t;c=(0,_.P)(y,j),v[10]!==e.config||v[11]!==e.collection?(t=(0,_.v)(e.config,e.collection),v[10]=e.config,v[11]=e.collection,v[12]=t):t=v[12],d=t,s=(0,_.w)(e.config,e.collection,c),v[3]=y,v[4]=j,v[5]=e.config,v[6]=e.collection,v[7]=s,v[8]=c,v[9]=d}else s=v[7],c=v[8],d=v[9];let S=s;v[13]!==y.slugField||v[14]!==c?(u={field:y.slugField,value:c},v[13]=y.slugField,v[14]=c,v[15]=u):u=v[15],v[16]!==j||v[17]!==S||v[18]!==e.config||v[19]!==y.schema||v[20]!==d||v[21]!==u?(h={state:j,basePath:S,initialFiles:void 0,config:e.config,schema:y.schema,format:d,currentLocalTreeKey:void 0,slug:u},v[16]=j,v[17]=S,v[18]=e.config,v[19]=y.schema,v[20]=d,v[21]=u,v[22]=h):h=v[22];let[P,I,R]=eG(h),F=(0,_.W)(I);v[23]!==r||v[24]!==x||v[25]!==j||v[26]!==y.slugField?(m={initialState:r,schema:x,state:j,slugField:y.slugField},v[23]=r,v[24]=x,v[25]=j,v[26]=y.slugField,v[27]=m):m=v[27];let T=eQ(m),E="updated"===P.kind||"loading"===P.kind;return v[28]!==e.collection||v[29]!==e.duplicateSlug||v[30]!==T||v[31]!==E||v[32]!==S||v[33]!==d||v[34]!==y.schema||v[35]!==y.slugField||v[36]!==c||v[37]!==j?(f=()=>{let t=["collection-create",e.collection,...e.duplicateSlug?[e.duplicateSlug]:[]];if(T&&!E){let e=new Map(eB({basePath:S,format:d,schema:y.schema,slug:{field:y.slugField,value:c},state:j}).map(e=>[e.path,e.contents])),n={slug:c,files:e,savedAt:new Date,version:1};(0,_.$)(t,n)}else(0,_.a0)(t)},v[28]=e.collection,v[29]=e.duplicateSlug,v[30]=T,v[31]=E,v[32]=S,v[33]=d,v[34]=y.schema,v[35]=y.slugField,v[36]=c,v[37]=j,v[38]=f):f=v[38],v[39]!==y||v[40]!==c||v[41]!==j||v[42]!==T||v[43]!==e.duplicateSlug||v[44]!==e.collection||v[45]!==S||v[46]!==d||v[47]!==E?(g=[y,c,j,T,e.duplicateSlug,e.collection,S,d,E],v[39]=y,v[40]=c,v[41]=j,v[42]=T,v[43]=e.duplicateSlug,v[44]=e.collection,v[45]=S,v[46]=d,v[47]=E,v[48]=g):g=v[48],(0,a.useEffect)(f,g),v[49]!==r?(p=()=>{k(r)},v[49]=r,v[50]=p):p=v[50],v[51]!==e.basePath||v[52]!==e.collection||v[53]!==P||v[54]!==F||v[55]!==R||v[56]!==j||v[57]!==c||v[58]!==w||v[59]!==p?(b=(0,$.jsx)(td,{basePath:e.basePath,collection:e.collection,createResult:P,createItem:F,resetCreateItemState:R,state:j,slug:c,previewProps:w,onReset:p}),v[51]=e.basePath,v[52]=e.collection,v[53]=P,v[54]=F,v[55]=R,v[56]=j,v[57]=c,v[58]=w,v[59]=p,v[60]=b):b=v[60],b}function tc(e){let t,n,a,l,r,o,s;let c=(0,i.c)(34),{collectionConfig:d,schema:u}=e0(e.collection),h=eZ(u,e.map),m=eX(u,e.map,h);if(c[0]!==d||c[1]!==h||c[2]!==e.config||c[3]!==e.collection){let i;n=(0,_.P)(d,h),c[7]!==e.config||c[8]!==e.collection?(i=(0,_.v)(e.config,e.collection),c[7]=e.config,c[8]=e.collection,c[9]=i):i=c[9],a=i,t=(0,_.w)(e.config,e.collection,n),c[0]=d,c[1]=h,c[2]=e.config,c[3]=e.collection,c[4]=t,c[5]=n,c[6]=a}else t=c[4],n=c[5],a=c[6];let f=t;c[10]!==d.slugField||c[11]!==n?(l={field:d.slugField,value:n},c[10]=d.slugField,c[11]=n,c[12]=l):l=c[12],c[13]!==h||c[14]!==f||c[15]!==e.config||c[16]!==d.schema||c[17]!==a||c[18]!==l?(r={state:h,basePath:f,initialFiles:void 0,config:e.config,schema:d.schema,format:a,currentLocalTreeKey:void 0,slug:l},c[13]=h,c[14]=f,c[15]=e.config,c[16]=d.schema,c[17]=a,c[18]=l,c[19]=r):r=c[19];let[g,p,b]=eG(r),v=(0,_.W)(p);return c[20]!==e.map||c[21]!==e.initialState||c[22]!==d.schema?(o=()=>{var t;null===(t=e.map.doc)||void 0===t||t.transact(()=>{for(let[i,a]of Object.entries(d.schema)){var t,n;let l=eT(a,null!==(t=null===(n=e.initialState)||void 0===n?void 0:n[i])&&void 0!==t?t:(0,C.o)(a));e.map.set(i,l)}})},c[20]=e.map,c[21]=e.initialState,c[22]=d.schema,c[23]=o):o=c[23],c[24]!==e.basePath||c[25]!==e.collection||c[26]!==g||c[27]!==v||c[28]!==b||c[29]!==h||c[30]!==n||c[31]!==m||c[32]!==o?(s=(0,$.jsx)(td,{basePath:e.basePath,collection:e.collection,createResult:g,createItem:v,resetCreateItemState:b,state:h,slug:n,previewProps:m,onReset:o}),c[24]=e.basePath,c[25]=e.collection,c[26]=g,c[27]=v,c[28]=b,c[29]=h,c[30]=n,c[31]=m,c[32]=o,c[33]=s):s=c[33],s}function td(e){let t,n,o,s,h,m,f,g,p,b,v,y,x,k,S,P,R,F,T,E,U,K,D,L,A,H,M,N,q;let B=(0,i.c)(96),{onReset:G}=e,J=(0,u.q)(C.s),V=(0,_.u)(),Q=(0,_.z)(),{collectionConfig:Z,schema:Y}=e0(e.collection),[X,ee]=(0,a.useState)(!1);B[0]!==Q||B[1]!==e.collection?(t=(0,_.v)(Q,e.collection),B[0]=Q,B[1]=e.collection,B[2]=t):t=B[2];let et=t,en=(0,_.b)(),ei=`${e.basePath}/collection/${encodeURIComponent(e.collection)}`,{createResult:ea}=e,el="updated"===ea.kind||"loading"===ea.kind?e.slug:void 0,er=ez(e.collection,el);B[3]!==ea.kind||B[4]!==Y||B[5]!==e||B[6]!==er||B[7]!==Z||B[8]!==V||B[9]!==ei?(n=async()=>{if("loading"!==ea.kind){if(!(0,C.m)(Y,e.state,er)){ee(!0);return}if(await e.createItem()){let t=(0,_.P)(Z,e.state);V.push(`${ei}/item/${encodeURIComponent(t)}`),z.g.positive("Entry created",{timeout:5e3})}}},B[3]=ea.kind,B[4]=Y,B[5]=e,B[6]=er,B[7]=Z,B[8]=V,B[9]=ei,B[10]=n):n=B[10];let eo=n;B[11]!==e.state||B[12]!==et||B[13]!==Z?(o=()=>{e6(e.state,et,Z.schema,{field:Z.slugField,value:(0,_.P)(Z,e.state)})},B[11]=e.state,B[12]=et,B[13]=Z,B[14]=o):o=B[14];let es=o;B[15]!==et||B[16]!==Z||B[17]!==e.state||B[18]!==e.previewProps?(s=async()=>{let t=await e5(et,Z.schema,{field:Z.slugField,slug:(0,_.P)(Z,e.state)});t&&((0,C.n)(t,e.previewProps),z.g.positive("Entry pasted",{shouldCloseOnAction:!0,actionLabel:"Undo",onAction:()=>{(0,C.n)(e.state,e.previewProps)}}))},B[15]=et,B[16]=Z,B[17]=e.state,B[18]=e.previewProps,B[19]=s):s=B[19];let ec=s,ed="loading"===ea.kind||"updated"===ea.kind;B[20]!==Z.label||B[21]!==ei?(m={key:"collection",label:Z.label,href:ei},B[20]=Z.label,B[21]=ei,B[22]=m):m=B[22],B[23]!==J?(f=J.format("add"),B[23]=J,B[24]=f):f=B[24],B[25]!==f?(g={key:"current",label:f},B[25]=f,B[26]=g):g=B[26],B[27]!==m||B[28]!==g?(p=[m,g],B[27]=m,B[28]=g,B[29]=p):p=B[29],h=p;let eu=(0,w.ac)(w.l0.below.desktop);B[30]!==Z?(b=(0,C.j)(Z),B[30]=Z,B[31]=b):b=B[31],B[32]!==h?(v=(0,$.jsx)(eO,{items:h}),B[32]=h,B[33]=v):v=B[33],B[34]===Symbol.for("react.memo_cache_sentinel")?(y=(0,$.jsx)(eW,{}),B[34]=y):y=B[34],B[35]!==ed?(x=ed&&(0,$.jsx)(j._3,{"aria-label":"Creating entry",isIndeterminate:!0,size:"small"}),B[35]=ed,B[36]=x):x=B[36];let eh=eu?"element.regular":void 0;return B[37]!==G||B[38]!==es||B[39]!==ec?(k=e=>{switch(e){case"reset":G(),ee(!1);break;case"copy":es();break;case"paste":ec()}},B[37]=G,B[38]=es,B[39]=ec,B[40]=k):k=B[40],B[41]===Symbol.for("react.memo_cache_sentinel")?(S=e=>(0,$.jsxs)(W.c,{textValue:e.label,children:[(0,$.jsx)(r.J,{src:e.icon}),(0,$.jsx)(d.xv,{children:e.label})]},e.key),B[41]=S):S=B[41],B[42]!==eh||B[43]!==k?(P=(0,$.jsx)(W.W,{buttonLabelBehavior:"hide",overflowMode:"collapse",prominence:"low",density:"compact",maxWidth:eh,items:tu,onAction:k,children:S}),B[42]=eh,B[43]=k,B[44]=P):P=B[44],B[45]!==J?(R=J.format("create"),B[45]=J,B[46]=R):R=B[46],B[47]!==ed||B[48]!==R?(F=(0,$.jsx)(l.zx,{isDisabled:ed,prominence:"high",type:"submit",form:"item-create-form",marginStart:"auto",children:R}),B[47]=ed,B[48]=R,B[49]=F):F=B[49],B[50]!==v||B[51]!==x||B[52]!==P||B[53]!==F?(T=(0,$.jsxs)(C.a,{children:[v,y,x,P,F]}),B[50]=v,B[51]=x,B[52]=P,B[53]=F,B[54]=T):T=B[54],B[55]!==eo?(E=e=>{e.target===e.currentTarget&&(e.preventDefault(),eo())},B[55]=eo,B[56]=E):E=B[56],B[57]!==ea?(U="error"===ea.kind&&(0,$.jsx)(O.q,{tone:"critical",children:ea.error.message}),B[57]=ea,B[58]=U):U=B[58],B[59]!==e.previewProps||B[60]!==X||B[61]!==Z.entryLayout||B[62]!==et||B[63]!==er?(K=(0,$.jsx)(C.F,{previewProps:e.previewProps,forceValidation:X,entryLayout:Z.entryLayout,formatInfo:et,slugField:er}),B[59]=e.previewProps,B[60]=X,B[61]=Z.entryLayout,B[62]=et,B[63]=er,B[64]=K):K=B[64],B[65]!==E||B[66]!==U||B[67]!==K?(D=(0,$.jsxs)(c.kC,{id:"item-create-form",elementType:"form",onSubmit:E,direction:"column",gap:"xxlarge",height:"100%",minHeight:0,minWidth:0,children:[U,K]}),B[65]=E,B[66]=U,B[67]=K,B[68]=D):D=B[68],B[69]!==b||B[70]!==T||B[71]!==D?(L=(0,$.jsxs)(C.P,{containerWidth:b,children:[T,D]}),B[69]=b,B[70]=T,B[71]=D,B[72]=L):L=B[72],B[73]!==ea||B[74]!==V||B[75]!==e||B[76]!==en||B[77]!==Z?(A="needs-new-branch"===ea.kind&&(0,$.jsx)(tn,{branchOid:en,onCreate:async t=>{if(V.push(`/keystatic/branch/${encodeURIComponent(t)}/collection/${encodeURIComponent(e.collection)}/create`),await e.createItem({branch:t,sha:en})){let n=(0,_.P)(Z,e.state);V.push(`/keystatic/branch/${encodeURIComponent(t)}/collection/${encodeURIComponent(e.collection)}/item/${encodeURIComponent(n)}`)}},reason:ea.reason,onDismiss:e.resetCreateItemState}),B[73]=ea,B[74]=V,B[75]=e,B[76]=en,B[77]=Z,B[78]=A):A=B[78],B[79]!==e.resetCreateItemState||B[80]!==A?(H=(0,$.jsx)(I.TW,{onDismiss:e.resetCreateItemState,children:A}),B[79]=e.resetCreateItemState,B[80]=A,B[81]=H):H=B[81],B[82]!==ea.kind||B[83]!==Q||B[84]!==e||B[85]!==Z||B[86]!==V||B[87]!==ei?(M="needs-fork"===ea.kind&&(0,_._)(Q)&&(0,$.jsx)(eA,{onCreate:async()=>{if(await e.createItem()){let t=(0,_.P)(Z,e.state);V.push(`${ei}/item/${encodeURIComponent(t)}`)}},onDismiss:e.resetCreateItemState,config:Q}),B[82]=ea.kind,B[83]=Q,B[84]=e,B[85]=Z,B[86]=V,B[87]=ei,B[88]=M):M=B[88],B[89]!==e.resetCreateItemState||B[90]!==M?(N=(0,$.jsx)(I.TW,{onDismiss:e.resetCreateItemState,children:M}),B[89]=e.resetCreateItemState,B[90]=M,B[91]=N):N=B[91],B[92]!==L||B[93]!==H||B[94]!==N?(q=(0,$.jsxs)($.Fragment,{children:[L,H,N]}),B[92]=L,B[93]=H,B[94]=N,B[95]=q):q=B[95],q}let tu=[{key:"reset",label:"Reset",icon:A.D},{key:"copy",label:"Copy entry",icon:N.F},{key:"paste",label:"Paste entry",icon:q.f}],th=e=>{let t,n;let a=(0,i.c)(5),{children:l,title:r}=e;return a[0]!==r?(t=(0,$.jsx)(d.xv,{casing:"uppercase",color:"neutralTertiary",size:"small",weight:"bold",elementType:"h2",children:r}),a[0]=r,a[1]=t):t=a[1],a[2]!==t||a[3]!==l?(n=(0,$.jsxs)(c.kC,{elementType:"section",direction:"column",gap:"medium",children:[t,l]}),a[2]=t,a[3]=l,a[4]=n):n=a[4],n},tm="fill",tf=e=>(0,$.jsx)("div",{className:(0,w.iv)({display:"grid",gap:w.iK.size.space.large,gridAutoRows:w.iK.size.element.xlarge,gridTemplateColumns:`[${tm}-start] 1fr [${tm}-end]`,[w.bp.above.mobile]:{gridTemplateColumns:`[${tm}-start] 1fr 1fr [${tm}-end]`},[w.bp.above.tablet]:{gridTemplateColumns:`[${tm}-start] 1fr 1fr 1fr [${tm}-end]`}}),...e}),tg=e=>{let t,n,l,r;let o=(0,i.c)(12),s=(0,a.useRef)(null),{linkProps:u}=(0,x.n)(e,s);return o[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,w.AK)((0,w.iv)({color:w.iK.color.foreground.neutral,outline:"none","&:hover":{color:w.iK.color.foreground.neutralEmphasis,"::before":{backgroundColor:w.iK.color.alias.backgroundIdle,borderColor:w.iK.color.border.neutral}},"&:active":{"::before":{backgroundColor:w.iK.color.alias.backgroundHovered,borderColor:w.iK.color.alias.borderHovered}},"&:focus-visible::before":{outline:`${w.iK.size.alias.focusRing} solid ${w.iK.color.alias.focusRing}`,outlineOffset:w.iK.size.alias.focusRingGap},"::before":{border:`${w.iK.size.border.regular} solid ${w.iK.color.border.muted}`,borderRadius:w.iK.size.radius.medium,content:'""',position:"absolute",inset:0,transition:(0,w.eR)(["background-color","border-color"])}})),o[0]=t):t=o[0],o[1]!==s||o[2]!==e.href||o[3]!==e.label||o[4]!==u?(n=(0,$.jsx)(d.X6,{elementType:"h3",size:"small",truncate:!0,children:(0,$.jsx)("a",{ref:s,href:e.href,...u,className:t,children:e.label})}),o[1]=s,o[2]=e.href,o[3]=e.label,o[4]=u,o[5]=n):n=o[5],o[6]!==n||o[7]!==e.children?(l=(0,$.jsxs)(c.kC,{direction:"column",gap:"medium",flex:!0,children:[n,e.children]}),o[6]=n,o[7]=e.children,o[8]=l):l=o[8],o[9]!==l||o[10]!==e.endElement?(r=(0,$.jsxs)(c.kC,{alignItems:"center",backgroundColor:"canvas",padding:"large",position:"relative",children:[l,e.endElement]}),o[9]=l,o[10]=e.endElement,o[11]=r):r=o[11],r};function tp(){let e,t,n,a,o,s,h,m,f,g,p,b;let v=(0,i.c)(30),y=(0,_.c)(),x=(0,_.q)(),j=(0,_.u)(),k=(0,u.q)(C.s),w=(0,C.q)();v[0]!==y?(e=y&&(0,_.Y)(y),v[0]=y,v[1]=e):e=v[1];let S=e,P=x===(null==y?void 0:y.defaultBranch);return v[2]!==k?(t=k.format("currentBranch"),v[2]=k,v[3]=t):t=v[3],v[4]===Symbol.for("react.memo_cache_sentinel")?(n=(0,$.jsx)(r.J,{src:es.D,color:"neutralTertiary"}),v[4]=n):n=v[4],v[5]!==x?(a=(0,$.jsxs)(c.kC,{alignItems:"center",gap:"regular",border:"muted",borderRadius:"medium",backgroundColor:"canvas",padding:"large",children:[n,(0,$.jsx)(d.xv,{size:"medium",weight:"semibold",children:x})]}),v[5]=x,v[6]=a):a=v[6],v[7]===Symbol.for("react.memo_cache_sentinel")?(o=(0,$.jsx)(r.J,{src:ec.Y}),v[7]=o):o=v[7],v[8]!==k?(s=k.format("newBranch"),v[8]=k,v[9]=s):s=v[9],v[10]!==s?(h=(0,$.jsxs)(l.Kk,{children:[o,(0,$.jsx)(d.xv,{children:s})]}),v[10]=s,v[11]=h):h=v[11],v[12]!==j?(m=e=>(0,$.jsx)(C.C,{onDismiss:e,onCreate:t=>{e(),j.push(j.href.replace(/\/branch\/[^/]+/,"/branch/"+encodeURIComponent(t)))}}),v[12]=j,v[13]=m):m=v[13],v[14]!==h||v[15]!==m?(f=(0,$.jsxs)(I.hg,{children:[h,m]}),v[14]=h,v[15]=m,v[16]=f):f=v[16],v[17]!==P||v[18]!==w||v[19]!==S||v[20]!==x||v[21]!==k?(g=!P&&void 0!==w&&(!1===w?(0,$.jsxs)(l.Kk,{href:`${S}/pull/new/${x}`,target:"_blank",children:[(0,$.jsx)(r.J,{src:ed.D}),(0,$.jsx)(d.xv,{children:k.format("createPullRequest")})]}):(0,$.jsxs)(l.Kk,{href:`${S}/pull/${w}`,target:"_blank",children:[(0,$.jsx)(r.J,{src:ed.D}),(0,$.jsxs)(d.xv,{children:["Pull request #",w]})]})),v[17]=P,v[18]=w,v[19]=S,v[20]=x,v[21]=k,v[22]=g):g=v[22],v[23]!==f||v[24]!==g?(p=(0,$.jsxs)(c.kC,{gap:"regular",wrap:!0,children:[f,g]}),v[23]=f,v[24]=g,v[25]=p):p=v[25],v[26]!==t||v[27]!==a||v[28]!==p?(b=(0,$.jsxs)(th,{title:t,children:[a,p]}),v[26]=t,v[27]=a,v[28]=p,v[29]=b):b=v[29],b}function tb(){let e,t,n;let a=(0,i.c)(9),o=(0,C.r)();if(a[0]!==o){let t;a[2]===Symbol.for("react.memo_cache_sentinel")?(t=e=>"children"in e,a[2]=t):t=a[2],e=o.some(t),a[0]=o,a[1]=e}else e=a[1];let s=e;if(a[3]!==o){let e;a[5]===Symbol.for("react.memo_cache_sentinel")?(e=e=>(function e(t){if(t.isDivider)return(0,$.jsx)(c.kC,{gridColumn:tm,children:(0,$.jsx)(c.iz,{alignSelf:"center",size:"medium",width:"alias.singleLineWidth"})},tv++);if(t.children)return(0,$.jsx)(th,{title:t.title,children:(0,$.jsx)(tf,{children:t.children.map(t=>e(t))})},t.title);let n=(()=>{if(t.changed)return"number"==typeof t.changed?(0,$.jsx)(H.C,{tone:"accent",marginStart:"auto",children:(0,C.v)(t.changed,{singular:"change",plural:"changes"})}):(0,$.jsx)(H.C,{tone:"accent",children:"Changed"})})(),i="number"!=typeof t.entryCount?n:(0,$.jsxs)(c.kC,{gap:"medium",alignItems:"center",children:[n,(0,$.jsx)(l.Kk,{"aria-label":"Add",href:`${t.href}/create`,children:(0,$.jsx)(r.J,{src:eu.R})})]});return(0,$.jsx)(tg,{label:t.label,href:t.href,endElement:i,children:"number"==typeof t.entryCount?(0,$.jsx)(d.xv,{color:"neutralSecondary",children:(0,C.v)(t.entryCount,{singular:"entry",plural:"entries"})}):null},t.key)})(e),a[5]=e):e=a[5],t=o.map(e),a[3]=o,a[4]=t}else t=a[4];let u=t;return a[6]!==s||a[7]!==u?(n=s?(0,$.jsx)($.Fragment,{children:u}):(0,$.jsx)(th,{title:"Content",children:(0,$.jsx)(tf,{children:u})}),a[6]=s,a[7]=u,a[8]=n):n=a[8],n}let tv=0;function ty(e){let t,n,a,l,r,o,s,h;let m=(0,i.c)(19),f=(0,u.q)(C.s),g=(0,_.a1)(),p=(0,_.A)();if(m[0]!==g||m[1]!==p){var b;t=g?{name:null!==(b=g.name)&&void 0!==b?b:g.login,avatarUrl:g.avatarUrl}:null==p?void 0:p.user,m[0]=g,m[1]=p,m[2]=t}else t=m[2];let v=t;return m[3]!==f?(n=f.format("dashboard"),m[3]=f,m[4]=n):n=m[4],m[5]!==n?(a=(0,$.jsx)(C.a,{children:(0,$.jsx)(d.X6,{elementType:"h1",id:"page-title",size:"small",children:n})}),m[5]=n,m[6]=a):a=m[6],m[7]!==v||m[8]!==p?(l=v&&(0,$.jsx)(tx,{user:v,manageAccount:!!p}),m[7]=v,m[8]=p,m[9]=l):l=m[9],m[10]!==e.config?(r=!(0,_.r)(e.config)&&(0,$.jsx)(tp,{}),m[10]=e.config,m[11]=r):r=m[11],m[12]===Symbol.for("react.memo_cache_sentinel")?(o=(0,$.jsx)(tb,{}),m[12]=o):o=m[12],m[13]!==l||m[14]!==r?(s=(0,$.jsx)(C.i,{isScrollable:!0,children:(0,$.jsxs)(c.kC,{direction:"column",gap:"xxlarge",children:[l,r,o]})}),m[13]=l,m[14]=r,m[15]=s):s=m[15],m[16]!==a||m[17]!==s?(h=(0,$.jsxs)(C.P,{containerWidth:"large",children:[a,s]}),m[16]=a,m[17]=s,m[18]=h):h=m[18],h}function tx(e){let t,n,a,l,r,o,s;let u=(0,i.c)(15),{user:h,manageAccount:m}=e;return u[0]===Symbol.for("react.memo_cache_sentinel")?(t={below:"tablet"},u[0]=t):t=u[0],u[1]!==h.avatarUrl||u[2]!==h.name?(n=(0,$.jsx)(Y.q,{src:h.avatarUrl,name:h.name,size:"large"}),u[1]=h.avatarUrl,u[2]=h.name,u[3]=n):n=u[3],u[4]===Symbol.for("react.memo_cache_sentinel")?(a={fontWeight:w.iK.typography.fontWeight.bold},u[4]=a):a=u[4],u[5]!==h.name?(l=(0,$.jsxs)(d.X6,{size:"medium",elementType:"p",UNSAFE_style:a,children:["Hello, ",h.name,"!"]}),u[5]=h.name,u[6]=l):l=u[6],u[7]!==m?(r=m&&(0,$.jsx)(x.h,{href:"https://keystatic.cloud/account",children:"Manage Account"}),u[7]=m,u[8]=r):r=u[8],u[9]!==l||u[10]!==r?(o=(0,$.jsxs)(c.gC,{gap:"medium",children:[l,r]}),u[9]=l,u[10]=r,u[11]=o):o=u[11],u[12]!==n||u[13]!==o?(s=(0,$.jsxs)(c.kC,{alignItems:"center",gap:"medium",isHidden:t,children:[n,o]}),u[12]=n,u[13]=o,u[14]=s):s=u[14],s}let tj=e=>{let t,n,l,r;let o=(0,i.c)(13),s=(0,w.ac)(w.l0.below.desktop),c=(0,C.w)(),d=(0,a.useRef)(null),u=(0,_.a2)(d),h=s||!c.isOpen;return o[0]!==s?(t=s?(0,$.jsx)(C.S,{}):(0,$.jsx)(E.ok,{children:(0,$.jsx)(C.x,{})}),o[0]=s,o[1]=t):t=o[1],o[2]!==d||o[3]!==e.children?(n=(0,$.jsx)(E.SI,{ref:d,children:e.children}),o[2]=d,o[3]=e.children,o[4]=n):n=o[4],o[5]!==h||o[6]!==c.toggle||o[7]!==t||o[8]!==n?(l=(0,$.jsxs)(E.z3,{autoSaveId:"keystatic-app-split-view",isCollapsed:h,onCollapseChange:c.toggle,defaultSize:260,minSize:180,maxSize:400,height:"100vh",children:[t,n]}),o[5]=h,o[6]=c.toggle,o[7]=t,o[8]=n,o[9]=l):l=o[9],o[10]!==u||o[11]!==l?(r=(0,$.jsx)(_.a3,{value:u,children:l}),o[10]=u,o[11]=l,o[12]=r):r=o[12],r};function tk(e){var t;let n=(0,i.c)(2),l=(0,_.a9)(),r=(0,_.q)(),o=(0,a.useContext)(_.aa);if((null==o||null===(t=o.data)||void 0===t||null===(t=t.repository)||void 0===t||null===(t=t.refs)||void 0===t?void 0:t.pageInfo.hasNextPage)===!1&&!l.has(r)){let e;let t=`The branch ${r} does not exist in this repository.`;return n[0]!==t?(e=(0,$.jsx)(em,{icon:m.i,title:"Branch not found",message:t}),n[0]=t,n[1]=e):e=n[1],e}return e.children}let tw=e=>{let t,n,a,l,r;let o=(0,i.c)(19);o[0]!==e.children?(t=(0,$.jsx)(_.a4.Consumer,{children:t=>t&&!(null!=t&&t.graphQLErrors.some(e=>{var t;return(null==e||null===(t=e.originalError)||void 0===t?void 0:t.type)==="NOT_FOUND"}))?(0,$.jsx)(em,{icon:m.i,title:"Failed to load shell",message:t.message}):e.children}),o[0]=e.children,o[1]=t):t=o[1];let s=t;o[2]!==e.basePath?(n={basePath:e.basePath},o[2]=e.basePath,o[3]=n):n=o[3],o[4]!==s?(a=(0,$.jsx)(C.y,{children:(0,$.jsx)(tj,{children:(0,$.jsx)(tk,{children:s})})}),o[4]=s,o[5]=a):a=o[5],o[6]!==n||o[7]!==a?(l=(0,$.jsx)(_.a5.Provider,{value:n,children:a}),o[6]=n,o[7]=a,o[8]=l):l=o[8],o[9]!==e.config||o[10]!==l?(r=(0,$.jsx)(_.a6.Provider,{value:e.config,children:l}),o[9]=e.config,o[10]=l,o[11]=r):r=o[11];let c=r;if((0,_._)(e.config)||"cloud"===e.config.storage.kind){let t;return o[12]!==e.currentBranch||o[13]!==e.config||o[14]!==c?(t=(0,$.jsx)(_.a7,{currentBranch:e.currentBranch,config:e.config,children:c}),o[12]=e.currentBranch,o[13]=e.config,o[14]=c,o[15]=t):t=o[15],t}if((0,_.r)(e.config)){let t;return o[16]!==e.config||o[17]!==c?(t=(0,$.jsx)(_.a8,{config:e.config,children:c}),o[16]=e.config,o[17]=c,o[18]=t):t=o[18],t}return null};function tS(e){let t,n,o,u,h,m,f,g,p,b,v,y,x,k,S,P,R,F,T,E,U,K,D,L,M,G,J,V,Q,Z,Y,X;let ee=(0,i.c)(96),et=(0,w.ac)(w.l0.below.desktop),en=(0,_.c)(),ei=(0,_.q)(),[ea,el]=(0,a.useState)(!1),{schema:er,singletonConfig:eo}=e1(e.singleton),es=(0,_.u)();e:{let e;if(!eo.previewUrl){t=void 0;break e}ee[0]!==eo.previewUrl||ee[1]!==ei?(e=eo.previewUrl.replace("{branch}",ei),ee[0]=eo.previewUrl,ee[1]=ei,ee[2]=e):e=ee[2],t=e}let ec=t;ee[3]!==e.config?(n=(0,_._)(e.config)||(0,_.ad)(e.config),ee[3]=e.config,ee[4]=n):n=ee[4];let ed=n;if(ee[5]!==e.config||ee[6]!==e.singleton||ee[7]!==e.initialState||ee[8]!==ed||ee[9]!==en||ee[10]!==ei){var eu,eh;u=(0,_.ab)(e.config,e.singleton);let t=!!e.initialState,n=(0,_.ac)(e.config,e.singleton);o=ed&&t&&en?`${(0,_.Y)(en)}${"index"===u.dataLocation?`/tree/${ei}/${null!==(eu=(0,_.l)(e.config.storage))&&void 0!==eu?eu:""}${n}`:`/blob/${null!==(eh=(0,_.l)(e.config.storage))&&void 0!==eh?eh:""}${ei}/${n}${(0,_.Z)(u)}`}`:void 0,ee[5]=e.config,ee[6]=e.singleton,ee[7]=e.initialState,ee[8]=ed,ee[9]=en,ee[10]=ei,ee[11]=o,ee[12]=u}else o=ee[11],u=ee[12];let em=o;if(ee[13]===Symbol.for("react.memo_cache_sentinel")?(m={key:"reset",label:"Reset",icon:A.D},ee[13]=m):m=ee[13],ee[14]===Symbol.for("react.memo_cache_sentinel")?(f={key:"copy",label:"Copy entry",icon:N.F},ee[14]=f):f=ee[14],ee[15]===Symbol.for("react.memo_cache_sentinel")?(g={key:"paste",label:"Paste entry",icon:q.f},ee[15]=g):g=ee[15],ee[16]!==ec||ee[17]!==em){if(p=[m,f,g],ec){let e;ee[19]!==ec?(e={key:"preview",label:"Preview",icon:B.K,href:ec,target:"_blank",rel:"noopener noreferrer"},ee[19]=ec,ee[20]=e):e=ee[20],p.push(e)}if(em){let e;ee[21]!==em?(e={key:"view",label:"View on GitHub",icon:s.f,href:em,target:"_blank",rel:"noopener noreferrer"},ee[21]=em,ee[22]=e):e=ee[22],p.push(e)}ee[16]=ec,ee[17]=em,ee[18]=p}else p=ee[18];h=p;let ef=(0,_.b)(),eg=null===e.initialState;ee[23]!==e||ee[24]!==er?(b=async()=>{if("loading"!==e.updateResult.kind&&e.hasChanged){if(!(0,C.m)(er,e.state,void 0)){el(!0);return}await e.onUpdate()}},ee[23]=e,ee[24]=er,ee[25]=b):b=ee[25];let ep=b;ee[26]!==e.state||ee[27]!==u||ee[28]!==eo.schema?(v=()=>{e6(e.state,u,eo.schema,void 0)},ee[26]=e.state,ee[27]=u,ee[28]=eo.schema,ee[29]=v):v=ee[29];let eb=v;ee[30]!==u||ee[31]!==eo.schema||ee[32]!==e.previewProps||ee[33]!==e.state?(y=async()=>{let t=await e5(u,eo.schema,void 0);t&&((0,C.n)(t,e.previewProps),z.g.positive("Entry pasted",{shouldCloseOnAction:!0,actionLabel:"Undo",onAction:()=>{(0,C.n)(e.state,e.previewProps)}}))},ee[30]=u,ee[31]=eo.schema,ee[32]=e.previewProps,ee[33]=e.state,ee[34]=y):y=ee[34];let ev=y;ee[35]!==eo?(x=(0,C.j)(eo),ee[35]=eo,ee[36]=x):x=ee[36],ee[37]!==eo.label?(k=(0,$.jsx)(d.X6,{elementType:"h1",id:"page-title",size:"small",children:eo.label}),ee[37]=eo.label,ee[38]=k):k=ee[38],ee[39]!==e||ee[40]!==eo?(S="loading"===e.updateResult.kind?(0,$.jsx)(j._3,{"aria-label":`Updating ${eo.label}`,isIndeterminate:!0,size:"small",alignSelf:"center"}):e.hasChanged&&(0,$.jsx)(H.C,{tone:"pending",children:"Unsaved"}),ee[39]=e,ee[40]=eo,ee[41]=S):S=ee[41],ee[42]!==k||ee[43]!==S?(P=(0,$.jsxs)(c.kC,{flex:!0,alignItems:"center",gap:"regular",children:[k,S]}),ee[42]=k,ee[43]=S,ee[44]=P):P=ee[44],ee[45]===Symbol.for("react.memo_cache_sentinel")?(R=(0,$.jsx)(eW,{}),ee[45]=R):R=ee[45];let ey=et?"element.regular":void 0;ee[46]!==e.hasChanged?(F=e.hasChanged?[]:["reset"],ee[46]=e.hasChanged,ee[47]=F):F=ee[47],ee[48]!==e||ee[49]!==eb||ee[50]!==ev?(T=t=>{switch(t){case"reset":e.onReset();break;case"copy":eb();break;case"paste":ev()}},ee[48]=e,ee[49]=eb,ee[50]=ev,ee[51]=T):T=ee[51],ee[52]===Symbol.for("react.memo_cache_sentinel")?(E=e=>(0,$.jsxs)(W.c,{textValue:e.label,href:e.href,target:e.target,rel:e.rel,children:[(0,$.jsx)(r.J,{src:e.icon}),(0,$.jsx)(d.xv,{children:e.label})]},e.key),ee[52]=E):E=ee[52],ee[53]!==ey||ee[54]!==h||ee[55]!==F||ee[56]!==T?(U=(0,$.jsx)(W.W,{buttonLabelBehavior:"hide",overflowMode:"collapse",prominence:"low",density:"compact",maxWidth:ey,items:h,disabledKeys:F,onAction:T,children:E}),ee[53]=ey,ee[54]=h,ee[55]=F,ee[56]=T,ee[57]=U):U=ee[57];let ex="loading"===e.updateResult.kind,ej=eg?"Create":"Save";ee[58]!==ex||ee[59]!==ej?(K=(0,$.jsx)(l.zx,{form:"singleton-form",isDisabled:ex,prominence:"high",type:"submit",children:ej}),ee[58]=ex,ee[59]=ej,ee[60]=K):K=ee[60],ee[61]!==P||ee[62]!==U||ee[63]!==K?(D=(0,$.jsxs)(C.a,{children:[P,R,U,K]}),ee[61]=P,ee[62]=U,ee[63]=K,ee[64]=D):D=ee[64],ee[65]!==ep?(L=e=>{e.target===e.currentTarget&&(e.preventDefault(),ep())},ee[65]=ep,ee[66]=L):L=ee[66],ee[67]!==e.updateResult?(M="error"===e.updateResult.kind&&(0,$.jsx)(O.q,{tone:"critical",children:e.updateResult.error.message}),ee[67]=e.updateResult,ee[68]=M):M=ee[68];let ek=e.previewProps;return ee[69]!==ek||ee[70]!==ea||ee[71]!==eo.entryLayout||ee[72]!==u?(G=(0,$.jsx)(C.F,{previewProps:ek,forceValidation:ea,entryLayout:eo.entryLayout,formatInfo:u,slugField:void 0}),ee[69]=ek,ee[70]=ea,ee[71]=eo.entryLayout,ee[72]=u,ee[73]=G):G=ee[73],ee[74]!==e||ee[75]!==es||ee[76]!==ef?(J="needs-new-branch"===e.updateResult.kind&&(0,$.jsx)(tn,{branchOid:ef,onCreate:async t=>{es.push(`/keystatic/branch/${encodeURIComponent(t)}/singleton/${encodeURIComponent(e.singleton)}`),e.onUpdate({branch:t,sha:ef})},reason:e.updateResult.reason,onDismiss:e.onResetUpdateItem}),ee[74]=e,ee[75]=es,ee[76]=ef,ee[77]=J):J=ee[77],ee[78]!==e.onResetUpdateItem||ee[79]!==J?(V=(0,$.jsx)(I.TW,{onDismiss:e.onResetUpdateItem,children:J}),ee[78]=e.onResetUpdateItem,ee[79]=J,ee[80]=V):V=ee[80],ee[81]!==e?(Q="needs-fork"===e.updateResult.kind&&(0,_._)(e.config)&&(0,$.jsx)(eA,{onCreate:async()=>{e.onUpdate()},onDismiss:e.onResetUpdateItem,config:e.config}),ee[81]=e,ee[82]=Q):Q=ee[82],ee[83]!==e.onResetUpdateItem||ee[84]!==Q?(Z=(0,$.jsx)(I.TW,{onDismiss:e.onResetUpdateItem,children:Q}),ee[83]=e.onResetUpdateItem,ee[84]=Q,ee[85]=Z):Z=ee[85],ee[86]!==L||ee[87]!==M||ee[88]!==G||ee[89]!==V||ee[90]!==Z?(Y=(0,$.jsxs)(c.kC,{elementType:"form",id:"singleton-form",onSubmit:L,direction:"column",gap:"xxlarge",height:"100%",minHeight:0,minWidth:0,children:[M,G,V,Z]}),ee[86]=L,ee[87]=M,ee[88]=G,ee[89]=V,ee[90]=Z,ee[91]=Y):Y=ee[91],ee[92]!==x||ee[93]!==D||ee[94]!==Y?(X=(0,$.jsxs)(C.P,{containerWidth:x,children:[D,Y]}),ee[92]=x,ee[93]=D,ee[94]=Y,ee[95]=X):X=ee[95],X}function tC(e){let t,n,l,r,o,s,c,d,u;let h=(0,i.c)(49),{singleton:m,initialFiles:f,initialState:g,localTreeKey:p,config:b,draft:v}=e,{schema:y,singletonConfig:x}=e1(e.singleton);h[0]!==b||h[1]!==m?(t=(0,_.ac)(b,m),h[0]=b,h[1]=m,h[2]=t):t=h[2];let j=t;h[3]!==p||h[4]!==v||h[5]!==g||h[6]!==y?(n=()=>{var e;return{localTreeKey:p,state:null!==(e=null==v?void 0:v.state)&&void 0!==e?e:null===g?(0,C.o)(y):g}},h[3]=p,h[4]=v,h[5]=g,h[6]=y,h[7]=n):n=h[7];let[k,w]=(0,a.useState)(n),{state:S,localTreeKey:P}=k;(0,_.V)(v,S,p),P!==p&&w({localTreeKey:p,state:null===g?(0,C.o)(y):g});let I=null===g,R=eQ({initialState:g,state:S,schema:y,slugField:void 0})||I;h[8]!==m||h[9]!==R||h[10]!==j||h[11]!==b||h[12]!==x.schema||h[13]!==S||h[14]!==p?(l=()=>{let e=["singleton",m];if(R){let t={beforeTreeKey:p,files:new Map(eB({basePath:j,format:(0,_.ab)(b,m),schema:x.schema,slug:void 0,state:S}).map(e=>[e.path,e.contents])),savedAt:new Date,version:1};(0,_.$)(e,t)}else(0,_.a0)(e)},h[8]=m,h[9]=R,h[10]=j,h[11]=b,h[12]=x.schema,h[13]=S,h[14]=p,h[15]=l):l=h[15],h[16]!==b||h[17]!==p||h[18]!==S||h[19]!==R||h[20]!==m||h[21]!==j||h[22]!==x?(r=[b,p,S,R,m,j,x],h[16]=b,h[17]=p,h[18]=S,h[19]=R,h[20]=m,h[21]=j,h[22]=x,h[23]=r):r=h[23],(0,a.useEffect)(l,r),h[24]===Symbol.for("react.memo_cache_sentinel")?(o=e=>{w(t=>({localTreeKey:t.localTreeKey,state:e(t.state)}))},h[24]=o):o=h[24];let F=eY(y,o,S);h[25]!==b||h[26]!==m?(s=(0,_.ab)(b,m),h[25]=b,h[26]=m,h[27]=s):s=h[27];let T=s;h[28]!==S||h[29]!==f||h[30]!==b||h[31]!==x.schema||h[32]!==j||h[33]!==T||h[34]!==p?(c={state:S,initialFiles:f,config:b,schema:x.schema,basePath:j,format:T,currentLocalTreeKey:p,slug:void 0},h[28]=S,h[29]=f,h[30]=b,h[31]=x.schema,h[32]=j,h[33]=T,h[34]=p,h[35]=c):c=h[35];let[E,U,K]=eG(c),D=(0,_.W)(U);h[36]!==p||h[37]!==g||h[38]!==y?(d=()=>w({localTreeKey:p,state:null===g?(0,C.o)(y):g}),h[36]=p,h[37]=g,h[38]=y,h[39]=d):d=h[39];let L=d;return h[40]!==e||h[41]!==R||h[42]!==L||h[43]!==D||h[44]!==K||h[45]!==E||h[46]!==S||h[47]!==F?(u=(0,$.jsx)(tS,{...e,hasChanged:R,onReset:L,onUpdate:D,onResetUpdateItem:K,updateResult:E,state:S,previewProps:F}),h[40]=e,h[41]=R,h[42]=L,h[43]=D,h[44]=K,h[45]=E,h[46]=S,h[47]=F,h[48]=u):u=h[48],u}function t_(e){let t,n,a,l,r;let o=(0,i.c)(27),{singleton:s,initialFiles:c,initialState:d,localTreeKey:u,config:h}=e,{schema:m,singletonConfig:f}=e1(e.singleton);o[0]!==h||o[1]!==s?(t=(0,_.ac)(h,s),o[0]=h,o[1]=s,o[2]=t):t=o[2];let g=t,p=eZ(m,e.map),b=eX(m,e.map,p),v=null===d,y=eQ({initialState:d,state:p,schema:m,slugField:void 0})||v;o[3]!==h||o[4]!==s?(n=(0,_.ab)(h,s),o[3]=h,o[4]=s,o[5]=n):n=o[5];let x=n;o[6]!==p||o[7]!==c||o[8]!==h||o[9]!==f.schema||o[10]!==g||o[11]!==x||o[12]!==u?(a={state:p,initialFiles:c,config:h,schema:f.schema,basePath:g,format:x,currentLocalTreeKey:u,slug:void 0},o[6]=p,o[7]=c,o[8]=h,o[9]=f.schema,o[10]=g,o[11]=x,o[12]=u,o[13]=a):a=o[13];let[j,k,w]=eG(a),S=(0,_.W)(k);o[14]!==e.map||o[15]!==e.initialState||o[16]!==f.schema?(l=()=>{e.map.doc.transact(()=>{for(let[i,a]of Object.entries(f.schema)){var t,n;let l=eT(a,null!==(t=null===(n=e.initialState)||void 0===n?void 0:n[i])&&void 0!==t?t:(0,C.o)(a));e.map.set(i,l)}})},o[14]=e.map,o[15]=e.initialState,o[16]=f.schema,o[17]=l):l=o[17];let P=l;return o[18]!==e||o[19]!==y||o[20]!==P||o[21]!==S||o[22]!==w||o[23]!==j||o[24]!==p||o[25]!==b?(r=(0,$.jsx)(tS,{...e,hasChanged:y,onReset:P,onUpdate:S,onResetUpdateItem:w,updateResult:j,state:p,previewProps:b}),o[18]=e,o[19]=y,o[20]=P,o[21]=S,o[22]=w,o[23]=j,o[24]=p,o[25]=b,o[26]=r):r=o[26],r}let t$=L.dt({version:L.i0(1),savedAt:L.hT(),beforeTreeKey:L.jt(L.Z_()),files:L.UI(L.Z_(),L.eE(Uint8Array))});function tP(e){var t;let n,a,l,r,o,s,u,h,m;let f=(0,i.c)(55),g=null===(t=e.config.singletons)||void 0===t?void 0:t[e.singleton];g||ep(),f[0]!==g.label?(n=(0,$.jsx)(C.a,{children:(0,$.jsx)(d.X6,{elementType:"h1",id:"page-title",size:"small",children:g.label})}),f[0]=g.label,f[1]=n):n=f[1];let p=n;f[2]!==e.config||f[3]!==e.singleton?(l=(0,_.ab)(e.config,e.singleton),f[2]=e.config,f[3]=e.singleton,f[4]=l):l=f[4],a=l,f[5]!==e.config||f[6]!==e.singleton?(r=(0,_.ac)(e.config,e.singleton),f[5]=e.config,f[6]=e.singleton,f[7]=r):r=f[7];let b=r;f[8]!==e.singleton||f[9]!==b||f[10]!==a||f[11]!==g.schema?(o=async()=>{let t=await (0,_.R)(["singleton",e.singleton]);if(!t)throw Error("No draft found");let n=t$.create(t);return{state:ex({dirpath:b,format:a,schema:g.schema,slug:void 0},n.files).initialState,savedAt:n.savedAt,treeKey:n.beforeTreeKey}},f[8]=e.singleton,f[9]=b,f[10]=a,f[11]=g.schema,f[12]=o):o=f[12];let v=(0,_.f)(o);f[13]!==e.config||f[14]!==b||f[15]!==g.schema||f[16]!==a?(s={config:e.config,dirpath:b,schema:g.schema,format:a,slug:void 0},f[13]=e.config,f[14]=b,f[15]=g.schema,f[16]=a,f[17]=s):s=f[17];let y=ej(s),x=(0,_.q)(),k=`${x}/${e.singleton}`,w=(0,_.S)(),S="loading"===y.kind;f[18]!==w||f[19]!==S||f[20]!==k?(u=async()=>{if(!w)return;if("loading"===w||(await w.doc.whenSynced,S))return _.L;let e=w.data.get(k);if(e instanceof D.QW){let t=e.whenLoaded;e.load(),await t}else e=new D.QW,w.data.set(k,e);return e.getMap("data")},f[18]=w,f[19]=S,f[20]=k,f[21]=u):u=f[21];let P=(0,_.f)(u);if("loaded"===P.kind&&"loaded"===y.kind&&P.data&&!P.data.size){let e=P.data;e.doc.transact(()=>{for(let[t,n]of Object.entries(g.schema)){let i=eT(n,"not-found"===y.data?(0,C.o)(n):y.data.initialState[t]);e.set(t,i)}})}if("error"===y.kind){let e,t;return f[22]!==y.error.message?(e=(0,$.jsx)(C.i,{children:(0,$.jsx)(O.q,{margin:"xxlarge",tone:"critical",children:y.error.message})}),f[22]=y.error.message,f[23]=e):e=f[23],f[24]!==p||f[25]!==e?(t=(0,$.jsxs)(C.P,{children:[p,e]}),f[24]=p,f[25]=e,f[26]=t):t=f[26],t}if("error"===P.kind){let e,t;return f[27]!==P.error.message?(e=(0,$.jsx)(C.i,{children:(0,$.jsx)(O.q,{margin:"xxlarge",tone:"critical",children:P.error.message})}),f[27]=P.error.message,f[28]=e):e=f[28],f[29]!==p||f[30]!==e?(t=(0,$.jsxs)(C.P,{children:[p,e]}),f[29]=p,f[30]=e,f[31]=t):t=f[31],t}if("loading"===y.kind||"loading"===v.kind||"loading"===P.kind){let e,t;let n=`Loading ${g.label}`;return f[32]!==n?(e=(0,$.jsx)(C.i,{children:(0,$.jsx)(c.kC,{alignItems:"center",justifyContent:"center",minHeight:"scale.3000",children:(0,$.jsx)(j._3,{"aria-label":n,isIndeterminate:!0,size:"large"})})}),f[32]=n,f[33]=e):e=f[33],f[34]!==p||f[35]!==e?(t=(0,$.jsxs)(C.P,{children:[p,e]}),f[34]=p,f[35]=e,f[36]=t):t=f[36],t}if(P.data){let t,n;let i="not-found"===y.data?null:y.data.initialState;f[37]!==y.data?(t="not-found"===y.data?[]:y.data.initialFiles,f[37]=y.data,f[38]=t):t=f[38];let a="not-found"===y.data?void 0:y.data.localTreeKey;return f[39]!==e.singleton||f[40]!==e.config||f[41]!==i||f[42]!==t||f[43]!==a||f[44]!==P.data?(n=(0,$.jsx)(t_,{singleton:e.singleton,config:e.config,initialState:i,initialFiles:t,localTreeKey:a,map:P.data}),f[39]=e.singleton,f[40]=e.config,f[41]=i,f[42]=t,f[43]=a,f[44]=P.data,f[45]=n):n=f[45],n}let I="not-found"===y.data?null:y.data.initialState;f[46]!==y.data?(h="not-found"===y.data?[]:y.data.initialFiles,f[46]=y.data,f[47]=h):h=f[47];let R="not-found"===y.data?void 0:y.data.localTreeKey,F="loaded"===v.kind?v.data:void 0;return f[48]!==e.singleton||f[49]!==e.config||f[50]!==I||f[51]!==h||f[52]!==R||f[53]!==F?(m=(0,$.jsx)(tC,{singleton:e.singleton,config:e.config,initialState:I,initialFiles:h,localTreeKey:R,draft:F}),f[48]=e.singleton,f[49]=e.config,f[50]=I,f[51]=h,f[52]=R,f[53]=F,f[54]=m):m=f[54],m}function tI(e){let t,n,a,l,r,o;let s=(0,i.c)(11);return s[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,$.jsx)(d.X6,{children:"You've installed Keystatic! \uD83C\uDF89"}),s[0]=t):t=s[0],s[1]===Symbol.for("react.memo_cache_sentinel")?(n=(0,$.jsx)(d.xv,{children:"To start using Keystatic, you need to install the GitHub app you've created."}),s[1]=n):n=s[1],s[2]!==e.config.storage.repo?(a=(0,_.k)(e.config.storage.repo),s[2]=e.config.storage.repo,s[3]=a):a=s[3],s[4]!==a?(l=(0,$.jsxs)(d.xv,{children:["Make sure to add the App to the"," ",(0,$.jsx)("code",{children:a})," ","repository."]}),s[4]=a,s[5]=l):l=s[5],s[6]!==e.config?(r=(0,$.jsx)(eL,{config:e.config}),s[6]=e.config,s[7]=r):r=s[7],s[8]!==l||s[9]!==r?(o=(0,$.jsx)(c.kC,{alignItems:"center",justifyContent:"center",margin:"xxlarge",children:(0,$.jsxs)(c.kC,{backgroundColor:"surface",padding:"large",border:"color.alias.borderIdle",borderRadius:"medium",direction:"column",justifyContent:"center",gap:"xlarge",maxWidth:"scale.4600",children:[t,n,l,r]})}),s[8]=l,s[9]=r,s[10]=o):o=s[10],o}function tR(e){let t,n,r,o,s,u,h,m,f,g,p,b,v;let y=(0,i.c)(22),[x,j]=(0,a.useState)(""),[k,S]=(0,a.useState)(""),C=`https://github.com${k?`/organizations/${k}`:""}/settings/apps/new`;return y[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,$.jsx)(c.kC,{justifyContent:"center",children:(0,$.jsx)(d.X6,{children:"Keystatic Setup"})}),y[0]=t):t=y[0],y[1]===Symbol.for("react.memo_cache_sentinel")?(n=(0,$.jsx)(d.xv,{children:"Keystatic doesn't have the required config."}),y[1]=n):n=y[1],y[2]===Symbol.for("react.memo_cache_sentinel")?(r=(0,$.jsx)(d.xv,{children:"If you've already created your GitHub app, make sure to add the following environment variables:"}),y[2]=r):r=y[2],y[3]===Symbol.for("react.memo_cache_sentinel")?(o=(0,$.jsxs)(c.xu,{elementType:"ul",children:[(0,$.jsx)("li",{children:(0,$.jsx)("code",{children:"KEYSTATIC_GITHUB_CLIENT_ID"})}),(0,$.jsx)("li",{children:(0,$.jsx)("code",{children:"KEYSTATIC_GITHUB_CLIENT_SECRET"})}),(0,$.jsx)("li",{children:(0,$.jsx)("code",{children:"KEYSTATIC_SECRET"})})]}),y[3]=o):o=y[3],y[4]===Symbol.for("react.memo_cache_sentinel")?(s=(0,$.jsx)(d.xv,{children:"If you haven't created your GitHub app for Keystatic, you can create one below."}),y[4]=s):s=y[4],y[5]!==x?(u=(0,$.jsx)(U.nv,{label:"Deployed App URL",description:"This should the root of your domain. If you're not sure where Keystatic will be deployed, leave this blank and you can update the GitHub app later.",value:x,onChange:j}),y[5]=x,y[6]=u):u=y[6],y[7]!==k?(h=(0,$.jsx)(U.nv,{label:"GitHub organization (if any)",description:"You must be an owner or GitHub App manager in the organization to create the GitHub App. Leave this blank to create the app in your personal account.",value:k,onChange:S}),y[7]=k,y[8]=h):h=y[8],y[9]===Symbol.for("react.memo_cache_sentinel")?(m=(0,$.jsxs)(d.xv,{children:["After visiting GitHub to create the GitHub app, you'll be redirected back here and secrets generated from GitHub will be written to your"," ",(0,$.jsx)("code",{children:".env"})," file."]}),y[9]=m):m=y[9],y[10]===Symbol.for("react.memo_cache_sentinel")?(f=(0,w.iv)({display:"none"}),y[10]=f):f=y[10],y[11]!==e.config.storage.repo||y[12]!==x?(g=JSON.stringify({name:`${(0,_.y)(e.config.storage.repo).owner} Keystatic`,url:x?new URL("/keystatic",x).toString():`${window.location.origin}/keystatic`,public:!0,redirect_url:`${window.location.origin}/api/keystatic/github/created-app`,callback_urls:[`${window.location.origin}/api/keystatic/github/oauth/callback`,"http://127.0.0.1/api/keystatic/github/oauth/callback",...x?[new URL("/api/keystatic/github/oauth/callback",x).toString()]:[]],request_oauth_on_install:!0,default_permissions:{contents:"write",metadata:"read",pull_requests:"read"}}),y[11]=e.config.storage.repo,y[12]=x,y[13]=g):g=y[13],y[14]!==g?(p=(0,$.jsx)("input",{type:"text",name:"manifest",className:f,value:g}),y[14]=g,y[15]=p):p=y[15],y[16]===Symbol.for("react.memo_cache_sentinel")?(b=(0,$.jsx)(l.zx,{prominence:"high",type:"submit",children:"Create GitHub App"}),y[16]=b):b=y[16],y[17]!==C||y[18]!==u||y[19]!==h||y[20]!==p?(v=(0,$.jsx)(c.kC,{alignItems:"center",justifyContent:"center",margin:"xxlarge",children:(0,$.jsxs)(c.kC,{backgroundColor:"surface",padding:"large",border:"color.alias.borderIdle",borderRadius:"medium",direction:"column",justifyContent:"center",gap:"xlarge",maxWidth:"scale.4600",elementType:"form",action:C,method:"post",children:[t,n,r,o,s,u,h,m,p,b]})}),y[17]=C,y[18]=u,y[19]=h,y[20]=p,y[21]=v):v=y[21],v}function tF(e){let t,n,a,l,r;let o=(0,i.c)(11);o[0]!==e.config.storage.repo?(t=(0,_.k)(e.config.storage.repo),o[0]=e.config.storage.repo,o[1]=t):t=o[1];let s=t;o[2]===Symbol.for("react.memo_cache_sentinel")?(n=(0,$.jsx)(c.kC,{justifyContent:"center",children:(0,$.jsx)(d.X6,{children:"Repo not found"})}),o[2]=n):n=o[2];let u=`https://github.com/${s}`;return o[3]!==u||o[4]!==s?(a=(0,$.jsxs)(d.xv,{children:["Keystatic is configured for the"," ",(0,$.jsx)("a",{href:u,children:s})," GitHub repo but Keystatic isn't able to access this repo. This is either because you don't have access to this repo or you haven't added the GitHub app to it."]}),o[3]=u,o[4]=s,o[5]=a):a=o[5],o[6]!==e.config?(l=(0,$.jsx)(eL,{config:e.config}),o[6]=e.config,o[7]=l):l=o[7],o[8]!==a||o[9]!==l?(r=(0,$.jsx)(c.kC,{alignItems:"center",justifyContent:"center",margin:"xxlarge",children:(0,$.jsxs)(c.kC,{backgroundColor:"surface",padding:"large",border:"color.alias.borderIdle",borderRadius:"medium",direction:"column",justifyContent:"center",gap:"xlarge",maxWidth:"scale.4600",children:[n,a,l]})}),o[8]=a,o[9]=l,o[10]=r):r=o[10],r}let tT=L.Ry({state:L.Z_(),from:L.Z_(),code_verifier:L.Z_()}),tE=L.dt({access_token:L.Z_(),token_type:L.Z_(),expires_in:L.Rx()});function tU({config:e}){var t;let n=(0,_.u)(),i=new URL(window.location.href),l=i.searchParams.get("code"),r=i.searchParams.get("state"),o=(0,a.useMemo)(()=>{let e=localStorage.getItem("keystatic-cloud-state");return(()=>{try{return tT.create(JSON.parse(e||""))}catch{return null}})()},[]),[s,u]=(0,a.useState)(null);return((0,a.useEffect)(()=>{var t;if(l&&r&&o&&null!==(t=e.cloud)&&void 0!==t&&t.project){let{project:t}=e.cloud;(async()=>{let e=await fetch(`${_.K}/oauth/token`,{method:"POST",body:new URLSearchParams({code:l,client_id:t,redirect_uri:`${window.location.origin}/keystatic/cloud/oauth/callback`,code_verifier:o.code_verifier,grant_type:"authorization_code"}).toString(),headers:{"Content-Type":"application/x-www-form-urlencoded",..._.n}});if(!e.ok)throw Error(`Bad response: ${e.status} ${e.statusText}

${await e.text()}`);let i=await e.json(),a=tE.create(i);localStorage.setItem("keystatic-cloud-access-token",JSON.stringify({token:a.access_token,project:t,validUntil:Date.now()+1e3*a.expires_in})),n.push(`/keystatic/${o.from}`)})().catch(e=>{u(e)})}},[l,r,n,o,e]),null!==(t=e.cloud)&&void 0!==t&&t.project)?l&&r?o&&r===o.state?s?(0,$.jsx)(d.xv,{children:s.message}):(0,$.jsx)(c.kC,{justifyContent:"center",alignItems:"center",height:"100vh",children:(0,$.jsx)(j._3,{size:"large",isIndeterminate:!0,"aria-label":"Authenticating"})}):(0,$.jsx)(d.xv,{children:"Invalid state"}):(0,$.jsx)(d.xv,{children:"Missing code or state"}):(0,$.jsx)(d.xv,{children:"Missing Keystatic Cloud config"})}function tK(e){if(0===e.length)return{};if(2===e.length&&"singleton"===e[0])return{singleton:e[1]};if(e.length<2||"collection"!==e[0])return null;let t=e[1];return 2===e.length?{collection:t}:3===e.length&&"create"===e[2]?{collection:t,kind:"create"}:4===e.length&&"item"===e[2]?{collection:t,kind:"edit",slug:e[3]}:null}function tD(e){let t,n;let l=(0,i.c)(6),{push:r}=(0,_.u)(),{data:o,error:s}=(0,a.useContext)(_.aa);return l[0]!==s||l[1]!==e.config||l[2]!==o||l[3]!==r?(t=()=>{var t,n,i,a,l;(null==s||null===(t=s.response)||void 0===t?void 0:t.status)===401&&("github"===e.config.storage.kind?window.location.href="/api/keystatic/github/login":(0,_.D)("",e.config)),null!=o&&null!==(n=o.repository)&&void 0!==n&&n.defaultBranchRef&&r(`/keystatic/branch/${encodeURIComponent(o.repository.defaultBranchRef.name)}`),("github"!==e.config.storage.kind||null!=o&&null!==(i=o.repository)&&void 0!==i&&i.id||(null==s||null===(a=s.graphQLErrors)||void 0===a||null===(a=a[0])||void 0===a||null===(a=a.originalError)||void 0===a?void 0:a.type)!=="NOT_FOUND")&&(null==s||null===(l=s.graphQLErrors)||void 0===l||null===(l=l[0])||void 0===l||null===(l=l.originalError)||void 0===l?void 0:l.type)!=="FORBIDDEN"||(window.location.href="/api/keystatic/github/repo-not-found")},n=[o,s,r,e.config],l[0]=s,l[1]=e.config,l[2]=o,l[3]=r,l[4]=t,l[5]=n):(t=l[4],n=l[5]),(0,a.useEffect)(t,n),null}function tL(e){var t;let n,a,l,r,s,c,u;let h=(0,i.c)(37),{config:m}=e,{params:f}=(0,_.u)(),g=null;if("cloud/oauth/callback"===f.join("/")){let e;return h[0]!==m?(e=(0,$.jsx)(tU,{config:m}),h[0]=m,h[1]=e):e=h[1],e}h[2]===Symbol.for("react.memo_cache_sentinel")?(l=e=>e,h[2]=l):l=h[2];let p=l;if((0,_.ad)(m)||(0,_.r)(m)&&null!==(t=m.cloud)&&void 0!==t&&t.project){let e;h[3]!==m?(e=e=>(0,$.jsx)(_.ag,{config:m,children:e}),h[3]=m,h[4]=e):e=h[4],p=e}if((0,_._)(m)||(0,_.ad)(m)){let e,t;let i=p;if(h[5]!==m||h[6]!==i?(e=e=>(0,$.jsx)(tO,{config:m,children:(0,$.jsx)(_.ah,{config:m,children:i(e)})}),h[5]=m,h[6]=i,h[7]=e):e=h[7],p=e,0===f.length){let e,t;return h[8]!==m?(e=(0,$.jsx)(tD,{config:m}),h[8]=m,h[9]=e):e=h[9],h[10]!==p||h[11]!==e?(t=p(e),h[10]=p,h[11]=e,h[12]=t):t=h[12],t}if(1===f.length&&(0,_._)(m)){if("setup"===f[0]){let e;return h[13]!==m?(e=(0,$.jsx)(tR,{config:m}),h[13]=m,h[14]=e):e=h[14],e}if("repo-not-found"===f[0]){let e;return h[15]!==m?(e=(0,$.jsx)(tF,{config:m}),h[15]=m,h[16]=e):e=h[16],e}if("created-github-app"===f[0]){let e;return h[17]!==m?(e=(0,$.jsx)(tI,{config:m}),h[17]=m,h[18]=e):e=h[18],e}}if("branch"!==f[0]||f.length<2){let e;return h[19]===Symbol.for("react.memo_cache_sentinel")?(e=(0,$.jsx)(d.xv,{children:"Not found"}),h[19]=e):e=h[19],e}g=f[1],a=`/keystatic/branch/${encodeURIComponent(g)}`,h[20]!==f?(t=tK(f.slice(2)),h[20]=f,h[21]=t):t=h[21],n=t}else{let e;h[22]!==f?(e=tK(f),h[22]=f,h[23]=e):e=h[23],n=e,a="/keystatic"}let b=g||"";return h[24]===Symbol.for("react.memo_cache_sentinel")?(r=(0,$.jsx)(C.P,{children:(0,$.jsx)(C.i,{children:(0,$.jsx)(em,{icon:o.y,title:"Not found",message:"This page could not be found."})})}),h[24]=r):r=h[24],h[25]!==n||h[26]!==m||h[27]!==a?(s=(0,$.jsx)(ev,{fallback:r,children:null===n?(0,$.jsx)(tA,{}):n.collection?"create"===n.kind?(0,$.jsx)(tr,{collection:n.collection,config:m,basePath:a},n.collection):"edit"===n.kind?(0,$.jsx)(ti,{collection:n.collection,basePath:a,config:m,itemSlug:n.slug},n.collection):(0,$.jsx)(e_,{basePath:a,collection:n.collection,config:m},n.collection):n.singleton?(0,$.jsx)(tP,{config:m,singleton:n.singleton},n.singleton):(0,$.jsx)(ty,{config:m,basePath:a})}),h[25]=n,h[26]=m,h[27]=a,h[28]=s):s=h[28],h[29]!==m||h[30]!==b||h[31]!==a||h[32]!==s?(c=(0,$.jsx)(tw,{config:m,currentBranch:b,basePath:a,children:s}),h[29]=m,h[30]=b,h[31]=a,h[32]=s,h[33]=c):c=h[33],h[34]!==p||h[35]!==c?(u=p(c),h[34]=p,h[35]=c,h[36]=u):u=h[36],u}function tA(){ep()}function tO(e){let t,n;let o=(0,i.c)(13),[u,h]=(0,a.useState)("unknown"),m=(0,_.u)();if(o[0]!==e.config?(t=()=>{(0,_.m)(e.config).then(e=>{if(e){h("valid");return}h("explicit-auth")})},n=[e.config],o[0]=e.config,o[1]=t,o[2]=n):(t=o[1],n=o[2]),(0,a.useEffect)(t,n),"valid"===u)return e.children;if("explicit-auth"===u){if("github"===e.config.storage.kind){let e,t,n;let i=`/api/keystatic/github/login${m.params.length?`?${new URLSearchParams({from:m.params.map(encodeURIComponent).join("/")})}`:""}`;return o[3]===Symbol.for("react.memo_cache_sentinel")?(e=(0,$.jsx)(r.J,{src:s.f}),o[3]=e):e=o[3],o[4]===Symbol.for("react.memo_cache_sentinel")?(t=(0,$.jsx)(d.xv,{children:"Log in with GitHub"}),o[4]=t):t=o[4],o[5]!==i?(n=(0,$.jsx)(c.kC,{justifyContent:"center",alignItems:"center",height:"100vh",children:(0,$.jsxs)(l.zx,{href:i,target:"_top",children:[e,t]})}),o[5]=i,o[6]=n):n=o[6],n}if("cloud"===e.config.storage.kind){let t,n,i;return o[7]!==m.params||o[8]!==e.config?(t=()=>{(0,_.D)(m.params.map(encodeURIComponent).join("/"),e.config)},o[7]=m.params,o[8]=e.config,o[9]=t):t=o[9],o[10]===Symbol.for("react.memo_cache_sentinel")?(n=(0,$.jsx)(d.xv,{children:"Log in with Keystatic Cloud"}),o[10]=n):n=o[10],o[11]!==t?(i=(0,$.jsx)(c.kC,{justifyContent:"center",alignItems:"center",height:"100vh",children:(0,$.jsx)(l.zx,{onPress:t,children:n})}),o[11]=t,o[12]=i):i=o[12],i}}return null}function tz(e){let t,n;let l=(0,i.c)(2);return(l[0]===Symbol.for("react.memo_cache_sentinel")?(t=()=>{"localhost"===window.location.hostname&&(window.location.href=window.location.href.replace("localhost","127.0.0.1"))},n=[],l[0]=t,l[1]=n):(t=l[0],n=l[1]),(0,a.useEffect)(t,n),"localhost"===window.location.hostname)?null:e.children}function tW(e){let t,n,a;let l=(0,i.c)(8);return"github"===e.config.storage.kind&&(0,_.ae)(e.config.storage.repo),l[0]!==e.config?(t=(0,$.jsx)(tL,{config:e.config}),l[0]=e.config,l[1]=t):t=l[1],l[2]!==e.config||l[3]!==t?(n=(0,$.jsx)(_.af,{children:(0,$.jsx)(eM,{config:e.config,children:t})}),l[2]=e.config,l[3]=t,l[4]=n):n=l[4],l[5]!==e.appSlug||l[6]!==n?(a=(0,$.jsx)(tH,{children:(0,$.jsx)(tz,{children:(0,$.jsx)(eD,{value:e.appSlug,children:n})})}),l[5]=e.appSlug,l[6]=n,l[7]=a):a=l[7],a}function tH(e){let t,n;let l=(0,i.c)(2),[r,o]=(0,a.useState)(!1);return(l[0]===Symbol.for("react.memo_cache_sentinel")?(t=()=>{o(!0)},n=[],l[0]=t,l[1]=n):(t=l[0],n=l[1]),(0,a.useEffect)(t,n),r)?e.children:null}}}]);